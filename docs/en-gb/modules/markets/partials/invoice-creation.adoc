Invoices for your Amazon orders can be generated in different ways, depending on the settings you select in the *Setup » Markets » Amazon » [Select Amazon account] » Tab: Settings*.

[[amazon-invoices]]
.Options for generating invoices
[cols="1,3a"]
|====
|Option |Explanation

| *Amazon Invoice Document Uploader - IDU*
|plentymarkets calculates the VAT. plentymarkets generates the invoice via an event procedure. +
*_Note:_* You need to create the event procedure manually. +
*_Tip:_* In the *Setup » Markets » Amazon » [Select Amazon account] » Tab: Settings* menu, this option is called *plentymarkets*. +
<<#3175, How to set up Amazon Invoice Document Uploader - IDU>>


| *VCS Amazon*
|Amazon invoice numbers and credit notes for Amazon orders are imported into plentymarkets. +
*_Note:_* VCS must be activated in Amazon Seller Central. +
*_Important:_* Invoices for Amazon orders can no longer be created manually or with an event procedure. +
<<#6900, How to set up VCS Amazon>>

| *VCS plentymarkets* (VCS Lite)
|Amazon calculates the VAT. Amazon invoices are automatically generated by plentymarkets and transferred to Amazon. +
*_Tip:_* Amazon calls this option VCS Lite. +
*_Note:_* VCS must be activated in Amazon Seller Central. +
*_Important:_* Invoices for Amazon orders can no longer be created manually or with an event procedure. +
<<#3150, How to set up VCS plentymarkets (VCS Lite)>>
|====

[TIP]
.Best practice for Amazon VCS
====
Also read the xref:markets:best-practices-amazon-vcs.adoc#[best practice for Amazon VCS]. This contains additional information about setting up Amazon’s invoice service VCS in plentymarkets.
====

[#3175]
=== Setting up Amazon IDU

VCS is an optional service. If you activate this service in Amazon Seller Central, Amazon calculates the VAT for your Amazon orders. If you do not want to use Amazon VCS, you can upload invoice documents created in plentymarkets to Amazon (Amazon Invoice Document Uploader - IDU). To do so, proceed as described below.

* You can only upload invoices to Amazon after a shipping confirmation was sent to Amazon.
* Amazon rejects invoices if the invoice number contains spaces. As such, make sure that your xref:orders:order-documents.adoc#1800[number range for invoices] does not contain any spaces.

[.instruction]
Activating Amazon IDU in plentymarkets:

. Go to *Setup » Markets » Amazon » [Select Amazon account] » Tab: Settings*.
. For the setting *Generate invoice*, select the option *plentymarkets*.
. Save (terra:save[]) the settings. +
→ plentymarkets calculates the VAT for Amazon orders. +
→ Invoices for Amazon orders are created by plentymarkets. +
. Set up the event procedure described below to upload invoices to Amazon.

Set up the following event procedure to upload invoices created by plentymarkets as well as invoices created with an external software to Amazon. However, invoices created by plentymarkets always take priority over external invoices. This means that all invoice documents are checked and if invoices created by plentymarkets are found, they are uploaded first. If there is no plentymarkets invoice, the external invoice will be uploaded to Amazon.

:table-event-procedure: <<#event-procedure-uploading-invoice>>

include::_includes:partial$event-procedure.adoc[]

[[event-procedure-uploading-invoice]]
.Event procedure for uploading invoices to Amazon
[cols="1,3,3"]
|====
| Setting | Option | Selection

| *Event*
| Select an event, for example *Order change: Status change* or *Documents: Invoice generated*
| If you selected the event *Order change: Status change*, select a status.

| *Filter*
| *Order > Referrer*
| *Amazon* or a suitable Amazon sub-referrer, for example Amazon France

| *Procedure*
| *Order > Upload invoice to Amazon*
|
|====

[#3150]
=== Setting up VCS plentymarkets/VCS Lite

If you select VCS plentymarkets, Amazon calculates the VAT, but invoices for Amazon orders are created by plentymarkets and automatically uploaded to Amazon. Amazon calls this option VCS Lite.

* You can only upload invoices to Amazon after a shipping confirmation was sent to Amazon.
* Amazon rejects invoices if the invoice number contains spaces. As such, make sure that your xref:orders:order-documents.adoc#1800[number range for invoices] does not contain any spaces.

==== Activating VCS plentymarkets/VCS Lite in Amazon Seller Central

To get started, activate the VCS service in Amazon Seller Central.

[.instruction]
Activating VCS plentymarkets/VCS Lite in Amazon Seller Central:

. Log into Amazon Seller Central.
. Go to *Settings » Tax settings » VAT calculation settings*.
. Navigate to the area *Invoice generation*.
. Select the option *I will upload my own VAT invoices*.
. *_Optional:_* Select the date that you want the Amazon VAT calculation service to start.
. *Save* the settings. +
→ The date on which the VCS service is activated is displayed.
. Write down the date shown. +
*_Tip:_* On the activation date, the VCS service is activated at 12 pm Universal Time (UTC).
. Set yourself a reminder for the day on which you need to activate Amazon VCS in plentymarkets.

==== Activating VCS plentymarkets/VCS Lite in plentymarkets

On the date Amazon activates the VCS settings, you also need to activate *VCS plentymarkets* in plentymarkets. To do so, proceed as described below.

[.instruction]
Activating VCS plentymarkets/VCS Lite in plentymarkets:

. Go to *Setup » Markets » Amazon » [Select Amazon account] » Tab: Settings*.
. For the setting *Generate invoice*, select the option *VCS plentymarkets*. +
*_Important:_* Only activate VCS plentymarkets on the date on which Amazon VCS is activated in Amazon Seller Central. +
*_Tip:_* On the activation date, the VCS service is activated at 12 pm Universal Time (UTC).
. Save (terra:save[]) the settings. +
→ Invoices for Amazon orders are automatically generated by plentymarkets and transferred to Amazon. +
→ Amazon calculates the VAT for Amazon orders. +
→ Invoices for Amazon orders can no longer be created manually or with an event procedure.
. *_Important:_* If you have used Amazon IDU up to now, deactivate the event procedure that uploads invoices to Amazon. Otherwise, invoice documents are uploaded to Amazon in douplicates. This can overload the interface so that some invoices are not uploaded to Seller Central at all.

[#6900a]
=== Setting up VCS Amazon

If you activate VCS Amazon, Amazon calculates the VAT and generates the invoices for your Amazon orders. Amazon invoice numbers and credit notes for Amazon orders are imported into plentymarkets.

==== Activating VCS Amazon in Amazon Seller Central

To get started, activate the VCS service in Amazon Seller Central.

[.instruction]
Activating VCS Amazon in Amazon Seller Central:

. Log into Amazon Seller Central.
. Go to *Settings » Tax settings » VAT calculation settings*.
. Navigate to the area *Invoice generation*.
. Select the option *I want Amazon to automatically generate VAT invoices.*.
. *_Optional:_* Select the date that you want the Amazon VAT calculation service to start.
. *Save* the settings. +
→ The date on which the VCS service is activated is displayed.
. Write down the date shown. +
*_Tip:_* On the activation date, the VCS service is activated at 12 pm Universal Time (UTC).
. Set yourself a reminder for the day on which you need to activate Amazon VCS in plentymarkets.

==== Activating VCS Amazon in plentymarkets

On the date Amazon activates the VCS settings, you also need to activate *VCS Amazon* in plentymarkets. To do so, proceed as described below.

[.instruction]
Activating VCS Amazon in plentymarkets:

. Go to *Setup » Markets » Amazon » [Select Amazon account] » Tab: Settings*.
. For the setting *Generate invoice*, select the option *VCS Amazon*. +
*_Important:_* Only activate VCS Amazon on the date on which Amazon VCS is activated in Amazon Seller Central. +
*_Tip:_* On the activation date, the VCS service is activated at 12 pm Universal Time (UTC).
. Save (terra:save[]) the settings. +
→ Amazon calculates the VAT for Amazon orders. +
→ Invoice numbers for Amazon orders are generated by Amazon and imported into plentymarkets. +
→ Invoices for Amazon orders can no longer be created manually or with an event procedure.
. *_Important:_* If you have used Amazon IDU up to now, deactivate the event procedure that uploads invoices to Amazon. Otherwise, invoice documents are uploaded to Amazon in douplicates. This can overload the interface so that some invoices are not uploaded to Seller Central at all.

[#7000]
[#7010]
=== Troubleshooting: Manually uploading invoices

If all your settings for the invoice creation are correct, invoice information is exchanged with Amazon automatically. Were not all invoices for your Amazon orders uploaded to Amazon?

* Make sure that you have set up the upload of invoices for Amazon orders correctly as described in this chapter.
* If all settings are correct and only some invoices are missing, you can upload these invoices to Amazon manually. To do so, proceed as described below.

[.instruction]
Manually uploading invoices to Amazon:

. Go to *Setup » Markets » Amazon » Data exchange » Reports*.
. Open the tab *Upload invoices*.
. From the drop-down list *Order ID type*, select the option *Order ID*. +
*_Tip:_* If part shipments exist in the system, not all invoices are uploaded when you select the option *Amazon order ID*. As such, we recommend the option *Order ID*.
. Enter the ID of the invoice. +
*_Tip:_* Enter more than one order ID separated by commas.
. Click on *Apply* (icon:cog[]). +
→ plentymarkets starts to upload any missing invoices for valid orders to Amazon.


[#unlock-vcs-orders]
=== Troubleshooting: Unlocking VCS orders for manual invoice creation

//tag::unlock-vcs-oders[]
When you use the VCS service, you do not generate invoice documents yourself. Instead, all order documents are generated automatically when the VCS reports are imported. As such, orders are locked for manual invoice generation. However, in some cases you need to manually generate invoices for VCS orders:

* Amazon is the customer.
* You did not save a VAT identification number (VATIN) for the country in which the order originated in Seller Central.
* The order is not really a VCS order and was imported retroactively. This happens if the order was placed before you activated VCS but imported after you activated VCS.

In such cases, you need to unlock the VCS orders manually. This allows you to generate the necessary invoice documents.

NOTE: VCS reports still have the highest priority. That includes unlocked orders for which you have manually generated invoice documents. If Amazon sends invoice documents in a subsequent VCS report, the invoices you generated are cancelled and a new invoice is generated.

[.instruction]
Unlocking VCS orders:

. Go to *Setup » Markets » Amazon » Data exchange » Reports*.
. Open the tab *Unlock VCS orders*.
. In the drop-down list *Order ID type*, select if you want to enter the *Amazon order ID* or the plentymarkets *Order ID* to search for the orders.
. In the field *Order ID list*, enter the ID of the orders. To enter several IDs, separate them by commas.
. Click on *Unlock VCS orders* (terra:execute[]). +
→ The *Results* area shows how many orders were unlocked. The table shows the status of each order. +
→ You can manually generate invoice documents for the unlocked orders. +
*_Important:_* If Amazon transfers their own documents in a subsequent VCS report, the invoice documents that you created manually will become invalid: As a result, your invoice documents are cancelled and a new invoice is created.

[.collapseBox]
.Viewing unlocking events in the data log
--
Go to *Data » Log* to find out when and by which user orders were unlocked. <<#list-log-filters>> shows the filters you can use to find unlocking events in the log.

[[list-log-filters]]
.Recommended filters for unlocking events
[cols="1,3a"]
|====
|Filter |Selection

| Integration
| PlentyLegacy\\ModMarkets

| Identifier
| AmazonUnlockVcsOrder

| References

|* amazonOrderId
* orderId
|====

[.instruction]
Viewing unlocking events in the data log:

. Go to *Data » Log*.
. In the column to the left, select appropriate filters from the drop-down lists.
. *_Optional:_* Select filters for dates and/or times to only show entries from a specific period. +
*_Tip:_* For further information about the filters, refer to the xref:data:datalog.adoc#[Data log] page of the manual.
. Click on *Search* (icon:search[role="blue"]). +
→ The results are shown.
--
//end::unlock-vcs-orders[]
