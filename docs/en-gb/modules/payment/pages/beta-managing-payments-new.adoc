= Managing payments
:page-aliases: beta-managing-payments.adoc
:keywords: payments, incoming payments, assigning payments, automatic assignment, auto-assign, split payment, splitting payments, partial payments, mapping payments
:description: Get to know everything about working with and editing payments.
:author: team-fulfillment-payment

This page of the manual describes and explains how to manage payments. You receive payments in your system from different sources. Independent of the payment source, you can manage all incoming payments in the *Orders » Payments* menu.

[#basic-settings]
== Carrying out basic settings for incoming payments

First, carry out basic settings for automatically assigning payments to orders and for giving goodwill on payments. Default settings are already saved in your plentymarkets system which have been gained from experience and have proven themselves in practice. To change these settings, proceed as follows.

[.instruction]
Changing the basic settings:

. Go to *Setup » Orders » Payment » Incoming*.
. Carry out the settings. Note <<#table-basic-settings-incoming-payment>>.
. *Save* (material:save[]) the settings.

[[table-basic-settings-incoming-payment]]
.Carrying out basic settings for incoming payments
[cols="1,3"]
|====
|Setting |Explanation

| [#intable-match-automatic-assignment]*Match for automatic assignment*
|Select a value between *0.7* (no exact match required for assignment) and *1.0* (exact match required). If this value is set to a higher value, automatic matching of payments may not work properly in your plentymarkets system. This is why the value *0.75* is the *default setting*.

| [#intable-goodwill-payment]*Goodwill on payment*
|To avoid incorrect postings due to internal decimal places (starting from the third decimal place), you should enter a *minimal value* of *0.01* (default setting). If you select the value *0.05*, for example, payments that are up to 5 cents short of the original amount are booked as complete payments.

| [#intable-import-customer-bank-data]*Import customer bank data*
|Select whether or not the contact’s bank details should be imported and saved in the xref:crm:edit-contact.adoc#bank-details[bank details] area of the contact data record. +
*_Important:_* The bank details may only be imported and saved after the contacts agreed to the process. This is why *No* is selected b default. Before selecting this option, note and check for current legislation concerning this topic, if necessary also of different delivery countries.

| [#intable-assign-paypal-payment-ebay-listing]*Only assign incoming PayPal payment to corresponding eBay listing if attached to the payment*
| *_Note:_* This functionality only applies to the old PayPal interface for Callisto online shops in plentymarkets, *_not_* for the PayPal plugin! +
If you use eBay listings in combination with the payment method PayPal, we recommend to set this option to *Yes*. This way, it is ensured that incoming payments effected via PayPal are correctly assigned to the corresponding eBay order. If an eBay listing ID is attached to a PayPal payment and the option is activated, the payment is only assigned to the order with a corresponding eBay listing ID.

| [#intable-ignore-woocommerce-transactions]*Ignore WooCommerce PayPal transactions*
| *_Note:_* This functionality only applies to the old PayPal interface for Callisto online shops in plentymarkets, *_not_* for the PayPal plugin! +
Select the option *Yes* to deactivate the automatic import of payments belonging to orders imported from WooCommerce with the payment method PayPal.

| [#intable-exclude-orders-payment-method-automatic-assignment]*Exclude orders with the following payment methods from automatic assignment*
|Select those payment methods for which _no_ payments are incoming. They are then _ignored_ for automatic payment assignment. +
Use the keyboard to select multiple payment methods.

| [#intable-exclude-orders-referrer-automatic-assignment]*Exclude orders with the following referrers form automatic assignment*
|Select those referrers for which _no_ payments are incoming. They are then _ignored_ for automatic payment assignment. +
Use the keyboard to select multiple payment methods.

|====

[#10]
== New payments in the system

Payments can either come into your system automatically or they can be booked manually. After payments are booked in plentymarkets, they are automatically assigned to orders with a fuzzy search. If the payment cannot be assigned to the order automatically, then you can still manually assign the payment to an order. Edit and manage payments in the *Orders » Payments* menu. Unassigned orders can be identified by the credit card symbol (material:credit_card[]). You can <<#30, assign payments>> either directly in the payments overview or in the detail view of a payment. +
In this overview, payments are displayed in your xref:payment:currencies.adoc#30[system currency]. If the payment is in a different currency, this amount is displayed in brackets next to the system currency.

[TIP]
.Setting up event procedures for incoming payments
====
The incoming payment is an important event when it comes to processing orders because items are not typically shipped until the payment was received. In most cases, the order status in plentymarkets changes from status *[3] - waiting for payment* to status *[5] - cleared for shipping* as soon as the payment was received. Create xref:automation:event-procedures.adoc#[event procedures] to automatically process orders and ship the items once payment is received.
====

[#bank-postings-import]
=== Importing bank postings

The payment method *cash in advance* and other transfers take the form of bank postings. With these payment methods, the payments that were booked into your bank account have to be reported to the system and then they need to be assigned to the orders. Use the import type xref:data:elasticSync-bank-postings.adoc#[Bank postings] to import your bank postings into your plentymarkets system. You can find a best practice for the postings import on the manual page xref:data:practical-example-elasticsync-postings.adoc#[Importing new postings]. +
After the import, the bank postings are treated as other payments and are automatically assigned to orders. Accordingly, editing and managing of these payments is also done in the *Orders » Payments* menu.

[#paypal-payment-import]
=== PayPal import

The entry *PayPal import* with the PayPal icon in the navigation on the left of the *Orders » Payments* menu is only displayed when the xref:payment:paypal.adoc#[PayPal plugin] is installed. To use this function, you need _at least version 6.0.0_ of the PayPal plugin. +
With the function *PayPal import*, you import PayPal payments from your PayPal account directly into your plentymarkets system by using the transaction numbers. In this import, only new payments are imported. Already existing payments are _not_ updated. To import the PayPal payments, proceed as follows:

[.instruction]
Importing PayPal payments:

. Go to *Orders » Payments*.
. Select *PayPal import* in the navigation on the left.
. Select the correct *PayPal account*.
. In the *Transaction number(s)* field, enter the transaction numbers of the payments you want to import. +
→ You can enter several transaction numbers, separated by comma.
. Click on *Import* (material:import_export[]). +
→ The payments with the entered transaction numbers are imported and added to the payments overview table.

After importing the PayPal payments, they are automatically assigned to orders, just like other payments as well. Note that the auto-assignment depends on the <<#intable-match-automatic-assignment, setting>> *Match for automatic assignment (0.7 - 1.0)* in the *Setup » Orders » Payment » Incoming* menu. The value 0.7 stands for a 70% match and the value 1.0 stands for a 100% match. In case a payment cannot be assigned automatically, you can still <<#30, assign the payment manually>>. +
*_Note:_* After the import, it can take up to 15 minutes until the automatic assignment is done.

[#configure-columns]
== Configuring columns

You can adjust the table in the overview of the *Orders » Payments* menu. This means that you can decide which information is displayed in the table columns. 

[.instruction]
Configuring columns:

. At the top right, click on *Configure columns* (material:settings[]). +
→ The window *Configure columns* opens.
. Select which columns you want to be displayed.
. Move (material:drag_indicator[]) the columns so they are displayed in the order you need them in.
. Click on *Confirm* to save your settings.

[#20]
== Searching for payments

In order to search for specific payments, enter a search term in the search fields. You can enter multiple search terms into the search fields at once. This makes your search run quicker and more accurate. You can combine different filters for the search, for example to search for unassigned payments of the last week.

[.instruction]
Searching for a payment: 

. Go to *Orders » Payments*.
* *_Alternative 1:_* Click on material:search[] (*Search*) to get a list of all payments.
* *_Alternative 2:_* Enter a value in the search field and select the appropriate filter from the suggestion list. *_Example:_* If you enter a number or letters, the possible filters will be suggested to you such as for example the order ID or the variation number.
* *_Alternative 3:_* Click on material:tune[] to narrow down the search results with filters.
. Note <<#table-searching-payments>>.  +
*_Tip:_* You can enter multiple search terms into the search fields at one time. This makes your search run quicker and be more accurate.
. Click on material:search[] *Search*. +
→ The payments that correspond to the search criteria entered are shown in the overview.

[[table-searching-payments]]
.Searching for payments
[cols="1,3"]
|====
| Setting | Explanation

| *Order ID*
|Search for orders to which a payment has been assigned by entering the order IDs.

| *Transaction ID*
|The transaction ID is assigned by the payment provider so that the payment can be correctly allocated to this provider. Enter a transaction ID to search for a payment with this specific transaction ID.

| *Transaction code*
|The transaction code describes the transaction itself. Enter a transaction code to search for a payment with this specific code.

| *Reference ID*
|A reference ID links payments, e.g. a payment and a refund. Enter a reference ID to search for payments with this specific transaction ID.

| *Payment ID*
|Enter the payment ID to search for the exact payment with this ID.

| *Payment method*
|Enter a specific payment method to search for payments that were paid with this payment method.

| *Reason for payment*
|Enter the reason for payment, either entirely or partly, to search for payments with this designated use.

| *Sender of payment*
|Enter the name of the person who sent the money to search for all payments of this person.

| *Credit/Debit*
|Select *Credit* or *Debit*. +
*Credit* = All incoming payments with a positive value are displayed. +
*Credit* = All incoming payments with a negative value are displayed.

| *Operator* and *Amount*
|Select an *operator* and enter an *amount*. +
*_Example:_* Select *Greater than or equal to* and enter 300 as the *Amount*. This will allow that all payments with an amount of 300 and more displayed.

| *Mapping*
|Select *Assigned* or *Unassigned*. +
*Assigned* = Shows only payments that have already been assigned to an order. +
*Unassigned* = Shows only payments that have not been assigned to an order yet.

| *Status*
|Select a status to search for payments with this specific status.

| *Transaction type*
|Select a transaction type to search for payments that have this transaction type.

| *Currency*
|Select a currency to search for payments with this currency.

| *Date type*
|Select a date type and combine it with a date range. You can choose between *Imported*, *Received* and *Assigned*. Displayed are all payments which were either imported, received or assigned in the chosen date range.

| *From* and *To*
|In connection with *Date type*, choose a date range to search for payments which were either imported, received or assigned, depending on what you selected.

| *Reset*
|Resets the selected filter criteria.

| *Search*
|Starts the search. The payments found are listed in the overview. +
*_Tip:_* Don’t choose any filters if you want to see all of the payments in the overview.

|====


[#save-current-filter]
=== Saving the current filter

When you start a search, your selected filters are displayed at the top as chips. You can save these filters to apply them again more quickly and easily in the future.

[.instruction]
Saving the current filter: 

. Start a <<#20, search>>.
. Click on *Saved filters* (material:bookmarks[]).
. Click on material:bookmark_border[] *Save current filter*.
. Enter a name for the filter.
. Decide whether
** this filter should be <<#default-filter, set as default filter>> (material:toggle_on[role=skyBlue])
** this filter should be created for all users (material:toggle_on[role=skyBlue]).
. Click on *SAVE*. +
→ The filter now appears under *Saved filters* (material:bookmarks[]).

[TIP]
Use drag-and-drop to arrange the filters in a specific order by clicking on *Move* (material:drag_indicator[]). Click on material:delete[] to delete a filter.

[#apply-saved-filters]
=== Applying saved filters

Proceed as follows to apply an already saved filter for the search.

[.instruction]
Applying saved filters: 

. Click on *Saved filters* (material:bookmarks[]).
. Click on a filter that you have already created. +
→ The search is started and the filter settings are displayed at the top as chips.

[#default-filter]
== Setting a default filter

To make sure that you don’t have to select a filter that you use quite often from the list of your <<#apply-saved-filters, saved filters>> every time when opening the *Orders » Payments* menu, you can set a created filter as default filter. Every time when you open the *Orders » Payments* menu, this filter will be automatically applied.

You can set the filter as default filter directly when creating it as described in <<#save-current-filter, Saving the current filter>> or you can set the filter as default in the overview afterwards.

Click in the line of the saved filter on material:star_border[] *Set as default*. If you want to set another filter as default filter, deactivate the currently selected default filter by clicking on material:star[] *Do not use as default*.


[#payments-myview]
== Using MyView

The user interface of the detail view of payments as well as the split view of a payment are available as MyView components. This means that users can create their own views with the available elements. This way, every user can individually determine which information are needed where. Because of this customisation, working with payments is not only more comfortable but also faster. +
This chapter explains how to work with MyView and how to create your own views. Managing payments such <<#30, assigning>>, <<#40, detaching>> or <<#50, splitting>> payments is explained in the following chapters.

You can access the detail view of a payment from the payment overview table in the *Orders » Payments* menu. Click on the row of the payment you want to work with and the detail view of this payment opens. +
The split view of a payment is accessed by clicking on *Split payment* (material:call_split[]) in the row of the payment you want to split. +
If you haven’t yet created an own view in these areas, the *Default view* is displayed. You can use this default view when you are working with payments or you can create your own view. The views you create are saved and can then be selected together with the default view from the list of views (icon:caret-down[role="darkGrey"]). Thus, you can switch between different views, if needed. The view selected last is always applied when opening a payment.

[#create-new-view]
=== Creating a new view

. Click on the list of views (icon:caret-down[role="darkGrey"]).
. Click on material:add[] *Create new preset...*.
. Enter a name.
. Click on *Create view*. +
→ The new view is created and opens automatically, i.e. the view is applied. It’s now possible to switch between different views.

[#create-grid]
=== Creating a grid

. Click on *Edit view* (terra:design_inline_edit[]).
. Add rows and columns to create a grid.
.. Click on icon:ellipsis-v[role="blue"] and then on material:add[] *Add row*.
.. Click on material:add[] *Add column*.
.. Drag the columns to make them larger or smaller.

[#place-elements]
=== Placing elements

. Add elements via drag-and-drop.
. Click on material:edit[role=blue] and edit the element’s settings.
.. Change the name.
.. Decide which data fields the element should contain.
.. Use drag-and-drop to arrange the data fields in a specific order.
. Click on icon:close[role="blue"]

[cols="1,4a"]
|====
|Symbol |Explanation

| icon:pencil[role="blue"]
|Leads down one level.

| icon:trash[role="blue"]
|Deletes the element.

| icon:close[role="blue"]
|Leads up one level.
|====

[TIP]
.Can I add elements multiple times?
======
The number in the grey circle indicates how many times you can use the element. Most elements can only be added once.
======

[#finalise-editing]
=== Finalising your work

. Save the view (terra:save[role="darkGrey"]) and close the editing mode (icon:close[role="darkGrey"]).
. Check the result in the main window.
. If necessary:
.. Click on *Edit view* (terra:design_inline_edit[]) to further edit the view.
.. Allow other users to see the view.

[#editing-functions]
==== Functions in the editing mode

[cols="1,4"]
|====
|Symbol |Explanation

| icon:reply[role=darkGrey]
|Undoes the last change, unless this change has already been saved.

| icon:share[role=darkGrey]
|Restores the previously undone change.

| icon:caret-down[role="darkGrey"]
|A list of views.
You see the name of whichever view is currently open.
Click on icon:caret-down[role="darkGrey"] to switch to another view or <<#create-new-view, create a new view>>.

| terra:items_incoming_history[]
|Resets the view to the state that was last saved.

| terra:save[role="darkGrey"]
|Saves the changes made to the view.

| terra:close[]
|Closes the editing mode.
In case of unsaved changes, a dialogue is displayed.
|====

[#900]
==== Granting rights

Which users or roles should be allowed to see the view?
You can grant or limit access to every single view.

[tabs]
====
Users::
+
--

. Click on *Edit view* (terra:design_inline_edit[]).
. Click on terra:open_external_link[] *Rights management*.
. Select *User* if you want to grant access to a specific user account. +
→ The menu *Setup » Settings » User » Rights » User* opens in a new tab.
. Search for (material:search[]) and open the appropriate user account.
. Click on *Views*.
. Expand the entries (icon:chevron-right[role="darkGrey"]) and select (material:check_box[role=skyBlue]) the views that the user should have access to.
. Save (terra:save[role="darkGrey"]) the settings.

Further information about user accounts and access rights can be found xref:business-decisions:user-accounts-access.adoc#112[here].

--
Roles::
+
--

. Click on *Edit view* (terra:design_inline_edit[]).
. Click on terra:open_external_link[] *Rights management*.
. Select *Roles* if you want to grant access to an entire user role. +
→ The menu *Setup » Settings » User » Rights » Roles* opens in a new tab.
. Search for (material:search[]) and open the appropriate user role.
. Click on *Views*.
. Expand the entries (icon:chevron-right[role="darkGrey"]) and select (material:check_box[role=skyBlue]) the views that the user role should have access to.
. Save (terra:save[role="darkGrey"]) the settings.

Further information about user accounts and access rights can be found xref:business-decisions:user-accounts-access.adoc#112[here].

--
====

[#30]
== Assigning payments

There are several ways to assign unassigned payments to an order. In the *Orders » Payments* menu, you can either assign payments directly in the overview or you open the detail view of a payment and assign it from there.

[TIP]
.Recommendation: Sort out unassigned payments once a week
====
At least once a week, you should edit and sort out the unassigned payments so that you don’t lose track of them in your day-to-day business.
====

Assigning payments in the overview is done by entering the corresponding order ID. This is an easy and fast way to assign payments when you

* already know the order the payment is to be assigned to
* do not need any further information about the payment
* and have the order ID ready.

Proceed as follows to assign a payment in the overview.

[.instruction]
Assigning a payment in the overview with the order ID:

. Go to *Orders » Payments*.
. Search (material:search[]) the desired payment as described in the <<#20, Searching for payments>> chapter.
. Enter the order ID of the order to which the payment is to be assigned in the *Order ID* field in the row of the unassigned payment.
. Press *Enter* to save it. +
→  The payment is assigned and the overview is updated.

If a fast assignment in the overview is not possible and you need more information about a payment, open the detail view of a payment. To do so, click into the row of the payment in the overview table or directly click on the payment ID. You can also click on the action *Assign payment* (material:credit_card[]) in the overview table to open the detail view of a payment.
To assign a payment in the detail view, proceed as follows.

[.instruction]
Assigning a payment in the detail view:

. Go to *Orders » Payments*.
. Search (material:search[]) the desired payment as described in the <<#20, Searching for payments>> chapter.
. Open the payment by clicking either into the row of the unassigned payment you want to assign, on the payment ID or on *Assign payment* (material:credit_card[]). +
→ You are redirected to the *Assignment* portlet of the payment. +
→ The orders with the highest matching rates are displayed there.
. Select the appropriate order and click on *Assign payment* (material:credit_card[]). +
→ The payment is assigned to the selected order. Only the selected assignment is shown.

The matching between payments and orders are checked on the basis of a background matrix. This check is initiated as soon as you open the *Assignment* table in the detail view of a payment. A maximum of 10 orders with the highest matching rates are displayed in descending order. +
As soon as you assigned the payment only the selected match will be displayed in this table. Only when the payment is <<#40, detached>> from the order, will the matchings with the highest rates be displayed again.

In case no matchings are shown in the assignment table, you have other options how to proceed. You can select the following options via the context menu (material:more_vert[]):

* *Assign order ID*: When you select this option, an editing window opens. Here, you can directly enter the order ID to which you want to assign this payment. Click on *Assign* to assign the payment to the entered order ID.
* *Search orders*: When you select this option, you are redirected to the order search. In the order search, the filters *Contact name*, *Amount* and *Unpaid and partially paid* are preselected. This way, possible appropriate orders are already displayed. You can adapt the order search to find the required order. Afterwards, you can enter the order ID in the assignment table and assign the payment.

Several payments can be assigned to the same order. This can happen, for instance, if the first payment did not cover the whole order amount. If one or several payments are already assigned to an order and you want to assign another one, you have to confirm this assignment.

[.collapseBox]
.Customising the assignment table
--

The table is customisable. This means that you can decide which table columns are displayed in which order. When opening the menu, the following table columns are displayed by default:

* Matching rate
* Order ID
* Amount
* Action

The following table columns can be displayed but are not shown by default:

* Contact ID
* Contact name
* Invoice number

Adapt the table according to your requirements and your workflow.  When you have adapted the table, these settings are saved and applied every time you open this menu. The table remains editable, you can change it any time.

[.instruction]
Customising the table:

. Click on *Configure columns* (material:settings[]). +
→ The window *Configure columns* opens.
. Select which columns you want to be displayed.
. Move (material:drag_indicator[]) the columns so they are displayed in the order you need them in.
. Click on *Confirm* to save your settings. +
→ Your settings are saved and applied.

--

[#15]
=== Booking a payment manually in an order

In order to manually book a payment or partial payment in the order, e.g. because the customer picked up the item and paid the item in cash or because a payment cannot be found in the overview, proceed as follows.

[.instruction]
Booking a payment:

. Go to *Orders » Edit orders*.
. Open the order for which you want to book a payment. +
→ The *Overview* tab opens.
. Open the *Payment* tab.
. Click on *Book payment*. +
→ The *Book payment* window opens.
. Carry out the settings. Note <<#table-manually-booking-payments>>.
. Click on *Book payment*. +
→ The payment is booked and displayed in the payment overview.

[[table-manually-booking-payments]]
.Booking payments manually
[cols="1,3"]
|====
|Setting |Explanation

| *Amount*
|Enter the full or partial amount that you want to book.

| *Credit/Debit*
| Select *Credit* or *Debit*. The selection depends on the open amount. *Credit* is selected by default. *Debit* is selected for negative pending amounts, e.g. overpaid payments. This selection can be changed if needed.

| *Currency*
|Select the currency in which the payment should be made.

| *Exchange rate*
|If needed, enter a different exchange rate than what is currently configured in the system. +
*_Important_*: In some cases, you may want to book a payment in a different currency than is currently selected for the payment (xref:payment:currencies.adoc#30[default currency]), e.g. in US dollars. In this case, select the option *USD* under *Currency* and enter the amount received under *Amount*. +
If you calculated the xref:payment:currencies.adoc#20[exchange rate] in the *Setup » Orders » Payment » Currencies* menu and you want to use this exchange rate, do not enter anything under *Exchange rate* because this exchange rate is automatically used. You will need to make an entry under *Exchange rate* if you want to use a different exchange rate for this payment, e.g. the exchange rate at the exact moment when the payment is received. In this case, enter the exchange rate that is applicable at this moment.

| *Designated use*
|The order ID is entered by default. The entry can be changed.

| *Incoming payment*
|Select the date of the incoming payment. The current date is set by default.
|====

You can recognise manually booked payments by the material:extension[] *Manual booking* icon.

[#40]
== Detaching payments

There are 2 ways to detach a payment from an order. In the *Orders » Payments* menu, you can either detach payments directly in the <<#detach-payment-overview, overview>> or you open the <<#detach-payment-detail-view, detail view>> of a payment and detach it from there.

[#detach-payment-overview]
=== Detaching a payment in the overview

[.instruction]
Detaching a payment in the overview:

. Go to *Orders » Payments*.
. Search (material:search[]) the desired payment as described in the <<#20, Searching for payments>> chapter.
. Click on *Detach payment* (material:money_off[]) in the row of the payment you want to detach from an order. +
→ The payment is detached from the order and is displayed again as an unassigned payment.

[#detach-payment-detail-view]
=== Detaching a payment in the detail view

A payment can also be detached from the detail view. To do so, proceed as follows.

[.instruction]
Detaching a payment in the detail view:

. Go to *Orders » Payments*.
. Search (material:search[]) the desired payment as described in the <<#20, Searching for payments>> chapter.
. Click in the row of the payment you want to detach and open it. +
→ The detail view of the payment opens.
. Open the *Assignment* table. +
→ When the table opens, the existing order assignment is shown.
. Click on *Detach payment* (material:money_off[]). +
→ The payment is detached from the order. The highest matching rates for this payment are once again shown.

[IMPORTANT]
.Note when detaching payments
====
Detaching a payment from an order is technically possible at all times, even when order processing has advanced or is completed. Detaching a payment should only be done cautiously and with good reason because errors, for example that a payment no longer covers an open order amount, are likely to occur when a payment is detached and assigned repeatedly. Also note that detaching a payment also causes changes to the order it was detached from, for example a recalculation of the payment of an order or a status change.
====

[#50]
== Splitting payments

Manually booked incoming payments, imported bank postings as well as EBICS payments can be split in the *Orders » Payments* menu. This means that the amount of a payment can be split and assigned to several orders. Note that Provisional postings cannot be split. To split payments, proceed as follows.

[.instruction]
Splitting a payment:

. Go to *Orders » Payments*.
. Search (material:search[]) the desired payment as described in the <<#20, Searching for payments>> chapter.
. Click on *Split payment* (material:call_split[]) in the row of the payment you want to split. +
→ You are redirected to another view to proceed with splitting the payment.
. Search (material:search[]) for the required orders with the search filters *Order ID*, *Invoice number*, *External order ID*, *Contact ID* and *Name*. You can enter several IDs/numbers by separating them with a comma.
. Select the orders between which you want to split the payment from the search results.
. Click on *Save* (material:save[]). +
→ The payment is split and assigned to the selected orders in the order in which they are shown in the table, from the top down and you are redirected to the payments overview. Here, the created partial payments can be edited in the same way as the other payments.

When splitting a payment, the amount of the payment is reduced by the corresponding amounts of the orders that were selected during the division of the payment. Both the original total amount of the payment as well as the remaining amount are displayed in this view. When a remaining amount is created by splitting a payment, this amount could be split again.

*_Example:_* Imagine you want to split a payment with the amount of 120 Euros into order A, which has an open amount of 80 Euros, and into order B, which has an open amount of 20 Euros. By splitting the payment and selecting these two orders, order A is assigned 80 Euros and order B 20 Euros. The payments created by splitting the original payment are automatically assigned to the selected orders. An amount of 20 Euros is left from the original payment. You can now assign this leftover amount to another order or, if required, can split it again.

[IMPORTANT]
.Splitting a payment cannot be reversed
====
Once you split a payment, this _cannot_ be reversed. In order to restore the original payment, delete all partial payments. When a partial payment is deleted, the amount is added again to the original payment. Before deleting a partial payment, it has to be <<#40, detached>> from the order because only unassigned payments can be deleted.
====

In the split view of a payment, info boxes provide a quick overview of the most important information:

* Amount
* Received on
* Sender of payment
* Reason for payment
* Remaining amount

Optionally, you can go to *Edit view* (terra:design_inline_edit[]) and remove or rearrange info boxes by positioning them via drag-and-drop. The names of the info boxes can also be adjusted. Moreover, determine in the *Settings* of the portlet how many cards (info boxes) are displayed per row.

The search table is customisable. By default, all available columns are displayed:

* Order ID
* Contact ID
* Name
* Invoice number
* Referrer
* Order date
* Open amount

By using the *Configure columns* function (material:settings[]), you can determine which columns are displayed in which order. +
*_Optional:_* Go to *Edit view* (terra:design_inline_edit[]) and determine in the *Settings* of the *Search* portlet whether by default it should be collapsed or not when opening the *Split payment* view. To do so, use the *Portlet collapsed* option. +
Do you want to change the portlet name? Enter the desired name in the *Title* field.

[#60]
== Deleting payments

You can only delete a payment when it is _not_ assigned to an order and _no_ child payments (partial payments) resulting from splitting a payment exist. Deleting a payment can be carried out either directly in the <<#delete-payment-overview, overview>> table or in the <<#delete-payment-detail-view, detail view>> of a payment.

[#delete-payment-overview]
=== Deleting a payment in the overview

[.instruction]
Deleting a payment in the overview:

. Go to *Orders » Payments*.
. Click on *Detach payment* (material:delete[]) in the row of the payment you want to detach from an order. +
→ The query *Delete payment* opens.
. Click on *Yes*. +
→ The payment is deleted and the overview updated.

[.collapseBox]
.I want to delete a payment, but the delete function is deactivated. What can I do?
--
You can only delete payments when they are not assigned to an order and no child payments (partial payments) resulting from splitting a payment exist. If something of this applies, the *Delete payment* function (material:delete[]) is not available. If you still want to delete the payment, you have to make sure that the payment is not assigned and no child payments exist. To do so, proceed as follows:

* Payment is assigned to an order: <<#40, Detach>> the payment from the order. Before doing so, carefully check whether detaching the payment from the order can safely be carried out. +
→ The payment can now be deleted.
* Payment was split and partial payments exist: First, you have to delete the partial payments. This is only possible if the payment is _not_ assigned to an order. If the partial payments are assigned, you first have to <<#40, detach>> the payment from the respective order. Before doing so, carefully check whether detaching the payment from the order can safely be carried out. Afterwards, delete the partial payments. +
→ The original payment can now be deleted.
--

[#delete-payment-detail-view]
=== Deleting a payment in the detail view

[.instruction]
Deleting a payment in the detail view:

. Go to *Orders » Payments*.
. In the row of the payment, click on the payment that you want to delete. +
→ The detail view of the payment opens.
. Above the payment details, click on *Delete payment* (material:delete[]). +
→ The query *Delete payment* opens.
. Click on *Yes*. +
→ The payment is deleted and you are redirected to the updated overview.

[.collapseBox]
.I want to delete a payment, but the delete function is deactivated. What can I do?
--
You can only delete payments when they are not assigned to an order and no child payments (partial payments) resulting from splitting a payment exist. If something of this applies, the *Delete payment* function (material:delete[]) is not available. If you still want to delete the payment, you have to make sure that the payment is not assigned and no child payments exist. To do so, proceed as follows:

* Payment is assigned to an order: <<#40, Detach>> the payment from the order. Before doing so, carefully check whether detaching the payment from the order can safely be carried out. +
→ The payment can now be deleted.
* Payment was split and partial payments exist: First, you have to delete the partial payments. This is only possible if the payment is _not_ assigned to an order. If the partial payments are assigned, you first have to <<#40, detach>> the payment from the respective order. Before doing so, carefully check whether detaching the payment from the order can safely be carried out. Afterwards, delete the partial payments. +
→ The original payment can now be deleted.
--

[#70]
== Carrying out the group function

Using the group function, you can edit several payments at the same time. To use the group function, at least one payment has to be selected. Use the <<#20, search>> to filter the desired payments. After selecting the payments you can either auto-assign them all at the same time or delete them all at the same time. Remember that only unassigned payments can be deleted.

Proceed as follows to either assign or delete payments by using the group function.

[.instruction]
Editing payments by using the group function:

. Go to *Orders » Payments*.
. Select the incoming payments (material:check_box[role=skyBlue]) that you want to assign or delete.
. Above the overview table, click either on *Delete payments* (material:delete[]) or on *Auto-assign payments* (material:credit_card[]). +
→ You have to confirm or deny the deletion or the assignment of the payments.
. After having carried out this function, it is displayed how many of the selected payments could be auto-assigned or deleted.

[TIP]
.Payment that are assigned to an order cannot be deleted
====
Sometimes, not the whole selection can be edited. For example, one or several of the selected payments that you want to delete could be assigned to an order. In this case, payments _cannot_ be deleted. If you need further information why a payment could not be auto-assigned or deleted, you can refer to the log. For this, go to the *Data » Log* menu.
====

Note that the auto-assignment depends on the <<#intable-match-automatic-assignment, setting>> *Match for automatic assignment (0.7 - 1.0)* in the *Setup » Orders » Payment » Incoming* menu. The value 0.7 stands for a 70% match and the value 1.0 stands for a 100% match. If at least two orders are found with the same matching rate while auto-assigning payments via the <<#70, group function>>, the payment _cannot_ be assigned. This also means that a payment can only be auto-assigned when just one order with the corresponding matching rate was found.

[#80]
== Detail view of a payment

Besides the functionalities <<#30, assigning payments>>, <<#40, detaching payments>> and <<#60, deleting payments>>, the detail view offers an overview over all information connected to a payment in different portlets. By using the <<#payments-myview, MyView>>, you can configure and arrange the elements of the detail view according to your needs.

[#details]
=== Details

In the default view, the following basic information are displayed in the *Details* portlet:

* Payment method
* Received on
* Transaction ID
* Reason for payment

*_Optional:_* Go to *Edit view* (terra:design_inline_edit[]) and additionally add the element *Sender of payment* or remove other elements. Rearrange the elements of the portlet by positioning them via drag-and-drop. +
Moreover, determine in the *Settings* of the portlet whether by default it should be collapsed or not when opening the detail view of a payment. To do so, use the *Portlet collapsed* option. +
Do you want to change the portlet name? Enter the desired name in the *Title* field.

.Editing details portlet
image::payment:portlet-details-edit.png[]

[#info-boxes]
=== Info boxes

Info boxes provide a quick overview of important payment information. In the default view, the info boxes *Amount in foreign currency* (the currency in which the payment was made), *Status* and *Payment method* are displayed. +
The payment status is additionally shown by the coloured status bar of the *Status* info box.

* Green = The payment was processed. This either means approved, captured or refunded.
* Orange = The payment is being processed. This either means waiting for renewal, waiting for approval or partially captured.
* Red = The payment was not processed. This either means refused, cancelled or expired.

Optionally, you can go to *Edit view* (terra:design_inline_edit[]) and remove elements or additionally add the following info boxes as elements to this portlet:

* Received on
* Exchange rate
* Assignment date
* Transaction ID
* Reason for payment
* Sender of payment
* Amount in system currency

Rearrange the elements of the portlet by positioning them via drag-and-drop. Moreover, determine in the *Settings* of the portlet how many cards (info boxes) are displayed per row.

.Editing info boxes portlet
image::payment:portlet-info-boxes-edit.png[]

[#assignment]
=== Assignment

The *Assignment* portlet offers a list of the orders with the highest matching rate for an unassigned payment. If a payment is already assigned, only the order which it is assigned to is displayed here. Only when the payment is <<#40, detached>> from the order, will the matchings with the highest rates be displayed again. +
The matching between payments and orders are checked on the basis of a background matrix. This check is initiated as soon as you open the *Assignment* area. A maximum of 10 orders with the highest matching rates are displayed in descending order.

Moreover, you can detach an assigned payment in the assignment table. Click on *Detach payment* (material:money_off[]). But take into account that <<#40, detaching payments>> should not be done without good reason.

The assignment table is customisable. By default, all available columns are displayed:

* Matching rate
* Order ID
* Amount
* Contact ID
* Contact name

By using the *Configure columns* function (material:settings[]), you can determine which columns are displayed in which order. +
*_Optional:_* Go to *Edit view* (terra:design_inline_edit[]) and determine in the *Settings* of the *Assignment* portlet whether by default it should be collapsed or not when opening the detail view of a payment. To do so, use the *Portlet collapsed* option. +
Do you want to change the portlet name? Enter the desired name in the *Title* field.

.Portlet settings
image::payment:portlet-settings.png[]

[#payment-history]
=== Payment history

The *History* portlet offers an overview over all actions executed for this payment. It is also shown who or what (e.g. a plugin) initiated an action at what time so that transparency is always ensured.

You see at a glance when (date) who (user or other sources, e.g. a plugin) did what (action and value, e.g. Assigned | Order ID xy) with the payment.    The following entries can be seen in the payment history, for example:

* Import date of a payment
* Information about the assignment of a payment to an order
* Information about the detachment of a payment from an order
* Currency changes
* Exchange rates
* Changes in amounts
* Status changes
* Creation/change of properties


The table is customisable. By default, the columns *Date*, *User / Source*, *Action* and *Value* which are all the available columns, are displayed. +
Note that the entries in the column *Value* are always in English because this data is taken directly from the database. By using the *Configure columns* function (material:settings[]), you can determine which columns are displayed in which order.

*_Optional:_* Go to *Edit view* (terra:design_inline_edit[]) and determine in the *Settings* of the *History* portlet whether by default it should be collapsed or not when opening the detail view of a payment. To do so, use the *Portlet collapsed* option. +
Do you want to change the portlet name? Enter the desired name in the *Title* field.

[#properties]
=== Properties

The portlet *Properties* shows all information belonging to the payment.  These information usually exceed the information given in the details. Which information are shown in the Properties depends on the payment itself, for example which payment method was used or which information a  payment provider transfers.

*_Optional:_* Go to *Edit view* (terra:design_inline_edit[]) and determine in the *Settings* of the *Properties* portlet whether by default it should be collapsed or not when opening the detail view of a payment. To do so, use the *Portlet collapsed* option. +
Do you want to change the portlet name? Enter the desired name in the *Title* field.

[#100]
== Displaying incoming payments on the dashboard

You can add the element *Payments* to the xref:welcome:customise-system.adoc#110[dashboard] of your plentymarkets back end. This element displays information about unassigned payments as well as about all incoming payments from yesterday and today. If you don’t want to use this element on your dashboard, you can get the same results by going to *Orders » Payments* and using the <<#20, search filters>>.

It is recommended that you take a look at the unassigned payments before editing orders. You should see whether incoming *cash in advance* payments are among them, which can usually be assigned to an order without a doubt thanks to the amount and the booking text. This saves your customers long waiting times and it saves you unpleasant complaints.

[TIP]
.Recommendation: Sort out unassigned payments once a week
====
At least once a week, you should edit and sort out the unassigned payments so that you don’t lose track of them in your day-to-day business. For further information about assigning unassigned payments and bookings to orders, refer to the <<#30, Assigning payments>> chapter.
====

[TIP]
.Payments from Sofortbanking payments
====
Sofortbanking payments will be confirmed via an interface immediately after the payment process. They will then appear again in the system as bank postings. You can delete these bank postings from the list of unassigned payments without concern because the orders in question have already been assigned to the payment.
====
