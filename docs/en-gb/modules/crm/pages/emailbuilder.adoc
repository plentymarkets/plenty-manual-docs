= EmailBuilder (Test phase)
:keywords: EmailBuilder, Email Builder, email templates, widgets, e-mail templates, document attachment email, attach documents email, construction kit emails, email variables, twig expressions, email despatch, code widget
:description: Learn how to use the EmailBuilder in plentymarkets.
:page-aliases: emailbuilder-testphase.adoc
:id: MYFLVYO
:author: team-crm

All emails that are sent with plentymarkets to your xref:crm:contacts.adoc#[contacts] are based on templates. You create and manage templates with the EmailBuilder in the *CRM » EmailBuilder (Test phase)* menu. 

[TIP]
.Email templates are sent in multipart format
====
The email templates in the EmailBuilder use the multipart format. This means that the emails are sent in an HTML and in a text version at the same time. +
This ensures that your emails can be read by all recipients, even if their email client restricts or completely disables the display of HTML in emails. On the other hand, the HTML versions of your emails that you designed are displayed for the recipients whose email client allows the display of HTML. The advantage for you is that you only have to maintain one email template.
====

The EmailBuilder is a modular construction kit for quickly creating and editing your email templates via drag-and-drop. The EmailBuilder consists of 2 views: the configuration manager and the editor.

* With the configuration manager, you create folders and, if needed, sub-folders, templates as well as templates for your footer and your header. 

* With the editor, you fill your templates, headers and footers with content. You can create a template for an invoice, for example, and use this template for all invoices that are sent to your customers in the future.

You can then use the header and footer templates in the email templates as desired. Header and footer are globally active; changes you make to the header and footer affect the rest of all existing templates and all other templates that you will create in the future.

The header, the footer and the settings in the template such as the name, the subject etc. form the framework of your email, so to say. The content of the template is formed with <<#insert-widgets, widgets>> and <<#variables-emailbuilder, variables>>. In the emails that are sent to your customer, the variables will then be replaced with the correct content. For example: The variable `Delivery address First name and last name` will be replaced in the email with the first name and the last name of the contact from the delivery address.

In case of certain events, e.g. if a new order is placed in your plentyShop or when a contact subscribes to a newsletter, your plentymarkets system automatically <<#automate-email-despatch, creates emails from these templates>> and sends them to your contacts.

[#preparatory-settings]
== Carrying out the preparatory settings

The following sub-chapters describe which preparatory settings are needed so that you can work with the EmailBuilder.

[#assign-rights]
=== Assigning rights for back end users

:rights-purpose: work with the EmailBuilder
:right-one: pass:quotes[*CRM > EmailBuilder > Show*]
:right-two: pass:quotes[*CRM > EmailBuilder > Create*]
:right-three: pass:quotes[*CRM > EmailBuilder > Update*]
:right-four: pass:quotes[*CRM > EmailBuilder > Delete*]
:right-five: pass:quotes[in the area *Menu visibilities*: *CRM > EmailBuilder*]

include::_includes:partial$rights.adoc[]

[#email-server-login-details]
=== Saving the email server’s login details

In the *Email accounts* assistant in the *Setup » Assistants » Basic setup* menu, you save the login details of a mailbox so that plentymarkets emails such as order or shipping confirmations can be sent from this email address.

[.collapseBox]
.Settings in the *Email accounts* assistant in the *Login details* step
--
[[table-email-server-login-details]]
.Saving email server login details in the *Email accounts* assistant
[cols="1,3"]
|====
|Setting |Explanation

2+| Enter the server details of your email provider. +
Enter the outgoing mail server / SMTP server and the port and select the encryption method from the list. You can obtain this data from your email provider.

| *Outgoing mail server/SMTP server*
|Enter the outgoing mail server as specified by the provider (usually smtp.domain.co.uk or mail.domain.co.uk). +
*_mailbox.org:_* For mailbox.org mailboxes, enter the outgoing mail server *smtp.mailbox.org* and select the encryption method *SSL*.

| *Port (standard port: 25)*
|Enter the value *25*. This value is correct for nearly all providers. Otherwise, ask your provider about the correct port. +
*_mailbox.org:_* For mailbox.org mailboxes, enter port *465* and select the encryption method *SSL*.

| *Encryption method*
| Select *SSL*, *TLS* or *No encryption*.  +
*_mailbox.org:_* For mailbox.org mailboxes, enter port *465* and select the encryption method *SSL*.

2+| Enter the login details of your email account 

| *Name of sender*
|Enter your own name or the name of your plentyShop. The name is displayed to the recipient. +
*_Note:_* Avoid using special characters in order to allow for correct display.

| *Email address*
|Enter the email address as it is listed in the email programme.

| *User name*
|Enter the user name that matches the email address. +
*_mailbox.org:_* The mailbox.org user name is the complete email address of the mailbox.org mailbox.

| *Password*
|Enter the password that matches the user name and email address.

2+|Would you like to test the email despatch now? +
Click on material:outgoing_mail[] to send a test email to the email address entered above.

2+|Would you like to activate the live mode? +
During setup, the live mode is deactivated. This means that outgoing emails are sent only to the email address that was entered above. This allows you to test the email despatch. After you have finished setting up your system, you should activate the live mode in order that emails can be sent to your customers.

|(material:check_box_outline_blank[])
|If you do not place a check mark for *Activate live mode* (material:check_box_outline_blank[]), the test mode is activated. + All emails are only sent to the saved email address. This allows you to test the settings before switching to the live mode. +
*_Important:_* The test mode is only applied to this online shop. The settings for additional clients (shops) are carried out in the client’s menu.

|(material:check_box[role=skyBlue])
|If you place a check mark for *Activate live mode* (material:check_box[role=skyBlue]), the live mode is activated.

|====
--

[#email-signature]
=== Saving the email signature

Go to the *Email accounts* assistant in the *Setup » Assistants » Basic setup* menu to save the signature. The signature is then automatically added to your email templates when you inserted the corresponding variable in the template.

[IMPORTANT]
.Note the priority of the signature
====
The signature that was saved for a user in his or her user account in the *Setup » Settings » User » Accounts* menu takes priority over the signature that is saved in the *Email accounts* assistant in the *Signature* step. +
*This means:*_ If you insert, for example, the variable `Signature in HTML format` in the email template, the signature is taken from the user account. If no signature is saved in the user account, the signature that is saved in the *Email accounts* assistant in the *Signature* step is used.
====

[#e-mail-info-service]
=== Setting up the email information service

In the *Email accounts* assistant in the *Setup » Assistants » Basic setup* menu, you set to send a blind copy of all emails sent by your plentymarkets system to an email address of your choice. This can be particularly helpful in the early stages of your online shop, as it allows you to maintain an overview of all sent emails and recognise where processes can still be improved. You can also set here that you automatically receive an info email when a new order has been placed.

[.collapseBox]
.Settings in the *Email accounts* assistant in the *Info service* step
--
[[table-info-service]]
.Saving email server login details in the *Email accounts* assistant
[cols="1,3"]
|====
|Setting |Explanation

2+| Would you like to receive a blind copy of all emails sent by your plentymarkets system?

|*Receive emails as blind copy* (material:toggle_off[role=darkGrey])
|If you do not want to receive a blind copy, do _not_ activate the button (material:toggle_off[role=darkGrey]).

|*Receive emails as blind copy* (material:toggle_on[role=skyBlue])
|If you want to receive a blind copy, activate the button (material:toggle_on[role=skyBlue]). Enter in the field that appears below the email address(es). If you enter multiple email addresses, separate them with commas and do not use spaces.

|*Receive newsletter as blind copy*
|If you are using the xref:crm:sending-newsletters.adoc#[newsletter] integrated in plentymarkets, you can set here whether you want to receive a blind copy when a newsletter is sent.

2+| Would you like to receive an email when a new order is placed?

|*Receive email in case of a new order* (material:toggle_off[role=darkGrey])
|If you do not want to receive a blind copy when a new order is placed, do _not_ activate the button (material:toggle_off[role=darkGrey]).

|*Receive email in case of a new order* (material:toggle_on[role=skyBlue])
|If you want to receive a blind copy when a new order is placed, activate the button (material:toggle_on[role=skyBlue]). Enter in the field that appears below the email address(es). If you enter multiple email addresses, separate them with commas and do not use spaces.

|====
--

[#manage-folders]
== Managing folders

In the EmailBuilder, you can create as many <<#create-folder, folders>> as you like and upt to 3 <<#create-sub-folder, sub-folders>>. After you created the folder, click on material:more_vert[] to create new sub-folders, new templates in general and new header and footer templates and <<#rename-folder, rename>>, <<#move-folder, move>> or <<#delete-folder, delete>> the folders.

Your plentymarkets system contains a folder with pre-defined default templates. These are explained further down on this page in the <<#use-default-templates, Using default templates>> chapter.

[[image-emailbuilder-folder-structure]]
.Folder structure in the EmailBuilder
image::crm:emailbuilder-add-folder-template-header-footer.png[width=640, height=360]

[#create-folder]
=== Creating a folder

Create folders to get a better overview of your email templates at a later point in time. Proceed as described below to create a new folder.

[.instruction]
Creating a folder:

. Go to *CRM » EmailBuilder (Test phase)*.
. In the bottom left corner, click on material:add[] *Add* material:play_arrow[].
. Click on material:folder[] *Folder*. +
→ The *Create new folder* window opens.
. Enter the name for the folder.
. Click on *Save*. +
→ The new folder is added to the folder list.

[TIP]
Once you have carried out all settings as described in the following – so you have created sub-folders, templates, headers and footers –, you can open the main folder by clicking on material:chevron_right[] _Name of the folder_. You will see there at a glance all sub-folders, templates, headers and footers that you created directly in the main folder.

[#rename-folder]
=== Renaming the folder

You can update the folder name at any time. To do so, proceed as described below.

[.instruction]
Renaming the folder:

. Go to *CRM » EmailBuilder (Test phase)*.
. In the line of the folder that you want to rename, click on material:more_vert[]. +
→ A new window opens.
. Click on material:edit[] *Rename*. +
→ The *Rename folder* window opens.
. Enter an other name for the folder.
. Click on *Save*. +
→ The new folder name is updated and shown in the list.

[#move-folder]
=== Moving a folder

You can move the folder to another position at any time. To do so, proceed as described below.

[.instruction]
Moving a folder:

. Go to *CRM » EmailBuilder (Test phase)*.
. In the line of the folder that you want to move, click on material:more_vert[]. +
→ A new window opens.
. Click on material:move_down[] *Move*. +
→ The *Move* window opens.
. Select the target folder.
. Click on *Move*. +
→ The folder is moved to the selected folder.

[#create-sub-folder]
=== Creating a sub-folder

Create sub-folders in your folders to group your email templates in even more detailed topics. You can create up to 3 sub-folders within a folder.

[TIP]
.Create a draft for your folder structure in advance
====
We recommend creating a draft in advance to avoid confusing and unclear nesting levels in your folder structure. Because: The more levels you create, the more complex the structure will be.
====

[.instruction]
Creating a sub-folder:

. Go to *CRM » EmailBuilder (Test phase)*.
. In the line of the folder that you want to create a sub-folder for, click on material:more_vert[]. +
→ A new window opens.
. Click on material:add[] *Add*.
. Click on material:folder[] *Folder*. +
→ The *Create new folder* window opens.
. Enter the name for the sub-folder.
. Click on *Save*. +
→ The sub-folder is created within the main folder.

Open the sub-folder by opening the main folder with a click on material:chevron_right[]. You can see all sub-folders that you created at a glance.

[#delete-folder]
=== Deleting a folder

You can delete folders and sub-folders at any time. Note that the entire content in the folder will also be deleted.

[.instruction]
Deleting a folder:

. Go to *CRM » EmailBuilder (Test phase)*.
. In the line of the folder or sub-folder that you want to delete, click on material:more_vert[]. +
→ A new window opens.
. Click on material:delete[] *Delete*. +
→ A window opens and you need to confirm your decision.
. Click on material:delete[role=red] *Delete*. +
→ The folder with all corresponding sub-folders and templates contained in there will be deleted.

[#manage-templates]
== Managing templates

Learn in the following sub-chapters how to create templates for <<#create-header, headers>> and <<#create-footer, footers>> and <<#create-template, general templates>>. Moreover, it is described how you <<#search-template, search for>>, <<#move-template, move>>, <<#copy-template, copy>>, <<#edit-template, edit>> and <<#delete-template, delete>> templates. +
You can also use pre-defined <<#use-default-templates, default templates>>. You will also learn everything about the available <<#insert-widget, widgets>> and how you can use these widgets in your templates.

[TIP]
Once you created a template, the template ID is shown in brackets in front of the template name. The systems assigns the IDs consecutively and automatically. This ID _cannot_ be changed.

The widgets and variables that are contained in the template form the actual content of your email. Via the widgets, you can insert as many variables as you like into a template by using drag-and-drop. These variables will then be replaced with the correct content when the email is sent to your customers.

To see which variables are available for your email templates, refer to the lists on the bottom of this page in the <<#variables-emailbuilder, Available variables and twig expressions>> chapter.

[#template-header-footer]
=== Creating templates for header and footer

Create templates for the header and the footer that you can later use in all of your email templates. Header and footer are globally active. This means: Changes you make to the header and footer affect the rest of all existing templates and all other templates that you will create in the future.

You can insert, for example, your company logo into the header and insert into the footer your signature and the general company details such as the address, links to social media, the legal structure of your company, details about your company’s executive board, and much more.

Proceed as described below to create a template for the <<#create-header, header>> and the <<#create-footer, footer>>.

[#create-header]
==== Creating a header template

Proceed as described below to create a template for the header of your email template.

[.instruction]
Creating a header template:

. Go to *CRM » EmailBuilder (Test phase)*.
. In the line of the folder or sub-folder in which you want to create a header, click on material:more_vert[]. +
→ A new window opens.
. Click on material:add[] *Add*.
. Click on material:web_asset[] *Header*. +
→ The *Create new header* window opens.
. Enter a name for the header.
. Click on *Save*. +
→ The header template is created.
. Click on *Add* (material:add[]) to <<#add-language, add a language>>. +
→ A new window opens.
. Select a language from the list. +
→ The window *New name* opens.
. Enter the header template’s subject.
. Click on *Save*.
. In the *Settings* area, select (material:check_box[role=skyBlue]) the owner and the client.
. Click on *Edit* (material:edit[]).
. Edit the header according to your wishes and insert <<#insert-widget, widgets>> and <<#variables-emailbuilder, variables>>.
. *Save* (material:save[]) the settings.

[#show-header-preview]
[discrete]
==== Showing the preview of the header

Check the header by opening the preview.

. Go to *CRM » EmailBuilder (Test phase)*.
. Expand the folder (material:chevron_right[]) that contains the header for which you want to show the preview.
. Click on the header.
. Click on *Preview* (material:preview[]).
. Select *Preview HTML* or *Preview plain text*. +
→ The preview opens in a separate window.
. Check the header.
. *Close* the window.

If you are not satisfied with the result, edit the content of your header again.

[#create-footer]
==== Creating a footer template

Proceed as described below to create a template for the footer of your email template.

[.instruction]
Creating a footer template:

. Go to *CRM » EmailBuilder (Test phase)*.
In the line of the folder or sub-folder in which you want to create a footer, click on material:more_vert[]. +
→ A new window opens.
. Click on material:add[] *Add*.
. Click on material:video_label[] *Filter*. +
→ The *Create new footer* window opens. +
. Enter a name for the footer.
. Click on *Save*. +
→ The footer template is created.
. Click on *Add* (material:add[]) to <<#add-language, add a language>>. +
→ A new window opens.
. Select a language from the list. +
→ The window *New name* opens.
. Enter the footer template’s subject.
. Click on *Save*.
. In the Settings area, select (material:check_box[role=skyBlue]) the owner and the client.
. Click on *Edit* (material:edit[]).
. Edit the footer according to your wishes and insert <<#insert-widget, widgets>> and <<#variables-emailbuilder, variables>>.
. *Save* (material:save[]) the settings.

[#show-footer-preview]
[discrete]
==== Showing the preview of the footer

Check the footer by opening the preview.

. Go to *CRM » EmailBuilder (Test phase)*.
. Expand the folder (material:chevron_right[]) that contains the footer for which you want to show the preview.
. Click on the footer.
. Click on *Preview* (material:preview[]).
. Select *Preview HTML* or *Preview plain text*. +
→ The preview opens in a separate window.
. Check the footer.
. *Close* the window.

If you are not satisfied with the result, edit the content of your footer again.

[#create-template]
=== Creating a template

Now create the template and save basic settings such as the name, the subject, CC and BCC and select the appropriate <<#create-header, header>> and <<#create-footer, footer>> for the template. Proceed as described below to create a new template.

[TIP]
.Switching between multiple templates
====
If you later edit multiple templates in the editor at the same time, you can use the navigation on the left to switch between the individual templates. The template that you have currently open is highlighted in blue font. 

Also it is shown in which template section you are currently in.

* If the material:edit[] *Edit (_language_)* area is highlighted in blue font in the navigation on the left side below the template, you are in the template’s editor.

* If material:translate[] *Language settings* is highlighted in blue font, you are currently in the template’s language-specific settings.

If you are in the editor or in the language settings of a template and want to switch to another template without having saved the changes beforehand, a message will be displayed.
====

[[image-emailbuilder-template]]
.Creating a template in the EmailBuilder
image::crm:emailbuilder-new-template.png[width=640, height=360]

[.instruction]
Creating a template:

. Go to *CRM » EmailBuilder (Test phase)*.
. In the line of the folder or sub-folder in which you want to create a template, click on material:more_vert[]. +
→ A new window opens.
. Click on material:add[] *Add*.
. Click on material:description[] *Template*. +
→ The *Create new template* window opens.
. Carry out the settings. Note <<#table-emailbuilder-create-template>> and <<#image-emailbuilder-template>>.
. *Save* (material:save[]) the settings.

*_Note:_* If you do not want to create the template within a folder, click on the start page of the *CRM » EmailBuilder (Test phase)* menu in the bottom left on material:add[] *Add* material:play_arrow[]and select material:description[] *Template* afterwards. The template will then be created on the first level and does not belong to a folder.

[TIP]
.Email templates are sent in multipart format
====
The email templates in the EmailBuilder use the multipart format. This means that the emails are sent in an HTML and in a text version at the same time. +
This ensures that your emails can be read by all recipients, even if their email client restricts or completely disables the display of HTML in emails. On the other hand, the HTML versions of your emails that you designed are displayed for the recipients whose email client allows the display of HTML. The advantage for you is that you only have to maintain one email template.
====

[[table-emailbuilder-create-template]]
.Creating a template in the EmailBuilder
[cols="1,3"]
|====
|Setting |Explanation

2+^| *Create new template* window

|[#intable-template-settings-name]*Name*
|What’s the name of the template? Enter a descriptive name so you can easily find the template at a later point in time. +
*_Note:_* This field is a mandatory field.

|[#intable-template-settings-header]*Header*
|Which header do you want to show in this template? Select a header from the drop-down list (material:arrow_drop_down[]). +
The list contains all <<#create-header, headers>> that you have already created.

|[#intable-template-settings-footer]*Footer*
|Which footer do you want to show in this template? Select a footer from the drop-down list (material:arrow_drop_down[]). +
The list contains all <<#create-footer, footers>> that you have already created.

|[#intable-template-settings-default-template]*Build from default template*
|Expand the area (material:arrow_drop_down[]) to select one of the <<#use-default-templates, default templates>> and link it with the new template. +
*_Note:_* In the next step, you can adjust the default template that you select here according to your needs.

| *Save*
|Saves the settings.

2+^| Area for the template’s content +
In this area, create the content of your template using widgets and variables.

|[#intable-template-settings-add]*Add*
|Click on material:add[] (*Add*) to select the <<#add-language, language of the template>>. +
<<#image-emailbuilder-add-languages>> shows the list with the languages after you clicked on material:add[].

|[#intable-template-settings-subject]*Subject*
|What’s the subject of your email? Enter the subject in the corresponding language.
*_Note:_* This field is a mandatory field.

| *Save*
|Saves the settings.

|[#intable-template-settings-reload]*Reload data*
|Click on material:refresh[] to reload the data if the preview doesn’t work properly after you made some changes.

|[#intable-template-settings-edit]*Edit*
|Click on material:edit[] to edit the content of the template and to use <<#insert-widget, widgets>> and <<#variables-emailbuilder, variables>>. +
The editor area opens and you can edit the content of the template by clicking on the widgets. +
Click on material:css[] in the toolbar on the top to adjust the <<#intable-template-settings-custom-styles, custom styles>> of your template.
*_Note:_* The email templates use the multipart format. This means that the emails are sent in an HTML and in a text version at the same time.

|[#intable-template-settings-preview]*Preview*
|Click on material:preview[] and select *Preview HTML* or *Preview plain text*. The preview opens in a separate window.

|[#intable-template-settings-copy]*Copy*
|Click on material:more_vert[] and then on material:content_copy[] *Copy* to copy the content and the settings of the template to another language. +
*_Note:_* The content is _not_ translated automatically. You have to add the translation yourself.

|[#intable-template-settings-delete]*Delete*
|Click on material:more_vert[] and then on material:delete[] *Delete*. After you have confirmed your decision, the template will be deleted.

2+^|[#intable-general-template-settings]*Settings* +
In the *Settings* area on the right side of your screen, you can carry out the general settings for the template in the corresponding language. 

|[#intable-template-settings-name]*Name*
|You can see the name here that you have just entered. If needed, you can adjust the name.

|[#intable-template-settings-owner]*Owner*
|Select the owner from the drop-down list.

|[#intable-template-settings-client]*Client*
|Select (material:check_box[role=skyBlue]) one or multiple clients from the list.

|[#intable-template-settings-header]*Header*
|You can see the header here that you have just selected for the template. If needed, you can select another header. +
*_Important:_* Make sure to select a header here that has the same language as the template.

|[#intable-template-settings-footer]*Footer*
|You can see the footer here that you have just selected for the template. If needed, you can select another footer. +
*_Important:_* Make sure to select a footer here that has the same language as the template.

|[#intable-template-settings-dynamic-attachments]*Dynamic attachments*
|This drop-down list provides all xref:orders:order-documents.adoc#100[location-based documents] that you set up in the *Setup » Client » [Select client] » Locations » [Select location] » Documents* menu. Select (material:check_box[role=skyBlue]) up to 3 dynamic attachments from the drop-down list.

//| *From*
//|This is the sender of the email just as it is saved in the email settings of your plentymarkets system.

|[#intable-template-settings-reply-to]*Reply to*
|Who is the recipient of this email? Enter the email address(es). +
*_Note:_* When you enter several email addresses, separate them with a comma each.

|[#intable-template-settings-cc]*CC*
|To whom do you want to send a copy of this email? Enter the email address(es). +
*_Note:_* When you enter several email addresses, separate them with a comma each.

|[#intable-template-settings-bcc]*BCC*
|To whom do you want to send a blind copy of this email? Enter the email address(es). +
*_Note:_* When you enter several email addresses, separate them with a comma each.

2+^|[#intable-language-specific-settings]*Language-specific settings* (material:translate[]) +
In this area, carry out the language-specific settings. Thus, you can carry out different settings for each template. For example, you can link product data sheets or user manuals in the corresponding language with the template. +
*_Note:_* If the template is of the type *Header* or *Footer*, only the field <<#intable-template-settings-custom-styles, custom styles>> is available in this area. A subject and static attachments are not available for headers and footers.

| material:translate[]
|In the top right in the *Settings* area, click on material:translate[] to open the language-specific settings of the templates. +
You can see an individual area for each language you created. Click on material:expand_more[] to collapse individual language areas. Clicking on material:chevron_right[] opens the language area again.

|[#intable-template-settings-subject]*Subject*
|You can see the template’s subject here. If needed, you can adjust the subject. +
*_Note:_* This field is _not_ available for templates of the type *Header* and *Footer*.

|[#intable-template-settings-static-attachments]*Static attachments*
|This drop-down list provides all attachments that you uploaded before in the *CMS » Documents* menu. These are, for example, installation guides or product data sheets in the corresponding language. Select (material:check_box[role=skyBlue]) up to 3 static attachments from the drop-down list. +
*_Note:_* This drop-down list is _not_ available for templates of the type *Header* and *Footer*.

|[#intable-template-settings-custom-styles]*Custom styles*
|You can adjust the CSS styling of your template, your header and your footer here. <<#examples-custom-styles, The collapsible box below this table>> contains some common examples for adjusting your template. +
*_Tip:_* Save the settings and open the *Preview* (material:preview[]) to check your entries and to make further adjustments, if needed.

|[#intable-template-settings-back-to-template-configuration]*Back to template configuration*
|Click on material:arrow_back[] at the top right to go back to the template configuration.

|====

[#examples-custom-styles]
[.collapseBox]
.Custom styles: common examples
--
The following table lists some common examples about how to adjust the styling of your template.

*_Note:_* If you want to save multiple CSS stylings for the template, enter all values one after the other, separated by a semicolon.

[cols="2,4"]
|===
|CSS-Styling |Explanation

|Template width
|Enter `max-width:` in the *Custom styles* field followed by the desired width in pixel, e.g. `max-width:1200px`.

|Background colour
|Enter `background-color:` in the *Custom styles* field followed by the desired link:https://htmlcolorcodes.com/[HTML colour code^], e.g. `background-color:&#35;A9F5D0;`.

|Font colour
|Enter `color:` in the *Custom styles* field followed by the desired link:https://htmlcolorcodes.com/[HTML colour code^], e.g. `color:&#35;A0A1B;`.

|Font size
|Enter `font-size:` in the *Custom styles* field followed by the desired font size in pixel, e.g. `font-size:20px;`.

|Font weight
|Enter `font-weight:` in the *Custom styles* field followed by the desired font weight, e.g. `font-weight:700;`.

|Text alignment
|Enter `text-align:center;` in the *Custom styles* field if the text should be placed in the middle. Enter `text-align:right;` if the text should be aligned on the right.

|Background image:
|Enter `background-image: url(_link_to_image_);` in the *Custom styles* field and replace `_link_to_image_` with the corresponding image link to show a background image in your template.

|Text frame
|Enter e.g. `border: 1px solid blue;` in the *Custom styles* field to insert a blue frame with 1px around the text.

|Inner margin
|Enter `padding:10px;` in the *Custom styles* field if the margin should be 10px on all sides. Enter `padding: 10px 20px;` if the margin should be 10px on the top and bottom and 20px on the left and right sides.

|===

--

[[image-emailbuilder-add-languages]]
.Adding languages to a template
image::crm:emailbuilder-add-new-language.png[width=640, height=360]

Now structure the content of your email by inserting variables via the widgets. How to proceed is described in the following chapter <<#insert-widget, Inserting a widget into a template>>.

[#insert-widget]
=== Inserting a widget into a template

In the editor, you can find a selection of widgets whose contents are already pre-configured for you. The following widgets are available:

* <<#intable-widget-two-column-layout, Two-column layout>>
* <<#intable-widget-three-column-layout, Three-column layout>>
* <<#intable-widget-text, Text>>
* <<#intable-widget-code, Code>>
* <<#intable-widget-contact-address, Contact address>>
* <<#intable-widget-order-address, Order address>>
* <<#intable-widget-order-items, Order items>> 
* <<#intable-widget-item-list, Item list>>
* <<#intable-widget-image, Image>>

For example, you will find in the *Order items* widget a pre-defined list with the most important variables around the ordered item such as item name, the number of ordered items, the prices, the shipping costs and the total invoice amount. However, you can adjust the content at any time according to your needs and add further column names and individual items.

//// 

 

<<#image-emailbuilder-widget-order-items>> shows the editing mode of the predefined *Order items* widget.

[[image-emailbuilder-widget-order-items]]
.Editing mode of the pre-defined widget *Order items*
image::crm:emailbuilder-editing-mode-order-items.png[width=640, height=360]

////

Proceed as described below to insert one or multiple widgets into your template.

[.instruction]
Inserting a widget into a template:

. Go to *CRM » EmailBuilder (Test phase)*.
. Expand the folder (material:chevron_right[]) that contains the template you want to edit.
. Click on the template.
. Click on *Edit* (material:edit[]). +
→ The editor opens and the widgets are loaded.
. Click on the widget on the left side and drag-and-drop it to the shaded area.
. Depending on the widget you are using, click on material:edit[] or material:settings[] and carry out the settings. Note the explanations about the individual widgets and their editing options in <<#table-available-widgets-emailbuilder>>.
. *Save* (material:save[]) the settings.

[[table-available-widgets-emailbuilder]]
.Available widgets in the EmailBuilder
[cols="1,3"]
|====
|Widget |Explanation

|[#intable-widget-two-column-layout]*Two-column layout*
a|Allows to display text in a two-column layout. Click on material:settings[] to open the settings. You can also determine the relation how the fields are displayed. The following values are available:

* 50% / 50% (standard)
* 30% / 70%
* 70% / 30%

You can insert further widgets in this widget by dragging them to one of the two columns. Insert, for example, an <<#intable-widget-image, image widget>>.

Click on *Close settings* (material:close[]) to close the settings. Click on *Delete widget* (material:delete[]) to remove the widget.

|[#intable-widget-three-column-layout]*Three-column layout*
a|Allows to display text in a three-column layout. 

You can insert further widgets in this widget by dragging them to one of the three columns. Insert, for example, an <<#intable-widget-image, image widget>>.

Click on material:settings[] to open the settings. Here, you can remove the widget by clicking on *Delete widget* (material:delete[]). Further settings cannot be carried out in this area. Click on *Close settings* (material:close[]) to close the settings.

|[#intable-widget-text]*Text*
|In this widget, you can enter text and use variables. You can also format the text you entered. To do so, double-click on the word that you want to format.

Click on material:edit[] to open the list with the variables on the left side of the screen. Use the search function to find the variables or find the appropriate variables by expanding the individual areas (material:chevron_right[]). Click on the variable that you want to insert. Enter additional text in the widget, if needed.

Click on material:settings[] to open the settings. Here, you can remove the widget by clicking on *Delete widget* (material:delete[]). Further settings cannot be carried out in this area. Click on *Close settings* (material:close[]) to close the settings.

|[#intable-widget-code]*Code*
|In this widget, you can insert text in HTML format and use <<#twig-code-widget, twig expressions>>. To do so, some basic HTML skills are needed.

Click on icon:code[] to open the view.

Click on material:settings[] to open the settings. Here, you can remove the widget by clicking on *Delete widget* (material:delete[]). Further settings cannot be carried out in this area. Click on *Close settings* (material:close[]) to close the settings.

|[#intable-widget-contact-address]*Contact address*
|This widget contains sample data of the contact address. The layout of the address depends on the settings that you saved in the *Setup » CRM » Address layout* menu. This means: The layout in the EmailBuilder is displayed in the same way as the address layout that you defined as the xref:crm:preparatory-settings.adoc#[standard address layout] in the *Setup » CRM » Address layout* menu.

Click on material:settings[] to open the settings. Select the address type *Invoice address* or *Delivery address* from the drop-down list.

Click on *Close settings* (material:close[]) to close the settings. Click on *Delete widget* (material:delete[]) to remove the widget.

*_Note:_* You can find all addresses that are saved for the contact in the contact data record in the xref:crm:edit-contact.adoc#addresses[Addresses] area. The contact’s primary delivery and invoice address are saved in the contact data record in the xref:crm:edit-contact.adoc#primary-address[Primary address] area.

|[#intable-widget-order-address]*Order address*
|This widget contains sample data of the order address. The layout of the address depends on the settings that you saved in the *Setup » CRM » Address layout* menu. This means: The layout in the EmailBuilder is displayed in the same way as the address layout that you defined as the xref:crm:preparatory-settings.adoc#[standard address layout] in the *Setup » CRM » Address layout* menu.

Click on material:settings[] to open the settings. Select the address type *Invoice address* or *Delivery address* from the drop-down list.

Click on *Close settings* (material:close[]) to close the settings. Click on *Delete widget* (material:delete[]) to remove the widget.

*_Note:_* You can find all addresses that are saved for the contact in the contact data record in the xref:crm:edit-contact.adoc#addresses[Addresses] area. The contact’s primary delivery and invoice address are saved in the contact data record in the xref:crm:edit-contact.adoc#primary-address[Primary address] area.

|[#intable-widget-order-items]*Order items*
|This widget contains an already pre-defined layout for the order items with sample data. The sample data will then be replaced with the correct values in the email. 

 
 

Click on material:settings[] to open the settings. Use the drop-down lists to decide which content is to be shown in the columns and as individual positions. Click on material:unfold_more[]to change the order. Click on material:add[] (*Add new entry*) in the settings to add further columns. Click on *Remove entry* (material:delete[]) to delete the columns from the overview.

|[#intable-widget-item-list]*Item list*
|In this widget, you can enter text and use variables. Note that you can only use variables from the sub-category <<#variables-order-order-items, Order / Order items (only for item list widget)>> in this widget.

Click on material:edit[] to open the list with the variables on the left side of the screen. Use the search function to find the variables or find the appropriate variables by expanding the individual areas (material:chevron_right[]). Click on the variable that you want to insert. Enter additional text in the widget, if needed.

Click on material:settings[] to open the settings. Here, you can remove the widget by clicking on *Delete widget* (material:delete[]). Further settings cannot be carried out in this area. Click on *Close settings* (material:close[]) to close the settings.

|[#intable-widget-image]*Image*
| Use this widget to upload images such as your company logo to show it in your email templates.

Click on material:settings[] to open the settings. You can upload the image, enter the width and height of the image in px or %, enter an alternative text, adjust the styling in CSS format and save the image link. +
*_Important:_* Always use `https` for the image link. +
*_Tip:_* If you want to place the image to a certain position, you can adjust the CSS styling in the field *Custom styling*, e.g. `margin-left: auto; margin-right: 0; display: block;` or `float:right;display:block;`. Further information can be found link:https://www.w3schools.com/css/css3_images.asp[here^] and link:https://www.caniemail.com/[here^].

Click on *Close settings* (material:close[]) to close the settings. Click on *Delete widget* (material:delete[]) to remove the widget.

|====

[#show-widget-preview]
[discrete]
==== Showing the preview of the widget

Check the widget by opening the preview.

. Go to *CRM » EmailBuilder (Test phase)*.
. Expand the folder (material:chevron_right[]) that contains the template for which you want to show the preview.
. Click on the template.
. Click on *Preview* (material:preview[]).
. Select *Preview HTML* or *Preview plain text*. +
→ The preview opens in a separate window.
. Check the widget.
. *Close* the window.

If you are not satisfied with the result, <<#edit-widget, edit>> the widget.

[#edit-widget]
=== Editing the widget

You can edit the content of the widgets at any time. To do so, proceed as described below.

[.instruction]
Editing a widget:

. Go to *CRM » EmailBuilder (Test phase)*.
. Expand the folder (material:chevron_right[]) that contains the template you want to edit.
. Click on the template.
. Click on *Edit* (material:edit[]). +
→ The editor opens and the widgets are loaded.
. Click on material:settings[]. +
→ The widget settings open – if they are available.
. Click on material:edit[] - if available. +
→ The variables open on the left side.
. Use the search function to find the variables or find the appropriate variables by expanding the individual areas (material:chevron_right[]).
. Click on the variable that you want to show in the widget. +
→ The variable is taken to the widget.
. *Save* the settings.

[#use-default-templates]
=== Using default templates

Before you <<#create-folder, created a new folder>>, you might have recognised the folders *Standardvorlagen* and *Default templates*? These folders contain pre-defined templates in German and English language. You can use the templates as they are or adjust the contents just as you like.

Besides the content of the email template, the subject is already filled in in a default template. This means that you only have to select the owner, the client and header and footer and fill the fields *Reply to* and, if needed, also *CC* and *BCC*. Moreover, you can adjust the prefilled subject and add dynamic and static attachments.

[TIP]
.Switching between multiple templates
====
If you later edit multiple templates in the editor at the same time, you can use the navigation on the left to switch between the individual templates. The template that you have currently open is highlighted in blue font. 

Also it is shown in which template section you are currently in.

* If the material:edit[] *Edit (_language_)* area is highlighted in blue font in the navigation on the left side below the template, you are in the template’s editor.

* If material:translate[] *Language settings* is highlighted in blue font, you are currently in the template’s language-specific settings.

If you are in the editor or in the language settings of a template and want to switch to another template without having saved the changes beforehand, a message will be displayed.
====

[[image-emailbuilder-example-default-template]]
.Example: Default template *Order: Shipping confirmation*
image::crm:emailbuilder-example-default-template.png[width=640, height=360]

[#create-default-template]
==== Creating a default template

12 default templates in total are available in German and English each in your plentymarkets system. When creating a new template, you can select one of these default templates and adjust it, if needed. Refer to the <<#default-templates-name-and-subject, Available default templates>> chapter to see which default templates are available and what their subject is.

[.instruction]
Creating a default template:

. Go to *CRM » EmailBuilder (Test phase)*.
. In the line of the folder in which you want to create a default template, click on material:more_vert[]. +
→ A new window opens.
. Click on material:add[] *Add*.
. Click on material:description[] *Template*. +
→ The *Create new template* window opens.
. Enter a name for the template.
. Select header and footer for the default template from the drop-down list.
. Select a default template from the drop-down list *Build from default template*.
. *Save* (material:save[]) the settings. +
→ The template is created and opened. 

As soon as the default template is created, you can see the prefilled content in the editor. Adjust the content by clicking on material:edit[]. +
The toolbar shows the prefilled subject. Adjust the subject by clicking on material:translate[] in the top right corner. In this area, you can also select up to 3 static attachments that are attached to the email template. +
In the *Settings* area, select an owner, the client and the header and footer, if not done already. In this area, you can also select up to 3 dynamic attachments and fill the fields *Reply to*, *CC* and *BCC*.

*_Note:_* If you do not want to create the default template within a folder, click on the start page of the *CRM » EmailBuilder (Test phase)* menu in the bottom left on material:add[] *Add* material:play_arrow[] and select material:description[] *Template* afterwards. The template will then be created on the first level and does not belong to a folder.

[#default-templates-name-and-subject]
==== Available default templates

Would you like to know which default templates are already available in the EmailBuilder and how their subjects are? Simply expand the following area by clicking on material:expand_more[].

[.collapseBox]
.Default templates in the EmailBuilder and their subjects
--

*English default templates in the EmailBuilder and their subjects*

[[table-default-templates-english]]
.English default templates in the EmailBuilder and their subjects
[cols="2,2"]
|====
|English template |Subject

|Order: Changes
|Change to your order with ID &#123;&#8288;&#123;order.id&#125;&#8288;&#125;

|Order: Partial payment received
|Partial payment for order ID &#123;&#8288;&#123;order.id&#125;&#8288;&#125; received

|Order: Shipping confirmation
|Shipping confirmation for your order with ID &#123;&#8288;&#123;order.id&#125;&#8288;&#125;

|Order: Payment complete
|Payment for order ID &#123;&#8288;&#123;order.id&#125;&#8288;&#125; fully received

|Order: Payment reminder
|Payment status for the order placed on &#123;&#8288;&#123;order.formattedDates.createdOn \| date('m-d-Y H:i:s')&#125;&#8288;&#125; with order ID &#123;&#8288;&#123;order.id&#125;&#8288;&#125;

|Order: Invoice
|Invoice for order ID: &#123;&#8288;&#123;order.id&#125;&#8288;&#125; from &#123;&#8288;&#123;order.formattedDates.createdOn \| date('m-d-Y H:i:s')&#125;&#8288;&#125;

|eBay: dispute / cancellation, no payment
|Your order with the ID &#123;&#8288;&#123;order.id&#125;&#8288;&#125; was cancelled

|eBay: Order confirmation
|eBay auction won: Order ID &#123;&#8288;&#123;order.id&#125;&#8288;&#125;

|eBay: Order confirmation with bank details without checkout
|Order confirmation for your eBay order with the ID &#123;&#8288;&#123;order.id&#125;&#8288;&#125;

|Shop: New password
|Your requested login details for our online shop

|Shop: Newsletter registration
|Confirmation of newsletter registration

|Shop: Order confirmation
|Order confirmation for your order with ID &#123;&#8288;&#123;order.id&#125;&#8288;&#125;

|====

*German default templates in the EmailBuilder and their subjects*

[[table-default-templates-german]]
.German default templates in the EmailBuilder and their subjects
[cols="2,2"]
|====
|German template |Subject

|Auftrag: Änderung
|Auftragsänderung Ihrer Bestellung mit der ID &#123;&#8288;&#123;order.id&#125;&#8288;&#125;

|Auftrag: Teilzahlung erhalten
|Teilzahlung für Auftrags-ID &#123;&#8288;&#123;order.id&#125;&#8288;&#125; erhalten

|Auftrag: Versandbestätigung
|Versandbestätigung für Ihre Bestellung mit der ID &#123;&#8288;&#123;order.id&#125;&#8288;&#125;

|Auftrag: Zahlungseingang vollständig
|Zahlung für Auftrag &#123;&#8288;&#123;order.id&#125;&#8288;&#125; vollständig erhalten

|Auftrag: Zahlungserinnerung
|Zahlungsstatus für den Auftrag mit der ID &#123;&#8288;&#123;order.id&#125;&#8288;&#125; vom &#123;&#8288;&#123;order.formattedDates.createdOn \| date('m-d-Y H:i:s')&#125;&#8288;&#125;

|Auftrag: Rechnung PDF-Anhang
|Rechnung zu Order-ID &#123;&#8288;&#123;order.id&#125;&#8288;&#125; vom &#123;&#8288;&#123;order.formattedDates.createdOn \| date('m-d-Y H:i:s')&#125;&#8288;&#125;

|eBay: Disput / Storno, keine Zahlung
|Ihre Bestellung mit der ID &#123;&#8288;&#123;order.id&#125;&#8288;&#125; wurde storniert

|eBay: Eingangsbestätigung Bestellung
|eBay-Auktion gewonnen: Auftrags-ID &#123;&#8288;&#123;order.id&#125;&#8288;&#125;

|eBay: Eingangsbestätigung mit Bankdaten ohne Checkout
|Eingangsbestätigung zum eBay-Auftrag mit der ID &#123;&#8288;&#123;order.id&#125;&#8288;&#125;

|Shop: Neues Passwort
|Ihre angeforderten Zugangsdaten zu unserem Webshop

|Shop: Newsletter-Anmeldung
|Bestätigung zur Newsletter-Anmeldung

|Shop: Eingangsbestätigung Bestellung
|Auftragsbestätigung für Auftrags-ID &#123;&#8288;&#123;order.id&#125;&#8288;&#125;

|====



--

[#template-show-preview]
=== Showing the preview of the template

Check the email template by opening the preview.

[TIP]
.Email templates are sent in multipart format
====
The email templates in the EmailBuilder use the multipart format. This means that the emails are sent in an HTML and in a text version at the same time. +
This ensures that your emails can be read by all recipients, even if their email client restricts or completely disables the display of HTML in emails. On the other hand, the HTML versions of your emails that you designed are displayed for the recipients whose email client allows the display of HTML. The advantage for you is that you only have to maintain one email template.
====

[.instruction]
Showing the preview:

. Go to *CRM » EmailBuilder (Test phase)*.
. Expand the folder (material:chevron_right[]) that contains the template for which you want to show the preview.
. Click on the template.
. Click on *Preview* (material:preview[]).
. Select *Preview HTML* or *Preview plain text*. +
→ The preview opens in a separate window.
. Check the template.
. *Close* the window.

If you are not satisfied with the result, <<#edit-template, edit>> the content of your template.

[#search-templates]
=== Searching for a template

In order to search for specific templates, enter a search term in the search fields. You can enter multiple search terms into the search fields at once. This makes your search run quicker and more accurate.

[.instruction]
Searching for a template:

. Go to *CRM » EmailBuilder (Test phase)*.
* *_Alternative 1:_* Enter a value in the search field and select the appropriate filter from the suggestion list. *_Example:_* If you enter a number, the possible filters with this ID will be suggested such as for example the template ID.
* *_Alternative 2:_* Click on material:tune[] to narrow down the search results with filters.
. Note the explanations about the filters in <<#table-search-template>>. +
*_Tip:_* You can enter multiple search terms into the search fields at one time. This makes your search run quicker and be more accurate.
. Click on material:search[] *Search*. +
→ The templates that correspond to the search criteria entered are shown in the overview.

[[table-search-template]]
.Available filters for the template search
[cols="1,3"]
|====
|Filter |Explanation

| *ID*
|Enter an ID to search for the template with this exact ID.

| *Language*
|Select (material:check_box[role=skyBlue]) a language from the drop-down list to only search for templates that were created in this language. You can select one or multiple languages.

| *Name*
|Enter a name to search for templates with this name.

| *Client*
|Select (material:check_box[role=skyBlue]) a client from the drop-down list to only search for templates that were created for this client.

| *Type*
|Select (material:check_box[role=skyBlue]) a type from the drop-down list to only search for templates with this template type. You can select one or multiple types. +
Available options: *Template*, *Header*, *Footer*.

| *Owner*
|Select (material:check_box[role=skyBlue]) an owner from the drop-down list to only search for templates that were created for this owner.

| material:replay[]
|Resets the selected filter criteria.

| material:search[] *SEARCH*
|Starts the search. → The templates that correspond to the search criteria are displayed. +
*_Tip:_* Don’t choose any filters if you want to see all of the templates in the overview.

|====

[#move-template]
=== Moving a template

You can move your templates to another folder at any time. To do so, proceed as described below.

[.instruction]
Moving a template:

. Go to *CRM » EmailBuilder (Test phase)*.
. Expand the folder (material:chevron_right[]) that contains the template you want to move.
. In the line of the template, click on material:more_vert[]. +
→ A new window opens.
. Click on material:move_down[] *Move*. +
→ The *Move* window opens.
. Select the target folder.
. Click on *Move*. +
→ The template is moved to the selected folder.

[#edit-template]
=== Editing a template

The following instruction describes how to edit templates in general. The procedure is thus identical for editing all templates, i.e. also editing the templates that you created for the header and the footer.

[TIP]
.Switching between multiple templates
====
If you later edit multiple templates in the editor at the same time, you can use the navigation on the left to switch between the individual templates. The template that you have currently open is highlighted in blue font. 

Also it is shown in which template section you are currently in.

* If the material:edit[] *Edit (_language_)* area is highlighted in blue font in the navigation on the left side below the template, you are in the template’s editor.

* If material:translate[] *Language settings* is highlighted in blue font, you are currently in the template’s language-specific settings.

If you are in the editor or in the language settings of a template and want to switch to another template without having saved the changes beforehand, a message will be displayed.
====

[.instruction]
Editing a template:

. Go to *CRM » EmailBuilder (Test phase)*.
. Expand the folder (material:chevron_right[]) that contains the template you want to edit.
. Click on the template.
. Carry out the changes. Note <<#table-emailbuilder-create-template>>.
. *Save* (material:save[]) the settings.

[#add-language]
=== Adding a language to the template

You can add the following languages to your template, your header and your footer:

* German
* English
* Bulgarian
* French
* Italian
* Spanish
* Turkish
* Dutch
* Polish
* Portuguese
* Norwegian
* Romanian
* Danish
* Swedish
* Czech
* Russian
* Slovakian
* Chinese
* Vietnamese

Let’s assume, you have created a shipping confirmation in English and added widgets and variables. Now, you want to create this shipping confirmation also in French for your French-speaking customers. The quickest way is to copy the template and adjust the translation afterwards. How to proceed in this case is described in the <<#copy-template, Copying a template>> chapter.

[IMPORTANT]
.Important: Add header and footer in the corresponding language
====
If you created a template in multiple languages, remember to create also the header and footer in these languages and to link them with the template.
====

[#copy-template]
=== Copying a template

You want to copy an existing template to save time when creating a new template with similar content? To do so, proceed as follows.

[TIP]
_Before copying the template_, carry out the settings in the <<#intable-general-template-settings, Settings>> area. The advantage of this sequence is that you also copy the settings themselves and not only the template content. Thus, you don’t need to carry out the settings for the other templates again.

[.instruction]
Copying a template:

. Go to *CRM » EmailBuilder (Test phase)*.
. Expand the folder (material:chevron_right[]) that contains the template you want to copy.
. In the line of the template that you want to copy, click on material:more_vert[]. +
→ A new window opens.
. Click on material:content_copy[] *Copy*. +
→ A new window opens.
. Select the language from the list that you want to copy the template to. +
→ The *Enter subject* window opens. +
*_Note:_* By default, the language abbreviation of the selected language is preselected.
. Enter the subject in the selected language.
. Click on *Save*. +
→ The template is copied and opens in the language that you have just selected.
. Now <<#edit-template, edit>> the copied template according to your needs and adjust the translation.

[#delete-template]
=== Deleting a template

Proceed as described below to delete templates. Only the assembled template will be deleted but _not_ the components contained in it such as the header and footer.

[.instruction]
Deleting a template:

. Go to *CRM » EmailBuilder (Test phase)*.
. Expand the folder (material:chevron_right[]) that contains the template you want to delete.
. In the line of the template that you want to delete, click on material:more_vert[]. +
→ A new window opens.
. Click on material:delete[] *Delete*. +
→ A window opens and you need to confirm your decision.
. Click on *Delete*. +
→ The template is deleted.

[#remove-language]
=== Removing a language from the template

Proceed as described below to remove a certain language from the template.

[.instruction]
Removing a language from the template:

. Go to *CRM » EmailBuilder (Test phase)*.
. Expand the folder (material:chevron_right[]) that contains the template from which you want to remove a language.
. Click on the template.
. In the template’s tabs at the top, select the language that you want to remove.
. Click on material:more_vert[]. +
→ A new window opens.
. Click on material:delete[] *Delete*. +
→ A window opens and you need to confirm your decision.
. Click on *Delete*. +
→ The language is removed from the template.

[#automate-email-despatch]
== Automating the email despatch

You have multiple options in plentymarkets to automate the email despatch to your customers.

[#automatic-email-despatch]
=== Setting up automatic emails

The *Setup» Client » [Select client] » Email » Automatic* menu contains various events that you can link with a template. Select from the drop-down list the template that you <<#create-template, created>> before in the *CRM » EmailBuilder (Test phase)* menu. This ensures that the email template is sent to your contacts once the event occurs.

[IMPORTANT]
.Removing the link before deleting the email template
====
Deleting an email template that is linked with an event in the *Automatic email* area may lead to undesired effects. Therefore, first go to *Setup » Client » [Select client] » Email » Automatic* and remove the link by selecting the option *Do not send* from the drop-down list in the line of the event. Afterwards, delete the template in the *CRM » EmailBuilder (Test phase)* menu.
====

[.instruction]
Setting up the automatic email despatch:

. Go to *Setup » Client » [Select client] » Email » Automatic*.
. Select a template from the drop-down list in the line of the event. Note <<#table-events-automatic-email-despatch>>.
. *Save* (icon:save[role="green"]) the settings.

[[table-events-automatic-email-despatch]]
.Explanations about some events for the automatic despatch
[cols="1,3"]
|====
|Setting |Explanation

| *New order from online store*
|The contacts receive an email including the order confirmation after the purchase has been completed in the online shop. +
*_Note:_* If your customers should be able to access the order processing in your online shop with this email to see the order status, you have to insert the variable `URL to checkout` in the template that you select for this automatic event. +
*_Note:_* You can find the variable in the <<#variables-global, Global>> category.

| *Send customer email to change password*
|The contacts receive an email with a link to the new password. The link has to be actively confirmed. The variable `URL to change password` has to be contained in the template. +
*_Note:_* You can find the variable in the <<#variables-global, Global>> category.

| *Newsletter opt-in*
|The contacts receive an email when they have registered for the newsletter. The template should include the confirmation link that the contacts have to click in order to complete the newsletter registration process: `URL to confirm newsletter subscription`. +
*_Note:_* You can find the variable in the <<#variables-newsletter, Newsletter>> category.

| *Newsletter opt-in confirmation*
|The contacts receive a confirmation email once they have activated the confirmation link that was sent with the email template for the *Newsletter opt-in* event.

| *Email when item becomes available*
|The contacts receive an email containing the information that a certain item is available again. Requirement: The contacts have entered their email address in the online shop directly next to the item that could not be delivered at that time.

|====

[#set-up-event-procedures]
=== Setting up event procedures

Besides the possibility to <<#automatic-email-despatch, link events and templates>>, you can also set up event procedures in the *Setup » Orders » Events* menu. Define an event, activate one or more filters and decide which procedures your plentymarkets system should carry out automatically when the event occurs.

For example, you can use filters to trigger a procedure once a contact has placed a certain number of orders or has been assigned another customer class. The procedure could send an email that includes a coupon. For further information, refer to the xref:automation:event-procedures.adoc#[Event procedures] page.

[#email-despatch-to-multiple-email-addresses]
=== Email despatch to multiple email addresses

Go to *Setup » Orders » Events* to set up an xref:automation:event-procedures.adoc#[event procedure] that will send an email to your customers and employees when the event that you determined occurs in your plentyShop.

Add in the event procedure the procedure *Customer > Send email* and select the appropriate template as well as the recipients to send the email to multiple recipients at the same time once the selected event occurs.

The following recipients are available:

* Customer
* Warehouse
* Invoice address from order
* Invoice address from order
* Contact email business
* Contact email private
* Contact email PayPal
* available owners

You can either send the same template to all recipients or select a separate template each.

[#variables-emailbuilder]
== Available variables and twig expressions

In some of the widgets you can insert variables to create the templates you need. In the emails that are sent to your customer, the variables will then be replaced with the correct content.

Besides the variables, the tables in the <<#available-variables, Available variables>> chapter contain also the corresponding twig expressions. You need twig expressions for the subject line of your email and for the <<#intable-widget-code, code widget>> because it is not possible to use variables in there.

[#twig-introduction]
=== Twig expressions for the code widget and the subject line

Besides the variables, you can find also the twig expressions in the <<#available-variables, Available variables>> chapter. Twig expressions can be used in the code widget and in a template’s subject line.

[#twig-subject]
==== Twig expression in the subject line

If you want to use a twig expression in the template’s subject line, this expression has to be surrounded by double curly brackets.

*_Example:_* If you want to display the shipping service provider in your template’s subject line, open the expandable area *Order / Shipping*, search for the variable *Shipping service provider* and insert the corresponding twig expression in the subject line of your template as follows: `&#123;&#8288;&#123;order.formattedShipping.providerName&#125;&#8288;&#125;`.

You can find code examples for the subject line in the <<#code-examples-subject, Code examples for the subject line>> chapter.


[#twig-code-widget]
==== Twig expression in the code widget

If you use link:https://twig.symfony.com/doc/3.x/tags/if.html[if queries^] or link:https://twig.symfony.com/doc/2.x/tags/for.html[for loops^] in your code widget, for example, there is no need to insert double curly brackets in the if query itself, but in the body text. For further information about twig, refer to the link:https://twig.symfony.com/doc/3.x/[Twig documentation^].

In the <<#code-examples-code-widget, Code examples for the code widget>> chapter, you can find some if queries and for loops that you can simply copy to your code widget.

[#available-variables]
=== Available variables

The available variables for the EmailBuilder are grouped into the following categories and sub-categories: Click on an entry in the list to be directly forwarded to the area where the variables and the corresponding twig expressions for the respective category or sub-category are listed.

* <<#variables-order, Order>>

** <<#variables-order, General order variables>>
** <<#variables-order-delivery-address, Delivery address>>
** <<#variables-order-invoice-address, Invoice address>>
** <<#variables-order-order-items, Order items (only for item list widget)>>
** <<#variables-order-shipping, Shipping>>
** <<#variables-order-subscription, Subscription>>

* <<#variables-contact-general, Contact>>

** <<#variables-contact-general, General contact variables>>
** <<#variables-contact-delivery-address, Delivery address>>
** <<#variables-contact-invoice-address, Invoice address>>
** <<#variables-contact-options, Options>>

* <<#variables-global, Global>>

* <<#variables-newsletter, Newsletter>>

* <<#variables-ticket, Ticket>>

[#variables-order]
==== Variables: Order general

[[table-variables-order-order]]
.Variables in the *Order* category
[cols="2,4,3"]
|====
|Name of the variable |Explanation |Twig expression

| `Access order in the online shop`
|Opens the URL to the order in your online shop.
| `order.access_key`

| `Barcode ID`
|
| `order.formattedGeneral.barcodeOrderID`

| `Plenty ID`
|The ID is automatically assigned by the system and cannot be changed. You can find the ID in the *Setup » Client » [Select client] » Settings* menu.
| `order.plentyId`

| `Coupon value`
|Value of the xref:orders:coupons.adoc#[coupon].
| `order.formattedGeneral.couponValue`

| `Currency code`
|Currency code, e.g. *EUR* or *USD*.
| `order.formattedSubtotals.currencyCode`

| `Currency symbol`
|Currency symbol, e.g. *€* or *$*.
| `order.formattedSubtotals.currencySymbol`

| `Customer sign`
|
| `order.formattedProperties.customerSign`

| `Customer wish`
|During the checkout via the online shop, the contact can enter a wish regarding the items they ordered. This wish is saved as order note in the order data.
| `order.formattedComments.customerSpecialWishes`

| `DHL Retoure Online QR code`
|Sends your customers a QR code for xref:fulfilment:plugin-dhl-retoure-online.adoc#[DHL Retoure Online]. If your customers want to send back an item, they have to show the QR code on their smartphone to one of the employees in the post office and they will print the return label and attach it to the parcel.   Thus, your customers do no longer need a printer at home and you do no longer have to send the return label attached as PDF. +
The QR code is shown as an URL in the email of your customers. After clicking on the URL, the QR code appears in a separate window.
| `order.formattedGeneral.DHLRetoureOnlineQRCodeURL`

| `Date and time of incoming order`
|Date and time of the incoming order as saved in the order.
| `order.formattedDates.createdOn ? (order.formattedDates.createdOn \| date('m-d-Y H:i:s')) : ''`

| `Date of the incoming order`
|Date of the incoming order as saved in the order.
| `order.formattedDates.createdOn ? (order.formattedDates.createdOn \| date('m-d-Y')) : ''`

| `Date of incoming payment`
|Date and time of the incoming payment as saved in the order.
| `order.formattedDates.paidOn`

| `Delivery address VAT number`
|VAT number from the delivery address as saved in the order.
| `order.formattedAddresses.deliveryAddress.formattedOptions.VATNumber`

| `External order ID`
|
| `order.formattedProperties.externalOrderId`

| `Flag`
|Flag that was selected in the order.
| `order.formattedProperties.flag`

| `Invoice address VAT number`
|VAT number from the invoice address as saved in the order.
| `order.formattedAddresses.invoiceAddress.formattedOptions.VATNumber`

| `Invoice date`
|
| `order.formattedDocuments.invoiceDate`

| `Invoice number ID`
|
| `order.formattedDocuments.invoice`

| `Number of packages`
|Shows the number of packages contained in the order.
| `order.package`

| `Total invoice amount, net`
|
| `order.formattedGeneral.invoiceTotalNet`

| `Net total order`
|
| `order.formattedGeneral.totalNet`

| `Open amount`
|
| `order.formattedGeneral.openAmount`

| `Order ID`
|
| `order.id`

| `ID of the order type`
|ID of the order type, e.g. `1` for order, `4` for credit note and `6` for repair order. +
*_Note:_* To see the entire list of the order types and their IDs, refer to this xref:data:internal-IDs.adoc#80[page of the manual].
| `order.typeId`

| `Order type name`
|Name of the order type, e.g. `Order`, `Credit note` and `Repair order`. +
*_Note:_* To see the entire list of the order types and their IDs, refer to this xref:data:internal-IDs.adoc#80[page of the manual].
| `order.formattedGeneral.orderTypeName`

| `Order warehouse ID`
|
| `order.formattedProperties.warehouse`

| `Main order ID`
|ID of the highest preceding order. Usually, this is a normal order. +
*_Example:_* In case of a credit note C1 coming from a return R1 from the order O1, the `Parent Order ID` returns the ID of R1 and `$OriginOrderID` returns the ID of O1.
| `order.formattedOriginOrder.originOrderId`

| `Overpaid amount`
|
| `order.formattedGeneral.overpaidAmount`

| `Amount paid`
|
| `order.formattedGeneral.paidAmount`

| `Parent order ID`
|ID of the direct preceding order +
*_Example:_* In case of a credit note, this could be the ID of the return or of the order from which the credit note was generated.
| `order.parent_order_id`

| `Payment method`
|Name of the xref:payment:managing-payment-methods.adoc#65[payment method] as it is saved in the *Setup » Orders » Payment » Payment methods* menu.
| `order.formattedGeneral.methodOfPaymentName`

| `Payment method ID`
|The ID is automatically assigned by the system. The IDs of the xref:payment:managing-payment-methods.adoc#65[payment methods] are listed in the *Setup » Orders » Payment » Payment methods* menu.
| `order.formattedProperties.paymentMethod`

| `Referrer`
|Name of the xref:orders:order-referrer.adoc#[order referrer] as it is saved in the *Setup » Orders » Referrers* menu.
| `order.formattedReferrer.name`

| `Referrer ID`
|ID of the xref:orders:order-referrer.adoc#[order referrer] as it is saved in the *Setup » Orders » Referrers* menu.
| `order.formattedReferrer.id`

| `Reorder ID`
|ID of the xref:stock-management:working-with-reorders.adoc#[reorder].
| `order.formattedReorder.id`

| `Seller account`
|
| `order.formattedProperties.sellerAccount`

| `Status ID`
|ID of the xref:orders:managing-orders.adoc#1200[order status] as it is saved in the *Setup » Orders » Status* menu.
| `order.statusId`

| `Order status`
|Name of the order status as it is saved in the *Setup » Orders » Statuses* menu.
| `order.statusName`

| `Total invoice amount`
|*_Example:_* 1.234,00
| `order.formattedGeneral.invoiceTotal \| number_format(2, ',', '.')`

| `Total invoice amount, separated by a full stop`
|*_Example:_* 1234.00
| `order.formattedGeneral.invoiceTotal \| number_format(2, '.', '')`

| `VAT total`
|
| `order.formattedGeneral.totalVat`

| `Value of the items`
|
| `order.formattedGeneral.valueOfItems`

| `eBay payment ID`
|
| `order.formattedProperties.ebayUniquePaymentID`

|====



[#variables-order-delivery-address]
==== Variables: Order / Delivery address

[[table-variables-order-delivery-address]]
.Variables in the *Order / Delivery address* sub-category
[cols="1,3"]
|====
|Name of the variable |Twig expression

| `Delivery address Additional address information`
| `order.formattedAddresses.deliveryAddress.address3`

| `Delivery address Company name`
| `order.formattedAddresses.deliveryAddress.name1`

| `Delivery address Contact person`
| `order.formattedAddresses.deliveryAddress.formattedOptions.contactPerson`

| `Delivery address Country`
| `order.formattedAddresses.deliveryAddress.country.name`

| `Delivery address Country ID`
| `order.formattedAddresses.deliveryAddress.country.id`

| `Delivery address Country ISO code 2`
| `order.formattedAddresses.deliveryAddress.country.isoCode2`

| `Delivery address Country ISO code 3`
| `order.formattedAddresses.deliveryAddress.country.isoCode3`

| `Delivery address First name`
| `order.formattedAddresses.deliveryAddress.name2`

| `Delivery address First name and last name`
| `order.formattedAddresses.deliveryAddress.name2 ~ ' ' ~ order.formattedAddresses.deliveryAddress.name3`

| `Delivery address Last name`
| `order.formattedAddresses.deliveryAddress.name3`

| `Delivery address Telephone`
| `order.formattedAddresses.deliveryAddress.formattedOptions.telephone`

| `Delivery address Postcode`
| `order.formattedAddresses.deliveryAddress.postalCode`

| `Delivery address Postcode and town`
| `order.formattedAddresses.deliveryAddress.postalCode ~ ' ' ~ order.formattedAddresses.deliveryAddress.town`

| `Delivery address State`
| `order.formattedAddresses.deliveryAddress.state.name`

| `Delivery address Street`
| `order.formattedAddresses.deliveryAddress.address1`

| `Delivery address House number`
| `order.formattedAddresses.deliveryAddress.address2`

| `Delivery address Town`
| `order.formattedAddresses.deliveryAddress.town`

|====

[#variables-order-invoice-address]
==== Variables: Order / Invoice address

[[table-variables-order-invoice-address]]
.Variables in the *Order / Invoice address* sub-category
[cols="1,3"]
|====
|Name of the variable |Twig expression

| `Invoice address Additional address information`
| `order.formattedAddresses.invoiceAddress.address3`

| `Invoice address Company name`
| `order.formattedAddresses.invoiceAddress.name1`

| `Invoice address Contact person`
| `order.formattedAddresses.invoiceAddress.formattedOptions.contactPerson`

| `Invoice address Country`
| `order.formattedAddresses.invoiceAddress.country.name`

| `Invoice address Country ID`
| `order.formattedAddresses.invoiceAddress.country.id`

| `Invoice address Country ISO code 2`
| `order.formattedAddresses.invoiceAddress.country.isoCode2`

| `Invoice address Country ISO code 3`
| `order.formattedAddresses.invoiceAddress.country.isoCode3`

| `Invoice address First name`
| `order.formattedAddresses.invoiceAddress.name2`

| `Invoice address First name and last name`
| `order.formattedAddresses.invoiceAddress.name2 ~ ' ' ~ order.formattedAddresses.invoiceAddress.name3`

| `Invoice address Last name`
| `order.formattedAddresses.invoiceAddress.name3`

| `Invoice address Telephone`
| `order.formattedAddresses.invoiceAddress.formattedOptions.telephone`

| `Invoice address Postcode`
| `order.formattedAddresses.invoiceAddress.postalCode`

| `Invoice address Postcode and town`
| `order.formattedAddresses.invoiceAddress.postalCode ~ ' ' ~ order.formattedAddresses.invoiceAddress.town`

| `Invoice address State`
| `order.formattedAddresses.invoiceAddress.state.name`

| `Invoice address Street`
| `order.formattedAddresses.invoiceAddress.address1`

| `Invoice address House number`
| `order.formattedAddresses.invoiceAddress.address2`

| `Invoice address Town`
| `order.formattedAddresses.invoiceAddress.town`

|====


[#variables-order-order-items]
==== Variables: Order / Order items (only for item list widget)

[[table-variables-order-order-items]]
.Variables in the *Order / Order items (only for item list widget)* sub-category
[cols="2,4,3"]
|====
|Name of the variable |Explanation |Twig expression

| `ASIN`
|Amazon Standard Ident Number (ASIN) of the item
| `orderItem.formattedBarcodes.ASIN`

| `Attribute values`
| xref:item:attributes.adoc#[Attribute values] as they are saved in the *Setup » Item » Attributes* menu.
| `orderItem.attributeValues`

| `Availability ID`
|ID of the xref:item:availability.adoc#[item availability] of the net stock as it is saved in the *Setup » Item » Availability* menu. A consecutive ID is automatically assigned by the system and cannot be changed.
| `orderItem.formattedAvailability.availabilityId`

| `Availability ID physical stock`
|ID of the item availability of the physical stock
| `orderItem.formattedAvailability.availabilityPhysicalStockId`

| `Availability text`
|Name of the item availability of the net stock
| `orderItem.formattedAvailability.availabilityName`

| `Availability text physical stock`
|Name of the item availability of the physical stock
| `orderItem.formattedAvailability.availabilityPhysicalStockName`

| `Codes of a coupon`
|
| `orderItem.formattedVoucherCodes`

| `Content`
|
| `orderItem.formattedUnit.unitContent`

| `Discount per order item`
|
| `orderItem.formattedAmounts.discount`

| `External item ID`
|
| `orderItem.variation.item.external_article_id`

| `External token ID`
|
| `orderItem.formattedExternalTokenId`

| `External variation ID`
|
| `orderItem.variation.externalId`

| `Free text field 1`
| xref:item:fields.adoc#[Free text fields] for the items as they are saved in the *Setup » Item » Free text fields* menu. +
*_Example:_* `Free text field 3` displays the text that is saved in *Field 3*.
| `orderItem.variation.item.free1`

| `Free text field 2`
|
| `orderItem.variation.item.free2`

| `Free text field 3`
|
| `orderItem.variation.item.free3`

| `Free text field 4`
|
| `orderItem.variation.item.free4`

| `Free text field 5`
|
| `orderItem.variation.item.free5`

| `Free text field 6`
|
| `orderItem.variation.item.free6`

| `Free text field 7`
|
| `orderItem.variation.item.free7`

| `Free text field 8`
|
| `orderItem.variation.item.free8`

| `Free text field 9`
|
| `orderItem.variation.item.free9`

| `Free text field 10`
|
| `orderItem.variation.item.free10`

| `Free text field 11`
|
| `orderItem.variation.item.free11`

| `Free text field 12`
|
| `orderItem.variation.item.free12`

| `Free text field 13`
|
| `orderItem.variation.item.free13`

| `Free text field 14`
|
| `orderItem.variation.item.free14`

| `Free text field 15`
|
| `orderItem.variation.item.free15`

| `Free text field 16`
|
| `orderItem.variation.item.free16`

| `Free text field 17`
|
| `orderItem.variation.item.free17`

| `Free text field 18`
|
| `orderItem.variation.item.free18`

| `Free text field 19`
|
| `orderItem.variation.item.free19`

| `Free text field 20`
|
| `orderItem.variation.item.free20`

| `GTIN`
|Global Trade Item Number (GTIN) of the item
| `orderItem.formattedBarcodes.GTIN`

| `ISBN`
|ISBN code of the item
| `orderItem.formattedBarcodes.ISBN`

| `Item ID`
|ID of the xref:item:item-search.adoc#580[item]. A consecutive ID is automatically assigned by the system and cannot be changed.
| `orderItem.variation.itemId`

| `URL to the item`
|Returns the URL to the item in the online shop.
| `orderItem.formattedLink`

| `Item name`
|Name of the xref:item:item-search.adoc#580[item].
| `orderItem.orderItemName`

| `Item type`
|Returns the item types as saved in the item’s *Global* tab. Possible values: Default, item set, multipack.
| `orderItem.formattedStockType`

| `Item number`
|
| `orderItem.variation.item.ArtNo`

| `Order property value`
|
| `orderItem.formattedOrderProperty.value`

| `Gross price`
|
| `orderItem.formattedAmounts.grossPrice`

| `Item properties`
|
| `orderItem.formattedProperties.all`

| `Item quantity`
|
| `orderItem.quantity`

| `Manufacturer name`
|Name of the xref:item:manufacturers.adoc#[manufacturer].
| `orderItem.variation.item.producer`

| `Model`
|Model name of the item
| `orderItem.variation.model`

| `Net price`
|
| `orderItem.formattedAmounts.netPrice`

| `Referrer`
|
| `orderItem.formattedReferrer.referrerName`

| `Release date`
|
| `orderItem.variation.releasedAt`

| `Return comment`
|
| `orderItem.formattedReturn.comment`

| `Status ID of the returned item`
|
| `orderItem.formattedReturn.statusId`

| `Name of the returned item`
|
| `orderItem.formattedReturn.statusLabel`

| `ID of return reason`
|ID of the xref:orders:managing-orders.adoc#410[return reason] as it is saved in the *Setup » Orders » Order types » Return* menu.
| `orderItem.formattedReturn.reasonId`

| `Return reason`
|Name of the xref:orders:managing-orders.adoc#410[return reason] as it is saved in the *Setup » Orders » Order types » Return*
| `orderItem.formattedReturn.reasonLabel`

| `Value of the return in percent`
|
| `orderItem.formattedReturn.percentage`

| `Customs tariff number`
|
| `orderItem.variation.customsTariffNumber`

| `Total price (unit price x quantity)`
|
| `orderItem.formattedAmounts.totalPrice`

| `Unit price`
|
| `orderItem.formattedUnit.unitPrice`

| `URL to variation image`
|Returns the URL to the variation image.
| `orderItem.formattedImageUrl`

| `Unit`
|
| `orderItem.formattedUnit.unitName`

| `VAT rate`
|
| `orderItem.vatRate`

| `Variation ID`
|
| `orderItem.variation.id`

| `Variation name`
|
| `orderItem.variation.name`

| `Variation number`
|
| `orderItem.variation.number`

| `Warehouse ID`
|ID of the xref:stock-management:setting-up-a-warehouse.adoc#[warehouse] as it is saved in the *Setup » Stock » Warehouse* menu.
| `orderItem.warehouseId`

|====


[#variables-order-shipping]
==== Variables: Order / Shipping

[[table-variables-order-shipping]]
.Variables in the *Order / Shipping* sub-category
[cols="2,4,3"]
|====
|Name of the variable |Explanation |Twig expression

| `Delivery note ID`
|ID of the xref:orders:generating-delivery-notes.adoc#[delivery note].
| `order.formattedDocuments.deliveryNote`

| `Estimated delivery date`
|
| `order.formattedDates.estimatedDeliveryDate`

| `Estimated shipping date`
|
| `order.formattedDates.estimatedShippingDate`

| `Package number list`
|Package numbers/tracking numbers are saved in the orders *Settings* tab at the shipping service provider after the order was successfully registered.
| `order.formattedShipping.packageNumberList`

| `Package weight`
|Package weight and unit as saved in the *Orders » Shipping centre* menu in the *Shipping packages* area.
| `order.formattedShipping.packageWeight`

| `Possible delivery date`
|
| `order.formattedDates.earliestDeliveryDate`

| `Reorder Delivery date`
|
| `order.formattedReorder.estimatedDeliveryDate`

| `Date when the return was received`
|
| `order.formattedDates.returnDate`

| `Return package number`
|
| `order.returns_code`

| `Total shipping costs`
|
| `order.formattedGeneral.shippingCosts`

| `Shipping profile`
| Name of the xref:fulfilment:preparing-the-shipment.adoc#1000[shipping profile] as it is saved in the *Setup » Orders » Shipping » Settings* menu in the *Shipping profiles* tab.
| `order.formattedShipping.profileName`

| `Shipping profile ID`
|Is automatically saved by the system. You can find the ID of the xref:fulfilment:preparing-the-shipment.adoc#1000[shipping profile] in the *Setup » Orders » Shipping » Settings* menu in the *Shipping profiles* tab.
| `order.formattedShipping.profileId`

| `Shipping service provider`
|Name of the xref:fulfilment:preparing-the-shipment.adoc#800[shipping service provider] as it is saved in the *Setup » Orders » Shipping » Settings* menu in the *Shipping service provider* tab.
| `order.formattedShipping.providerName`

| `Shipping service provider ID`
|Is automatically saved by the system. You can find the ID of the xref:fulfilment:preparing-the-shipment.adoc#800[shipping service provider] in the *Setup » Orders » Shipping » Settings* menu in the *Shipping service provider* tab.
| `order.formattedShipping.providerId`

| `Tracking URL`
|The tracking URL is used to track shipments. The xref:fulfilment:preparing-the-shipment.adoc#840[tracking URL] of the shipping service provider is saved in the *Setup » Orders » Shipping » Settings* menu in the *Shipping service provider* tab. +
*_Note:_* Have a look at our xref:crm:practical-example-send-tracking-url.adoc#[practical example about this topic.] Learn which settings you need to carry out to the send the tracking URL to your customers.
| `order.formattedShipping.trackingURL`

|====

[#variables-order-subscription]
==== Variables: Order / Subscription

[[table-variables-order-subscription]]
.Variables in the *Order / Subscription* sub-category
[cols="2,4,3"]
|====
|Name of the variable |Explanation |Twig expression

| `Subscription ID`
|ID of the subscription. The ID is automatically assigned by the system and _cannot_ be changed.
| `order.formattedSubscription.id`

| `Start date of the subscription`
|Date when the subscription starts.
| `order.formattedSubscription.startDate`

| `End date of the subscription`
|Date when the subscription ends.
| `order.formattedSubscription.endDate`

| `Subscription: Number of executions`
|Number of orders that were created based on a subscription. +
*_Example:_* If the subscription was started in May 2021 with an interval of 3 months, 4 orders were created until May 2022. In this case, this variable would return the value `4` in the email template.
| `order.formattedSubscription.numberOfExecutions`

| `Subscription interval`
|Interval of the subscription as determined in the *Setup » Orders » Subscription* menu. The interval determines the regularly recurrent times at which the items are sent to the customers. +
Possible values: *1 month*, *3 months*, *6 months*, *12 months*.
| `order.formattedSubscription.interval`

| `Subscription total amount`
|
| `order.formattedSubscription.totalAmount \| number_format(2, '.', ',')`

|====

[#variables-contact-general]
==== Variables: Contact general

[[table-variables-order-contact]]
.Variables in the *Contact* category
[cols="2,4,3"]
|====
|Name of the variable |Explanation |Twig expression

| `Account holder (contact)`
| xref:crm:edit-contact.adoc#bank-details[Account owner] as saved in the contact data record.
| `contact.formattedBanks.accountOwner`

| `BIC of the contact`
| xref:crm:edit-contact.adoc#bank-details[BIC] as saved in the contact data record.
| `contact.formattedBanks.bic`

| `Bank name of the contact`
| xref:crm:edit-contact.adoc#bank-details[Bank name] as saved in the contact data record.
| `contact.formattedBanks.bankName`

| `Class`
| Customer class that is assigned to the contact. xref:crm:preparatory-settings.adoc#create-customer-class[Classes] are created in the *Setup » CRM » Customer classes* menu.
| `contact.formattedClass.name`

| `Company name`
|Name of the xref:crm:edit-contact.adoc#company[company].
| `contact.formattedAccounts.companyName`

| `Contact ID`
|ID of the xref:crm:edit-contact.adoc#[contact]. A consecutive ID is automatically assigned by the system and cannot be changed.
| `contact.id`

| `First name`
|
| `contact.firstName`

| `First and last name of the system user`
|First name and last name of the system user who is saved as xref:crm:edit-contact.adoc#contact-details[owner] in the contact data record.
| `contact.formattedUser.realName`

| `Full name`
|
| `contact.fullName`

| `Gender`
|If gender is male, *male* is shown. +
If gender is female, *female* is shown. +
If gender is diverse, an empty option is shown.
| `contact.gender is same as ('diverse') ? '' : contact.gender`

| `IBAN of the contact`
|IBAN as saved in the contact data record.
| `contact.formattedBanks.iban`

| `Language`
|Language as saved in the contact data record. If you created an email template in the selected language, the email templates are sent to the contact in this language.
| `contact.lang`

| `Last name`
|
| `contact.lastName`

| `Newsletter: Confirmation by contact`
|Date when the contact has confirmed the newsletter receipt. +
Date format in the email: `mm-dd-yyyy`. +
In the contact data record, the timestamp in the format `00:00:00` is also saved in addition to the date in the format `dd-mm-yyyy`.
| `contact.newsletterAllowanceAt`

| `Number`
|Additional number for the contact.
| `contact.number`

| `Number of orders`
|
| `contact.formattedOrdersCount`

| `Salutation business`
|
| `contact.formattedOptions.salutationWork`

| `Form of address`
|
| `contact.formattedSalutation.label`

| `Salutation private`
|
| `contact.formattedOptions.salutationPrivate`

| `Signature of the system user`
|First name and last name of the system user who is saved as xref:crm:edit-contact.adoc#contact-details[owner] in the contact data record.
| `contact.formattedUser.signatureNoHtml`

| `Signature of the system user in HTML format`
|First name and last name of the system user who is saved as xref:crm:edit-contact.adoc#contact-details[owner] in the contact data record, in HTML format.
| `contact.formattedUser.signatureHtml`

| `Title`
|
| `contact.title`

|====

[#variables-contact-delivery-address]
==== Variables: Contact / Delivery address

[TIP]
*_Note:_* If it’s a reorder, some of the following variables for the address options in the delivery address are not shown in the email to your customers. This is because the addresses that are saved for a supplier are not taken into account because you can save suppliers without an address in your system.

[[table-variables-order-contact-delivery-address]]
.Variables in the *Contact / Delivery address* sub-category
[cols="1,3"]
|====
|Name of the variable |Twig expression

| `Delivery address Additional address information`
| `contact.formattedAddresses.deliveryAddress.address3 ~ ' ' ~ contact.formattedAddresses.deliveryAddress.address4`

| `Delivery address Company name`
| `contact.formattedAddresses.deliveryAddress.name1`

| `Delivery address Country`
| `contact.formattedAddresses.deliveryAddress.country.name`

| `Delivery address Country ID`
| `contact.formattedAddresses.deliveryAddress.country.id`

| `Delivery address Country ISO code 2`
| `contact.formattedAddresses.deliveryAddress.country.isoCode2`

| `Delivery address Country ISO code 3`
| `contact.formattedAddresses.deliveryAddress.country.isoCode3`

| `Delivery address First name`
| `contact.formattedAddresses.deliveryAddress.name2`

| `Delivery address First name and last name`
| `contact.formattedAddresses.deliveryAddress.name2 ~ ' ' ~ contact.formattedAddresses.deliveryAddress.name3`

| `Delivery address Last name`
| `contact.formattedAddresses.deliveryAddress.name3`

| `Delivery address Telephone`
| `contact.formattedAddresses.deliveryAddress.formattedOptions.telephone`

| `Delivery address Postcode`
| `contact.formattedAddresses.deliveryAddress.postalCode`

| `Delivery address Postcode and town`
| `contact.formattedAddresses.deliveryAddress.postalCode ~ ' ' ~ contact.formattedAddresses.deliveryAddress.town`

| `Delivery address State`
| `contact.formattedAddresses.deliveryAddress.state.name`

| `Delivery address Street`
| `contact.formattedAddresses.deliveryAddress.address1 ~ ' ' ~ contact.formattedAddresses.deliveryAddress.address2`

| `Delivery address House number`
| `contact.formattedAddresses.deliveryAddress.address2`

| `Delivery address Town`
| `contact.formattedAddresses.deliveryAddress.town`

|====

[#variables-contact-invoice-address]
==== Variables: Contact / Invoice address

[TIP]
*_Note:_* If it’s a reorder, some of the following variables for the address options in the delivery address are not shown in the email to your customers. This is because the addresses that are saved for a supplier are not taken into account because you can save suppliers without an address in your system.

[[table-variables-order-contact-invoice-address]]
.Variables in the *Contact / Invoice address* sub-category
[cols="1,3"]
|====
|Name of the variable |Twig expression

| `Invoice address Additional address information`
| `contact.formattedAddresses.invoiceAddress.address3 ~ ' ' ~ contact.formattedAddresses.invoiceAddress.address4`

| `Invoice address Company name`
| `contact.formattedAddresses.invoiceAddress.name1`

| `Invoice address Country`
| `contact.formattedAddresses.invoiceAddress.country.name`

| `Invoice address Country ID`
| `contact.formattedAddresses.invoiceAddress.country.id`

| `Invoice address Country ISO code 2`
| `contact.formattedAddresses.invoiceAddress.country.isoCode2`

| `Invoice address Country ISO code 3`
| `contact.formattedAddresses.invoiceAddress.country.isoCode3`

| `Invoice address First name`
| `contact.formattedAddresses.invoiceAddress.name2`

| `Invoice address First name and last name`
| `contact.formattedAddresses.invoiceAddress.name2 ~ ' ' ~ contact.formattedAddresses.invoiceAddress.name3`

| `Invoice address Last name`
| `contact.formattedAddresses.invoiceAddress.name3`

| `Invoice address Telephone`
| `contact.formattedAddresses.invoiceAddress.formattedOptions.telephone`

| `Invoice address Postcode`
| `contact.formattedAddresses.invoiceAddress.postalCode`

| `Invoice address Postcode and town`
| `contact.formattedAddresses.invoiceAddress.postalCode ~ ' ' ~ contact.formattedAddresses.invoiceAddress.town`

| `Invoice address State`
| `contact.formattedAddresses.invoiceAddress.state.name`

| `Invoice address Street`
| `contact.formattedAddresses.invoiceAddress.address1 ~ ' ' ~ contact.formattedAddresses.invoiceAddress.address2`

| `Invoice address House number`
| `contact.formattedAddresses.invoiceAddress.address2`

| `Invoice address Town`
| `contact.formattedAddresses.invoiceAddress.town`

|====

[#variables-contact-options]
==== Variables: Contact / Options

[[table-variables-order-contact-options]]
.Variables in the *Contact / Options* sub-category
[cols="1,3"]
|====
|Name of the variable |Twig expression

| `Additional contact person`
| `contact.formattedOptions.additionalContactPerson`

| `Email business`
| `contact.formattedOptions.emailWork`

| `PayPal email address`
| `contact.formattedOptions.emailPayPal`

| `Email private`
| `contact.formattedOptions.emailPrivate`

| `Fax business`
| `contact.formattedOptions.telefaxWork`

| `Fax private`
| `contact.formattedOptions.telefaxPrivate`

| `Mobile business`
| `contact.formattedOptions.telephoneMobileWork`

| `Mobile private`
| `contact.formattedOptions.telephoneMobilePrivate`

| `Phone business`
| `contact.formattedOptions.telephoneWork`

| `Phone private`
| `contact.formattedOptions.telephonePrivate`

| `eBay name`
| `contact.formattedOptions.marketplaceEbay`

|====

[#variables-global]
==== Variables: Global

[[table-variables-global]]
.Variables in the *Global* category
[cols="2,4,3"]
|====
|Name of the variable |Explanation |Twig expression

| `Account holder (master data)`
|Account holder from the xref:welcome:quick-start-initial-settings.adoc#100[master data] of your plentymarkets system. Is saved in the *Basics* assistant in the *Bank details* step. You can find the assistant in the *Setup » Assistants » Basic settings* menu. +
As an alternative, you can find the account holder in the *Setup » Settings » Bank* menu.
| `globals.bank.owner`

| `BIC (master data)`
|BIC from the xref:welcome:quick-start-initial-settings.adoc#100[master data] of your plentymarkets system. Is saved in the *Basics* assistant in the *Bank details* step. You can find the assistant in the *Setup » Assistants » Basic settings* menu. +
As an alternative, you can find the saved BIC in the *Setup » Settings » Bank* menu.
| `globals.bank.bic`

| `Bank name (master data)`
|Bank name from the xref:welcome:quick-start-initial-settings.adoc#100[master data] of your plentymarkets system. Is saved in the *Basics* assistant in the *Bank details* step. You can find the assistant in the *Setup » Assistants » Basic settings* menu. +
As an alternative, you can find the saved bank name in the *Setup » Settings » Bank* menu.
| `globals.bank.name`

| `Cancellation rights in HTML format`
|Go to *Setup » Client » [Select client] » Online store » Legal » [Expand language]*. Click on the *Cancellation rights* tab and save the text in the *HTML* tab.
| `globals.legalInformation.cancellationRights.html`

| `Cancellation rights in plain text`
|Go to *Setup » Client » [Select client] » Online store » Legal » [Expand language]*. Click on the *Cancellation rights* tab and save the text in the *Text* tab.
| `globals.legalInformation.cancellationRights.plain`


| `Coupon code (1)`
| xref:orders:coupons.adoc#[Coupon codes] are generated in the campaign in the *Orders » Coupons* menu. A coupon code can always be assigned to only one campaign to send this coupon code from the campaign in an email template.
| `globals.coupons.couponCode1`

| `Coupon code (2)`
|
| `globals.coupons.couponCode2`

| `Coupon code (3)`
|
| `globals.coupons.couponCode3`

| `Coupon code (4)`
|
| `globals.coupons.couponCode4`

| `Coupon code (5)`
|
| `globals.coupons.couponCode5`

| `Coupon code (6)`
|
| `globals.coupons.couponCode6`

| `Coupon code (7)`
|
| `globals.coupons.couponCode7`

| `Coupon code (8)`
|
| `globals.coupons.couponCode8`

| `Coupon code (9)`
|
| `globals.coupons.couponCode9`

| `Coupon code (10)`
|
| `globals.coupons.couponCode10`

| `EORI number`
|Unique identification number that is required for customs-related procedures.
| `globals.account.EORINumber`

| `IBAN (master data)`
|IBAN from the xref:welcome:quick-start-initial-settings.adoc#100[master data] of your plentymarkets system. Is saved in the *Basics* assistant in the *Bank details* step. You can find the assistant in the *Setup » Assistants » Basic settings* menu. +
As an alternative, you can find the saved IBAN in the *Setup » Settings » Bank* menu.
| `globals.bank.iban`

| `Legal disclosure in HTML format`
|Go to *Setup » Client » [Select client] » Online store » Legal » [Expand language]*. Click on the *Legal disclosure* tab and save the text in the *HTML* tab.
| `globals.legalInformation.withdrawalForm.html`

| `Legal disclosure in plain text`
|Go to *Setup » Client » [Select client] » Online store » Legal » [Expand language]*. Click on the *Legal disclosure* tab and save the text in the *Text* tab.
| `globals.legalInformation.legalDisclosure.plain`

| `Privacy policy in HTML format`
|Go to *Setup » Client » [Select client] » Online store » Legal » [Expand language]*. Click on the *Privacy policy* tab and save the text in the *HTML* tab.
| `globals.legalInformation.privacyPolicy.html`

| `Privacy policy in plain text`
|Go to *Setup » Client » [Select client] » Online store » Legal » [Expand language]*. Click on the *Privacy policy* tab and save the text in the *Text* tab.
| `globals.legalInformation.privacyPolicy.plain`

| `Signature in HTML format`
|The signature is saved in the *Email accounts* assistant in the *Signature* step. You can find the assistant in the Setup » Assistants » Basic setup menu.
| `globals.account.signatureHTML`

| `Signature in plain text`
|The signature is saved in the *Email accounts* assistant in the *Signature* step. You can find the assistant in the Setup » Assistants » Basic setup menu.
| `globals.account.signatureText`

| `Today’s date`
|Returns today’s date in the format `dd-mm-yyyy`.
| `"now"\|date("d-m-Y")`

| `URL to basket`
|Returns the URL to the basket in the online shop.
| `globals.links.linkBasket`

| `URL to change password`
|Returns the URL for the *Change password* area in the online shop. The contact can enter a new password.
| `globals.links.linkChangePassword`

| `URL to checkout`
|Returns the URL to the checkout area of the order in the online shop.
| `globals.links.linkCheckout`

| `URL to confirm email address`
|Returns the URL to confirm the email address change of the contact.
| `globals.account.newCustomerEmail`

| `URL to new password`
|Returns the URL to a form that allows to create a new password. The contact enters their email address in this form.
| `globals.links.linkNewPassword`

| `URL to online shop`
|Returns the URL of the online shop.
| `globals.links.linkWebstore`

| `URL to Terms and Conditions`
|Returns the URL for the terms and conditions.
| `globals.links.linkTermsConditions`

| `Cancellation form in HTML format`
|Go to *Setup » Client » [Select client] » Online store » Legal » [Expand language]*. Click on the *Cancellation form* tab and save the text in the *HTML* tab.
| `globals.legalInformation.withdrawalForm.html`

| `Cancellation form in plain text`
|Go to *Setup » Client » [Select client] » Online store » Legal » [Expand language]*. Click on the *Cancellation form* and save the text in the *Text* tab.
| `globals.legalInformation.withdrawalForm.plain`

|====

[#variables-newsletter]
==== Variables: Newsletter

[[table-variables-newsletter]]
.Variables in the *Newsletter* category
[cols="2,5,2"]
|====
|Name of the variable |Explanation |Twig expression

| `Newsletter first name`
|First name of the person who wants to subscribe for the xref:crm:sending-newsletters.adoc#[newsletter].
| `newsletter.firstName`

| `Newsletter last name`
|Last name of the person who wants to subscribe for the xref:crm:sending-newsletters.adoc#[newsletter].
| `newsletter.lastName`

| `URL for confirming the newsletter receipt`
|Returns the URL to confirm the xref:crm:sending-newsletters.adoc#[newsletter subscription].
| `newsletter.formattedConfirmUrl`

|====

[#variables-ticket]
==== Variables: Ticket

[[table-variables-ticket]]
.Variables in the *Ticket* category
[cols="2,5,2"]
|====
|Name of the variable |Explanation |Twig expression

| `Ticket backend URL`
|Links to the ticket in the xref:crm:using-the-ticket-system.adoc#[CRM » Ticket system] menu.
| `ticket.formattedUrl.backendUrl`

| `Ticket messages history`
|Returns the text that was last saved in the ticket. This is either the text of a comment or a message.
| `ticket.formattedMessage.history`

| `ID of the ticket`
|Displays the ticket ID that the email was sent from.
| `ticket.id`

| `Ticket last comment`
|Returns the text of the last xref:crm:using-the-ticket-system.adoc#2500[comment]. +
*_Note:_* Comments serve for internal communication and are _not_ visible to your customers.
| `ticket.formattedMessage.lastComment`

| `Ticket last message`
|Returns the text of the last xref:crm:using-the-ticket-system.adoc#2400[message].
| `ticket.formattedMessage.lastMessage`

| `Ticket priority`
|Returns the priority of the ticket as and ID. The values of the stars are shown in ascending order with numbers from `0` (grey star, lowest priority) to `5` (2 yellow stars, highest priority).
| `ticket.priorityId`

| `Ticket status`
|Returns the status of the ticket.
| `ticket.formattedStatus`

| `Ticket tags`
|Returns the tags of the ticket.
| `ticket.formattedTags`

| `Ticket title`
|Returns the title of the ticket.
| `ticket.title`

| `Ticket URL`
|Links to the ticket in the *My account* area. The customer can read the message in the My account area, write an answer and send it. +
Note also the xref:crm:using-the-ticket-system.adoc#5500[Creating tickets in the My account area] chapter on the xref:crm:using-the-ticket-system.adoc#[Ticket system] page.
| `ticket.formattedUrl.url`

|====

[#code-examples-code-widget]
== Code examples for the code widget

Use if queries or for loops in your email templates to display specific information on a case-by-case basis. In the following sub-chapters, you find some if queries and for loops that you can simply copy to your <<#intable-widget-code, code widget>>.

[#code-example-shipping-profile]
=== Code example: Shipping profile

In the <<#intable-widget-code, code widget>>, insert a code that causes a note regarding the freight-forwarding company and contacting to only be displayed in the email to your customers if the shipping service provider in the shipping profile is a freight-forwarding company. In our example the shipping profile with the freight-forwarding company has the ID `6`.

Click on link:https://raw.githubusercontent.com/plentymarkets/plenty-manual-docs/main/docs/en-gb/modules/crm/emailbuilder-code-example-shipping-profile.txt[this link^] to see the code example.

[#code-example-bank-details]
=== Code example: Bank details

In the <<#intable-widget-code, code widget>>, insert a code that causes bank details to only be displayed in the email to your customers if *Cash in advance* (ID `0`) was selected as payment method in your plentyShop.

Click on link:https://raw.githubusercontent.com/plentymarkets/plenty-manual-docs/main/docs/en-gb/modules/crm/emailbuilder-code-example-bank-details.txt[this link^] to see the code example.

[#code-example-order-items]
=== Code example: Order items

In the <<#intable-widget-code, code widget>>, insert a code that causes the order items with the variation IDs, the item names, the item quantity and the price to be shown in a table.

Click on link:https://raw.githubusercontent.com/plentymarkets/plenty-manual-docs/main/docs/en-gb/modules/crm/emailbuilder-code-example-order-items.txt[this link^] to see the code example.

[#code-example-item-list]
=== Code example: Items of the order shown as list

In the <<#intable-widget-code, code widget>>, insert a code that causes the item IDs and quantities of all items that are contained in the order to be shown in a list.

Click on link:https://raw.githubusercontent.com/plentymarkets/plenty-manual-docs/main/docs/en-gb/modules/crm/examples/emailbuilder-code-example-item-list.txt[this link^] to see the code example.

[#code-examples-subject]
== Code examples for the subject line

In the subject line of your template, insert a code that displays a certain word at the beginning of the subject line in case of certain order referrers. In our example, the word `[IMPORTANT]` is always displayed at the beginning of the subject line if the referrers are between `9` and `11`.

Click on link:https://raw.githubusercontent.com/plentymarkets/plenty-manual-docs/main/docs/en-gb/modules/crm/emailbuilder-code-example-subject.txt[this link^] to see the code example.
