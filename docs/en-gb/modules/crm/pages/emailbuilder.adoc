= EmailBuilder
:keywords: EmailBuilder, Email Builder, email templates, widgets, e-mail templates, document attachment email, attach documents email, construction kit emails, email variables, twig expressions, email despatch, code widget, widgets email templates
:description: Learn how to use the EmailBuilder in plentysystems and create email templates with a modular concept using widgets and variables.
:page-aliases: emailbuilder-testphase.adoc
:author: team-crm

All emails that are sent with plentysystems to your xref:crm:contacts.adoc#[contacts] are based on templates. You create and manage templates with the EmailBuilder in the *CRM » EmailBuilder* menu.

Watch this link:https://www.youtube.com/watch?v=LnQ2MpTZEQw[video^] to learn more about the EmailBuilder.

[TIP]
.Email templates are sent in multipart format
====
The email templates in the EmailBuilder use the multipart format. This means that the emails are sent in an HTML and in a text version at the same time. +
This ensures that your emails can be read by all recipients, even if their email client restricts or completely disables the display of HTML in emails. On the other hand, the HTML versions of your emails that you designed are displayed for the recipients whose email client allows the display of HTML. The advantage for you is that you only have to maintain one email template.
====

The EmailBuilder is a modular construction kit for quickly creating and editing your email templates via drag-and-drop. The EmailBuilder consists of 2 views: the configuration manager and the editor.

* With the configuration manager, you create folders and, if needed, sub-folders, templates as well as templates for your footer and your header.

* With the editor, you fill your templates, headers and footers with content. You can create a template for an invoice, for example, and use this template for all invoices that are sent to your customers in the future.

You can then use the header and footer templates in the email templates as desired. Header and footer are globally active; changes you make to the header and footer affect the rest of all existing templates and all other templates that you will create in the future.

The header, the footer and the settings in the template such as the name, the subject etc. form the framework of your email, so to say. The content of the template is formed with <<#insert-widget, widgets>> and <<#variables-emailbuilder, variables>>. In the emails that are sent to your customer, the variables will then be replaced with the correct content. For example: The variable `Delivery address First name and last name` will be replaced in the email with the first name and the last name of the contact from the delivery address.

In case of certain events, e.g. if a new order is placed in your plentyShop or when a contact subscribes to a newsletter, your system automatically <<#automate-email-despatch, creates emails from these templates>> and sends them to your contacts.

[#preparatory-settings]
== Carrying out the preparatory settings

The following sub-chapters describe which preparatory settings are needed so that you can work with the EmailBuilder.

[#assign-rights]
=== Assigning rights

:rights-purpose: work with the EmailBuilder
:right-one: pass:quotes[*CRM > EmailBuilder > Read*]
:right-two: pass:quotes[*CRM > EmailBuilder > Update*]
:right-two: pass:quotes[*CRM > EmailBuilder > Create*]
:right-four: pass:quotes[*CRM > EmailBuilder > Delete*]
:right-five: pass:quotes[in simple mode: *CRM > EmailBuilder > See*]

include::_includes:partial$rights.adoc[]

[#email-server-login-details]
=== Saving the email server’s login details

In the *Email accounts* assistant in the *Setup » Client » Global » Email accounts* menu, save the login details of a mailbox in the *Login details* step so that plentysystems emails such as order or shipping confirmations can be sent from this email address. +
Moreover, you can activate the live mode here to ensure that all emails are not only sent to the email address you entered but also to your customers.

[.collapseBox]
.Settings in the *Email accounts* assistant in the *Login details* step
--
[[table-email-server-login-details]]
.Saving email server login details in the *Email accounts* assistant
[cols="1,3"]
|====
|Setting |Explanation

2+| Enter the server details of your email provider.

| *Outgoing mail server/SMTP server*
|Enter the outgoing mail server as specified by the provider (usually smtp.domain.co.uk or mail.domain.co.uk). +
*_mailbox.org:_* For mailbox.org mailboxes, enter the outgoing mail server *smtp.mailbox.org* and select the encryption method *SSL*.

| *Port (standard port: 25)*
|Enter the value *25*. This value is correct for nearly all providers. Otherwise, ask your provider about the correct port. +
*_mailbox.org:_* For mailbox.org mailboxes, enter port *465* and select the encryption method *SSL*.

| *Encryption method*
| Select *SSL*, *TLS* or *No encryption*. +
*_mailbox.org:_* For mailbox.org mailboxes, enter port *465* and select the encryption method *SSL*.

2+| Enter the login details of your email account. 

| *Name of sender*
|Enter your own name or the name of your plentyShop. The name is displayed to the recipient. +
*_Note:_* Avoid using special characters in order to allow for correct display.

| *Email address*
|Enter the email address as it is listed in the email programme.

| *User name*
|Enter the user name that matches the email address. +
*_mailbox.org:_* The mailbox.org user name is the complete email address of the mailbox.org mailbox.

| *Password*
|Enter the password that matches the user name and email address.

2+|Would you like to test the email despatch now? +

|material:outgoing_mail[]
|Click on material:outgoing_mail[] to send a test email to the email address entered above.

2+|Would you like to activate the live mode? 

|material:check_box_outline_blank[]
|If you do not place a check mark for *Activate live mode* (material:check_box_outline_blank[]), the test mode is activated. +
All emails are only sent to the saved email address. This allows you to test the settings before switching to the live mode. +
*_Important:_* The test mode is only applied to this online shop. The settings for additional clients (shops) are carried out in the client’s menu.

|material:check_box[role=skyBlue]
|If you place a check mark for *Activate live mode* (material:check_box[role=skyBlue]), the live mode is activated.

|====
--

[TIP]
Also note the explanations about the encryption of email communication on the user manual page xref:business-decisions:managing-mailbox.adoc#200[Selecting the encryption for email communication].

[#email-signature]
=== Saving the email signature

Go to the *Email accounts* assistant in the *Setup » Client » Global » Email accounts* menu to save the signature in HTML format or plain text in the *Signature* step. The signature is then automatically added to your email templates when you inserted the corresponding variable in the template.

[IMPORTANT]
.Note the priority of the signature
====
The signature that was saved for a user in his or her user account in the *Setup » Account management » Accounts* menu takes priority over the signature that is saved in the *Email accounts* assistant in the *Signature* step. +
*_This means:_* If you insert, for example, the variable `Signature in HTML format` or `Signature in plain text` in the email template, the signature is taken from the user account. If no signature is saved in the user account, the signature that is saved in the *Email accounts* assistant in the *Signature* step is used.
====

[#e-mail-info-service]
=== Setting up the email information service

In the *Email accounts* assistant in the *Setup » Client » Global » Email accounts* menu, you can set in the *Info service* step that a blind copy of all emails is sent by your system to an email address of your choice. This can be particularly helpful in the early stages of your online shop, as it allows you to maintain an overview of all sent emails and recognise where processes can still be improved. You can also set here that you automatically receive an info email when a new order has been placed.

[.collapseBox]
.Settings in the *Email accounts* assistant in the *Info service* step
--
[[table-info-service]]
.Saving email server login details in the *Email accounts* assistant
[cols="1,3"]
|====
|Setting |Explanation

2+| Would you like to receive a blind copy of all emails sent by your system?

|*Receive emails as blind copy* (material:toggle_off[role=darkGrey])
|If you do not want to receive a blind copy, do _not_ activate the button (material:toggle_off[role=darkGrey]).

|*Receive emails as blind copy* (material:toggle_on[role=skyBlue])
|If you want to receive a blind copy, activate the button (material:toggle_on[role=skyBlue]). Enter in the field that appears below the email address(es). If you enter multiple email addresses, separate them with commas and do not use spaces.

|*Receive newsletter as blind copy*
|If you are using the xref:crm:sending-newsletters.adoc#[newsletter] integrated in plentysystems, you can set here whether you want to receive a blind copy when a newsletter is sent.

2+| Would you like to receive an email when a new order is placed?

|*Receive email in case of a new order* (material:toggle_off[role=darkGrey])
|If you do not want to receive a blind copy when a new order is placed, do _not_ activate the button (material:toggle_off[role=darkGrey]).

|*Receive email in case of a new order* (material:toggle_on[role=skyBlue])
|If you want to receive a blind copy when a new order is placed, activate the button (material:toggle_on[role=skyBlue]). Enter in the field that appears below the email address(es). If you enter multiple email addresses, separate them with commas and do not use spaces.

|====
--

[#email-automatic-despatch]
=== Setting up the automatic despatch

The *Automatic despatch* step of the *Email accounts* assistant contains various events that you can link with a template. You can find the assistant in the *Setup » Client » Global » Email accounts* menu. Select from the drop-down list the template that you <<#create-template, created>> before in the *CRM » EmailBuilder* menu. This ensures that the email template is sent to your contacts once the event occurs.

[IMPORTANT]
.Removing the link before deleting the email template
====
Deleting an email template that is linked with an event in the *Automatic despatch* step of the *Email accounts* assistant may lead to undesired effects. Therefore, first go to *Setup » Client » Global » Email accounts* and remove the link in the *Automatic despatch* step by selecting the option *Do not send* from the drop-down list in the line of the event. Afterwards, <<#delete-template, delete>> the template in the *CRM » EmailBuilder* menu.
====

[.collapseBox]
.Explanations about the available events for the automatic despatch in the *Automatic despatch* step of the *Email accounts* assistant 
--

[[table-events-automatic-email-despatch]]
.Explanations about the events for the automatic despatch
[cols="1,3"]
|====
|Setting |Explanation

| *Send customer email to change password*
|If you xref:crm:emailbuilder.adoc#create-template[created] the template and link the template with this event, an email with an URL to the new password will be sent to your customers once this event is triggered. This link has to be confirmed. +
The variable `URL to change password` has to be contained in the template. +
*_Note 1:_* You can find the variable in the <<#variables-global, Global>> category. +
*_Note 2:_* In systems that have been booked since February 2023, the default template *Shop: New password* is already saved for this event. If required, you can select another template here.

| *Confirmation of password change*
|If you xref:crm:emailbuilder.adoc#create-template[created] the template and link the template with this event, a confirmation email will be sent to your customers once they change their password. +
Inserting a variable here is not mandatory. It would be useful, however, to add the URL to your online shop (`URL to online shop`). +
*_Note:_* You can find the variable in the <<#variables-global, Global>> category.

| *Customer wants to change email address*
|If you xref:crm:emailbuilder.adoc#create-template[created] the template and link the template with this event, a confirmation email will be sent to your customers once they change their email address in your online shop and enter the new email address. +
Therefore, the template should contain the variable `URL to confirm email address`. +
*_Note:_* You can find the variable in the <<#variables-global, Global>> category.

| *Newsletter opt-in*
|If you xref:crm:emailbuilder.adoc#create-template[created] the template and link the template with this event, an email will be sent to your customers once they registered for the newsletter. The template should contain the variable `URL for confirming the newsletter receipt`; thus, the confirmation link that the contacts have to click in order to complete the newsletter registration process. +
*_Note:_* You can find the variable in the <<#variables-newsletter, Newsletter>> category. +
*_Note 2:_* In systems that have been booked since February 2023, the default template *Shop: Newsletter registration* is already saved for this event. If required, you can select another template here.

| *Newsletter opt-in confirmation*
|If you xref:crm:emailbuilder.adoc#create-template[created] the template and link the template with this event, a confirmation email will be sent to your customers once they activated the confirmation link that was sent with the email template for the event *Newsletter opt-in*. +
Inserting a variable here is not mandatory. It would be possible, however, to insert a variable of a coupon code for your online shop to say thank you.

| *Customer registration*
|If you xref:crm:emailbuilder.adoc#create-template[created] the template and link the template with this event, a confirmation email will be sent to your customers once they created a customer account in your online shop when placing an order, for example. +
Inserting a variable here is not mandatory. It would be useful, however, to add the URL to your online shop (`URL to online shop`) as well as a short welcome message. +
*_Note:_* You can find the variable in the <<#variables-global, Global>> category.

| *Email when item becomes available*
|If you xref:crm:emailbuilder.adoc#create-template[created] the template and link the template with this event, an email will be sent to your customers once a certain item is available again. +
*_Requirement:_* The contacts have entered their email address in the online shop directly next to the item that could not be delivered at that time. +
Ideally, the template that you link here contains the variables `URL to item` and `Item name`. +
*_Note:_* You can find the variable in the <<#variables-order-order-items, Order items (only for item list widget)>> category.

| *New order confirmation link*
| If you want to provide customers who order as guests with the possibility to request a new order confirmation link, you have to xref:crm:emailbuilder.adoc#create-template[create] an email template and link it here. +
The variable `URL to order confirmation` has to be contained in the template. +
*_Note:_* You can find the variable in the <<#variables-global, Global>> category. +
For further information about the softlogin, refer to the xref:online-store:shop-builder.adoc#softlogin[Setting up the ShopBuilder] page.

|====
--

Further options how to automate the email despatch to your customers are described in the chapters <<#set-up-event-procedures, Setting up event procedures>> and <<#email-despatch-to-multiple-email-addresses, Email despatch to multiple email addresses>>.

[#e-mail-messenger-integration]
=== Messenger integration

[IMPORTANT]
.Step can only be activated when *Messenger configuration* assistant has been completed
====
You can only activate the Messenger service in this step once you have completed the *Messenger configuration* assistant before. +
*_Tip:_* You can finalise the *Email accounts* assistant first and then complete the *Messenger configuration* assistant. Afterwards, come back to this assistant to activate the Messenger service and carry out further setting for the Messenger.
====

Go to *Setup » Client » Global » Email accounts*. In the *Messenger integration* assistant step, determine whether all sent emails and attachments should be collected in the xref:crm:messenger-testphase.adoc#[Messenger]. Furthermore, you can decide in which inbox the emails should be collected and which tags should be assigned to the conversations. You also select the default group for the email service.

[.collapseBox]
.Settings in the *Email accounts* assistant in the *Messenger integration* step
--
[[table-collect-emails]]
.Collect all sent emails in the Messenger module
[cols="1,3"]
|====
|Setting |Explanation

| *Activate Messenger integration*
a| If you want to start collecting the emails in the Messenger, activate the button *Activate service* (material:toggle_on[role=skyBlue]). +
The emails from the following plentysystems areas will be saved and shown in the Messenger: 

* Automatic despatch
* Order events
* Order procedures
* Group function in the contact data record
* Orders » Orders (Test phase)
* Group function in the order

| *Attachments*
| If you want to collect the email attachments in the messenger, activate the button *Collect attachments* (material:toggle_on[role=skyBlue]).

| *Inbox*
| Select the messenger inbox from the drop-down list in which the emails should be collected.

| *Tags*
| Select (material:check_box[role=skyBlue]) the tags from the list that should be added to the conversation.

| *Groups*
| Select the default group that should be assigned to conversations in this inbox.

|====
--

[#manage-folders]
== Managing folders

In the EmailBuilder, you can create as many <<#create-folder, folders>> as you like and upt to 3 <<#create-sub-folder, sub-folders>>. After you created the folder, click on material:more_vert[] to create new sub-folders, new templates in general and new header and footer templates and <<#rename-folder, rename>>, <<#move-folder, move>> or <<#delete-folder, delete>> the folders.

Your system contains a folder with pre-defined default templates. These are explained further down on this page in the <<#use-default-templates, Using default templates>> chapter.

[[image-emailbuilder-folder-structure]]
.Folder structure in the EmailBuilder
image::crm:emailbuilder-add-folder-template-header-footer.png[width=640, height=360]

[#create-folder]
=== Creating a folder

Create folders to get a better overview of your email templates at a later point in time. Proceed as described below to create a new folder.

[.instruction]
Creating a folder:

. Go to *CRM » EmailBuilder*.
. In the bottom left corner, click on material:add[] *Add* material:play_arrow[].
. Click on material:folder[] *Folder*. +
→ The *Add new folder* window opens.
. Enter the name for the folder.
. Click on *Save*. +
→ The new folder is added to the folder list.

[TIP]
Once you have carried out all settings as described in the following – so you have created sub-folders, templates, headers and footers –, you can open the main folder by clicking on material:chevron_right[] _Name of the folder_. You will see there at a glance all sub-folders, templates, headers and footers that you created directly in the main folder.

[#rename-folder]
=== Renaming the folder

You can update the folder name at any time. To do so, proceed as described below.

[.instruction]
Renaming the folder:

. Go to *CRM » EmailBuilder*.
. In the line of the folder that you want to rename, click on material:more_vert[] and then on material:edit[] *Rename*. +
→ The *Rename folder* window opens.
. Enter an other name for the folder.
. Click on *Save*. +
→ The new folder name is updated and shown in the list.

[#move-folder]
=== Moving a folder

You can move the folder to another position at any time. To do so, proceed as described below.

[.instruction]
Moving a folder:

. Go to *CRM » EmailBuilder*.
. In the line of the folder that you want to move, click on material:more_vert[] and then on material:open_with[] *Move*. +
→ The *Move* window opens.
. Select the target folder.
. Click on material:open_with[] *Move*. +
→ The folder is moved to the selected folder.

[#create-sub-folder]
=== Creating a sub-folder

Create sub-folders in your folders to group your email templates in even more detailed topics. You can create up to 3 sub-folders within a folder.

[TIP]
.Create a draft for your folder structure in advance
====
We recommend creating a draft in advance to avoid confusing and unclear nesting levels in your folder structure. Because: The more levels you create, the more complex the structure will be.
====

[.instruction]
Creating a sub-folder:

. Go to *CRM » EmailBuilder*.
. In the line of the folder that you want to create a sub-folder for, click on material:more_vert[] and then on material:add[] *Add*.
. Click on material:folder[] *Folder*. +
→ The *Add new folder* window opens.
. Enter the name for the sub-folder.
. Click on *Save*. +
→ The sub-folder is created within the main folder.

Open the sub-folder by opening the main folder with a click on material:chevron_right[]. You can see all sub-folders that you created at a glance.

[#delete-folder]
=== Deleting a folder

You can delete folders and sub-folders at any time. Note that the entire content in the folder will also be deleted.

[.instruction]
Deleting a folder:

. Go to *CRM » EmailBuilder*.
. In the line of the folder or sub-folder that you want to delete, click on material:more_vert[] and then on material:delete[] *Delete*. +
→ A window opens and you need to confirm your decision.
. Click on material:delete[role=red] *Delete*. +
→ The folder with all corresponding sub-folders and templates contained in there will be deleted.

[#manage-templates]
== Managing templates

Learn in the following sub-chapters how to create templates for <<#create-header, headers>> and <<#create-footer, footers>> and <<#create-template, general templates>>. Moreover, it is described how you <<#search-template, search for>>, <<#move-template, move>>, <<#copy-template, copy>>, <<#edit-template, edit>> and <<#delete-template, delete>> templates. +
You can also use pre-defined <<#use-default-templates, default templates>>. You will also learn everything about the available <<#insert-widget, widgets>> and how you can use these widgets in your templates.

[TIP]
Once you created a template, the template ID is shown in brackets in front of the template name. The systems assigns the IDs consecutively and automatically. This ID _cannot_ be changed.

The widgets and variables that are contained in the template form the actual content of your email. Via the widgets, you can insert as many variables as you like into a template by using drag-and-drop. These variables will then be replaced with the correct content when the email is sent to your customers.

To see which variables are available for your email templates, refer to the lists on the bottom of this page in the <<#variables-emailbuilder, Available variables and twig expressions>> chapter.

[#template-header-footer]
=== Creating templates for header and footer

Create templates for the header and the footer that you can later use in all of your email templates. Header and footer are globally active. This means: Changes you make to the header and footer affect the rest of all existing templates and all other templates that you will create in the future.

You can insert, for example, your company logo into the header and insert into the footer your signature and the general company details such as the address, links to social media, the legal structure of your company, details about your company’s executive board, and much more.

Proceed as described below to create a template for the <<#create-header, header>> and the <<#create-footer, footer>>.

[#create-header]
==== Creating a header template

Proceed as described below to create a template for the header of your email template.

[.instruction]
Creating a header template:

. Go to *CRM » EmailBuilder*.
. In the line of the folder or sub-folder that you want to create a header for, click on material:more_vert[] and then on material:add[] *Add* material:play_arrow[].
. Click on material:web_asset[] *Header*. +
→ The *Add new header* window opens.
. Enter a name for the header.
. Click on *Save*. +
→ The header template is created.
. Click on *Add* (material:add[]) to <<#add-language, add a language>>. +
→ A new window opens.
. Select a language from the list. +
→ The window *New name* opens.
. Enter the header template’s subject.
. Click on *Save*.
. In the *General settings* area, select (material:check_box[role=skyBlue]) the owner and the client.
. Click on *Edit* (material:edit[]).
. Edit the header according to your wishes and insert <<#insert-widget, widgets>> and <<#variables-emailbuilder, variables>>.
. *Save* (material:save[]) the settings.

[#show-header-preview]
==== Showing the preview of the header

You can view a preview of your header template at any time. This is possible either in HTML format or as plain text. Enter an order ID to fill the preview with real order data. Proceed as follows to open the preview of the template.

. Go to *CRM » EmailBuilder*.
. Expand the folder (material:chevron_right[]) that contains the header for which you want to show the preview.
. Click on the header.
. Click on *Preview* (material:preview[]). +
→ The *Preview* window opens.
. Select from the drop-down list *Preview format* the option *HTML* or *Plain text*.
. In the *Order ID* field, enter the ID of the order that you want to see a preview of.
. Click on material:preview[] *PREVIEW*. +
→ The preview opens in a separate window. +
*_Note:_* Your system remembers the value of the order ID you entered until the next login or until the browser cache is cleared.
. Check the header template.
. *Close* the window.

If you are not satisfied with the result, edit the content of your header again.

[#create-footer]
==== Creating a footer template

Proceed as described below to create a template for the footer of your email template.

[.instruction]
Creating a footer template:

. Go to *CRM » EmailBuilder*.
In the line of the folder or sub-folder that you want to create a footer for, click on material:more_vert[] and then on material:add[] *Add* material:play_arrow[].
. Click on material:video_label[] *Filter*. +
→ The *Add new footer* window opens. +
. Enter a name for the footer.
. Click on *Save*. +
→ The footer template is created.
. Click on *Add* (material:add[]) to <<#add-language, add a language>>. +
→ A new window opens.
. Select a language from the list. +
→ The window *New name* opens.
. Enter the footer template’s subject.
. Click on *Save*.
. In the *General settings* area, select (material:check_box[role=skyBlue]) the owner and the client.
. Click on *Edit* (material:edit[]).
. Edit the footer according to your wishes and insert <<#insert-widget, widgets>> and <<#variables-emailbuilder, variables>>.
. *Save* (material:save[]) the settings.

[#show-footer-preview]
==== Showing the preview of the footer

You can view a preview of your footer template at any time. This is possible either in HTML format or as plain text. Enter an order ID to fill the preview with real order data. Proceed as follows to open the preview of the template.

. Go to *CRM » EmailBuilder*.
. Expand the folder (material:chevron_right[]) that contains the footer for which you want to show the preview.
. Click on the footer.
. Click on *Preview* (material:preview[]). +
→ The *Preview* window opens.
. Select from the drop-down list *Preview format* the option *HTML* or *Plain text*.
. In the *Order ID* field, enter the ID of the order that you want to see a preview of.
. Click on material:preview[] *PREVIEW*. +
→ The preview opens in a separate window. +
*_Note:_* Your system remembers the value of the order ID you entered until the next login or until the browser cache is cleared.
. Check the footer template.
. *Close* the window.

If you are not satisfied with the result, edit the content of your footer again.

[#create-text-block]
=== Creating a text block

Create a text block that you can later xref:crm:messenger.adoc#insert-text-block[insert into the Messenger message]. Text blocks are ready-made text modules that save you a lot of time and effort, particularly if you often answer the same questions or deal with the same problems. You can also enter long texts here and save a lot of time when working with your messages. +
Think about a useful structure of folders, sub-folders and questions in advance.

[.instruction]
Creating a text block:

. Go to *CRM » EmailBuilder*.
. Search for the <<#create-folder-text-block, folder that you have just created>> and click on material:more_vert[].
. Click on material:add[] *Add* material:play_arrow[] and then on material:text_fields[] *Text blocks*. +
→ The *Add new text block* window opens.
. Enter the name.
. Click on *Save*. +
→ The text block is created and opened.
. Click on material:add[] (*Add*).
. Select a language from the list.
. In the *Content* area, click on material:edit[].
. Enter the text block’s content in the editor.
. Use the editor’s formatting options, if desired.
. Click on *Save*.

[IMPORTANT]
If you have been using plentysystems for a long time and have already created text blocks or FAQs in the old menu *CRM » Text blocks / FAQ*, you will see the folder *Text blocks (migrated)* in the *CRM » EmailBuilder* menu. This folder contains all folders, sub-folders and FAQs that you created in the old menu.

[#create-template]
=== Creating a template

Now create the template and save basic settings such as the name, the subject, CC and BCC and select the appropriate <<#create-header, header>> and <<#create-footer, footer>> for the template. Proceed as described below to create a new template.

[IMPORTANT]
.Important: Add header and footer in the corresponding language
====
If you created a template in <<#add-language, multiple languages>>, remember to create also the header and footer in these languages and to link them with the template. Otherwise, the template cannot be sent.
====

[TIP]
.Switching between multiple templates
====
If you later edit multiple templates in the editor at the same time, you can use the navigation on the left to switch between the individual templates. The template you have just opened is highlighted in blue at the beginning of the line.
====

[[image-emailbuilder-template]]
.Creating a template in the EmailBuilder
image::crm:emailbuilder-new-template.png[width=640, height=360]

[.instruction]
Creating a template:

. Go to *CRM » EmailBuilder*.
. In the bottom left corner, click on material:add[] *Add* material:play_arrow[]. +
icon:map-signs[] *_Or:_* In the line of the folder in which you want to create a template, click on material:more_vert[] and then on material:add[] *Add* material:play_arrow[]. +
. Click on material:description[] *Template*. +
→ The *Add new template* window opens.
. Carry out the settings. Note <<#table-emailbuilder-create-template>> and <<#image-emailbuilder-template>>.
. *Save* (material:save[]) the settings.

*_Note:_* If you do not want to create the template within a folder, click on the start page of the *CRM » EmailBuilder* menu in the bottom left on material:add[] *Add* material:play_arrow[] and select material:description[] *Template* afterwards. The template will then be created on the first level and does not belong to a folder.

[TIP]
.Email templates are sent in multipart format
====
The email templates in the EmailBuilder use the multipart format. This means that the emails are sent in an HTML and in a text version at the same time. +
This ensures that your emails can be read by all recipients, even if their email client restricts or completely disables the display of HTML in emails. On the other hand, the HTML versions of your emails that you designed are displayed for the recipients whose email client allows the display of HTML. The advantage for you is that you only have to maintain one email template.
====

[[table-emailbuilder-create-template]]
.Creating a template in the EmailBuilder
[cols="1,3"]
|====
|Setting |Explanation

2+^| *Add new template* window

|[#intable-template-settings-name]*Name*
|What’s the name of the template? Enter a descriptive name so you can easily find the template at a later point in time. +
*_Note:_* This field is a mandatory field.

|[#intable-template-settings-expert-mode]*Expert mode*
|Activate (material:toggle_on[role=skyBlue]) the option if you want to create the template in <<#use-expert-mode, expert mode>>. +
*_Note:_* If you activate the expert mode, the following options *Header*, *Footer* and *Build from default template* are deactivated.

|[#intable-template-settings-header]*Header*
|Which header do you want to show in this template? Select a header from the drop-down list (material:arrow_drop_down[]). +
The list contains all <<#create-header, headers>> that you have already created.

|[#intable-template-settings-footer]*Footer*
|Which footer do you want to show in this template? Select a footer from the drop-down list (material:arrow_drop_down[]). +
The list contains all <<#create-footer, footers>> that you have already created.

|[#intable-template-settings-default-template]*Build from default template*
|Expand the area (material:arrow_drop_down[]) to select one of the <<#use-default-templates, default templates>> and link it with the new template. +
*_Note:_* In the next step, you can adjust the default template that you select here according to your needs.

| *Save*
|Saves the settings.

2+^| Area for the template’s content +
In this area, you add the language and create the content of your template using widgets and variables. Note the information about line spacing in our xref:crm:faq.adoc#faq-line-spacing[FAQ area].

|[#intable-template-settings-add]*Add*
|Click on material:add[] (*Add*) to select the <<#add-language, language of the template>>. +
<<#image-emailbuilder-add-languages>> shows the list with the languages after you clicked on material:add[].

|[#intable-template-settings-subject]*Enter subject*
|What’s the subject of your email? Enter the subject in the corresponding language.
*_Note:_* By default, the language abbreviation is saved as subject. You can <<#adjust-subject, adjust>> the subject at any time.

| *Save*
|Saves the settings.

2+^|[#intable-content-and-subject]*Content and subject* +
This area is automatically opened.

|[#intable-template-settings-subject]*Subject*
|You can see the template’s subject here. You can <<#adjust-subject, adjust the subject>>, if needed. +
Click on material:integration_instructions[] (*Show variables*) at the end of the line to open the variable list. You can either search for the desired variable using the categories and sub-categories or you enter the variable’s name into the search field. When you click on the desired variable, the corresponding twig expression including the double curly brackets will be inserted in the subject line. +
*_Note:_* The *Subject* field is _not_ available for templates of the type *Header* and *Footer*.

|[#intable-template-settings-edit]*Edit*
|At the end of the *Content and subject* line, click on material:edit[] to edit the content of the template and to insert <<#insert-widget, widgets>> and <<#variables-emailbuilder, variables>>. +
The editor area opens and you can edit the content of the template by clicking on the widgets. +
Click on material:css[] in the toolbar on the top to adjust the <<#intable-template-settings-custom-styles, custom styles>> of your template. +
*_Note:_* The email templates use the multipart format. This means that the emails are sent in an HTML and in a text version at the same time.

|[#intable-template-settings-preview]*Preview*
|Click on material:preview[] *Preview* at the end of the line *Content and subject* and select from the *Preview format* list the option *HTML* or *Plain text*. Enter the ID of the order into the *Order ID* field to fill the preview with real order data. The preview opens in a separate window.

2+^|[#intable-language-specific-settings]*Language settings* +
In this area, you carry out the language-specific settings of the template. For example, you can link product data sheets or user manuals in the corresponding language with the template and determine the time, date and number formats for each language individually. +
*_Note:_* If the template is of the type *Header* or *Footer*, only the field <<#intable-template-settings-custom-styles, custom styles>> is available in this area. A subject and static attachments are not available for headers and footers.

|[#intable-template-settings-copy]*Copy*
|At the end of the *Language settings* line, click on material:more_vert[] and then on material:content_copy[] *Copy* to copy the content and the language settings of the template for another language. +
*_Note:_* The content is _not_ translated automatically. You have to add the translation yourself.

|[#intable-template-settings-delete]*Delete*
|At the end of the *Language settings* line, click on material:more_vert[] and then on material:delete[] *Delete*. After you have confirmed your decision, the template will be deleted.

| *Language ID*
|The ID is shown here. This ID _cannot_ be changed.

|[#intable-template-settings-static-attachments]*Static attachments*
|This drop-down list provides all attachments that you uploaded before in the *CMS » Documents* menu. These are, for example, installation guides or product data sheets in the corresponding language. Select (material:check_box[role=skyBlue]) up to 3 static attachments from the drop-down list. +

| *UPLOAD* material:file_upload[]
| Here, you can upload the attachments directly from your computer without the need to upload them in the *CMS » Documents* menu in advance. +
*_Note:_* This drop-down list is _not_ available for templates of the type *Header* and *Footer*.

|[#intable-template-settings-custom-styles]*Custom styles*
|You can adjust the CSS styling of your template, header and footer here. The <<#examples-custom-styles, Custom styles: Common CSS examples>> chapter below this table contains some common examples for adjusting the styling of your template. +
*_Tip:_* Save the settings and open the *Preview* (material:preview[]) to check your entries and to make further adjustments, if needed.

|[#intable-template-settings-number-format]*Number format*
|Select the German or English notation for the number format from the list.

*_Example:_* The German notation shows the number formats as follows: 1,25 or 1.000,25. The English notation shows the number formats as follows: 1.25 or 1,000.25.

|[#intable-template-settings-decimals]*Number of decimals*
|Enter a number that defines the number of decimals.

|[#intable-template-settings-date-format]*Date format*
a|Select the date format from the drop-down list.

`dd` represents the day, `mm` the month and `yyyy` the year. By default, the date format `dd.mm.yyyy` is preselected for German systems and the format `dd-mm-yyyy` for all other languages. +
Available formats:

* yyyy-mm-dd
* dd.mm.yyyy
* dd-mm-yy
* dd/mm/yyyy
* mm-dd-yyyy

|[#intable-template-settings-time-format]*Time format*
a|Select the time format from the drop-down list.

`hh` represents the hour in 12h format, `HH` represents the hour in 24h format, `ii` the minutes and `ss` the seconds. `a` returns the addition AM or PM depending on the time of day. By default, the time format `HH:ii` is preselected. +
Available formats:

* hh:ii:ss a
* hh.ii.ss a
* hh-ii-ss a
* hh:ii a
* hh.ii a
* hh-ii a
* HH:ii:ss
* HH.ii.ss
* HH-ii-ss
* HH:ii
* HH.ii
* HH-ii

2+^|[#intable-general-template-settings]*General settings* +
In the *General settings* area on the right side of your screen, you carry out the general settings for the template in the corresponding language. 

|[#intable-template-settings-name]*Name*
|You can see the name here that you have just entered. If needed, you can adjust the name.

|[#intable-template-settings-owner]*Owner*
|Select the owner from the drop-down list.

|[#intable-template-settings-client]*Client*
|Select (material:check_box[role=skyBlue]) one or multiple clients from the list.

|[#intable-template-settings-header]*Header*
|You can see the header here that you have just selected for the template. If needed, you can select another header. +
*_Important:_* Make sure to select a header here that has the same language as the template.

|[#intable-template-settings-footer]*Footer*
|You can see the footer here that you have just selected for the template. If needed, you can select another footer. +
*_Important:_* Make sure to select a footer here that has the same language as the template.

|[#intable-template-settings-dynamic-attachments]*Dynamic attachments*
|This drop-down list provides all xref:orders:order-documents.adoc#100[location-based documents] that you set up in the *Setup » Client » [Select client] » Locations » [Select location] » Documents* menu and in the *Setup » Documents » DocumentBuilder* menu. +
The option *Custom order document* refers to the document that you have created in the xref:orders:document-builder.adoc#[DocumentBuilder]. +
If you select the option *External documents*, all external documents that you have uploaded in the *Documents* area of the order will be attached to the email template. +
Select (material:check_box[role=skyBlue]) up to 4 dynamic attachments from the drop-down list.

//| *From*
//|This is the sender of the email just as it is saved in the email settings of your system.

|[#intable-template-settings-reply-to]*Reply to*
|Who is the recipient of this email? Enter the email address(es). +
*_Note:_* When you enter several email addresses, separate them with a comma each.

|[#intable-template-settings-cc]*CC*
|To whom do you want to send a copy of this email? Enter the email address(es). +
*_Note:_* When you enter several email addresses, separate them with a comma each.

|[#intable-template-settings-bcc]*BCC*
|To whom do you want to send a blind copy of this email? Enter the email address(es). +
*_Note:_* When you enter several email addresses, separate them with a comma each.

|[#intable-template-settings-back-to-template-configuration]*Back to template configuration*
|Click on material:arrow_back[] at the top right to go back to the template configuration.

2+^|[#intable-toolbar]*Toolbar*

|[#intable-toolbar-save]*Save*
|Saves the changes that you have made to the template.

|[#intable-toolbar-template-usage]*Template usage*
|Click on material:assessment[] to open the *Template usage* window. Here, you can see in which areas of your system the EmailBuilder template has been used. For further information, refer to this <<#template-usage, chapter>>.

|====

[#examples-custom-styles]
=== Custom styles: Common CSS examples

<<#table-emailbuilder-examples-css-styling>> lists some common examples to adjust the CSS styling of your template. You can adjust the CSS styling using the following options: 

* in the *Language settings* are of the template in the *Custom styling* field
* by clicking on material:edit[] within in the template and then on material:css[]
* in the widget settings in the fields *Custom CSS* and *Custom element ID*

[IMPORTANT]
material:warning[] In order for the CSS styling to be displayed correctly, it has to be surrounded by a class or an element ID. +
If you want to save multiple CSS stylings for the template, enter all values one after the other, separated by a semicolon. +
*_Tip:_* Take a look at the CSS tutorial on this link:https://www.w3schools.com/css/default.asp[page^] that comes with illustrative examples.

Expand the following box to see examples.

[.collapseBox]
.Positive and negative examples for the CSS styling
--
<<#image-emailbuilder-css-positive-example-without-class-name>> shows a *[green]#positive example#* for the CSS styling. Here, the class has no name, but only consists of *. +
*_Note:_* You can see an example of a class with name in <<#image-emailbuilder-css-own-class>> further down below in this box.

[[image-emailbuilder-css-positive-example-without-class-name]]
.CSS styling: *[green]#positive example#*
image::crm:emailbuilder-css-positive-example-without-class-name.png[width=320, height=180]

In contrast to the first image, <<#image-emailbuilder-css-negative-example>> shows a *[red]#negative example#*. Here, the class is missing. This is why CSS styling would _not_ work for the template. 

[[image-emailbuilder-css-negative-example]]
.CSS styling: *[red]#negative example#*
image::crm:emailbuilder-css-negative-example.png[width=320, height=180]

If you have created multiple classes or element IDs and want to use them differently in your templates, we recommend that you always give the class or element ID a name. This makes it easier for you to recognise the correct class later if you want to select it in the widget settings in the *Custom CSS class* or *Custom element ID* fields:

image::crm:emailbuilder-custom-css-class-element-id.png[width=320, height=180]

The following two images show the example once with a named class and once with a named ID. +
*_Note:_* If you enter a name for the class, it always has to start with *.*. If you enter a name for the ID, it always has to start with # .

[[image-emailbuilder-css-own-class]]
.CSS styling: custom class
image::crm:emailbuilder-css-custom-class.png[width=320, height=180]

[[image-emailbuilder-css-own-id]]
.CSS styling: custom ID
image::crm:emailbuilder-css-custom-id.png[width=320, height=180]

--

[[table-emailbuilder-examples-css-styling]]
.Examples: CSS styling
[cols="2,4"]
|===
|CSS-Styling |Explanation

|Template width
|Enter `max-width:` in the *Custom styles* field followed by the desired width in pixel, e.g. `max-width:1200px`.

|Background colour
|Enter `background-color:` in the *Custom styles* field followed by the desired link:https://htmlcolorcodes.com/[HTML colour code^], e.g. `background-color:&#35;A9F5D0;`.

|Font colour
|Enter `color:` in the *Custom styles* field followed by the desired link:https://htmlcolorcodes.com/[HTML colour code^], e.g. `color:&#35;A0A1B;`.

|Font size
|Enter `font-size:` in the *Custom styles* field followed by the desired font size in pixel, e.g. `font-size:20px;`.

|Font weight
|Enter `font-weight:` in the *Custom styles* field followed by the desired font weight, e.g. `font-weight:700;`.

|Text alignment
|Enter `text-align:center;` in the *Custom styles* field if the text should be placed in the middle. Enter `text-align:right;` if the text should be aligned on the right.

|Background image
|Enter `background-image: url(_link_to_image_);` in the *Custom styles* field and replace `_link_to_image_` with the corresponding image link to show a background image in your template.

|Text frame
|Enter e.g. `border: 1px solid blue;` in the *Custom styles* field to insert a blue frame with 1px around the text.

|Inner margin
|Enter `padding:10px;` in the *Custom styles* field if the margin should be 10px on all sides. Enter `padding: 10px 20px;` if the margin should be 10px on the top and bottom and 20px on the left and right sides.

|===

[#insert-widget]
=== Inserting a widget into a template

In the editor, you can find a selection of widgets whose contents are already pre-configured for you. You can later insert <<#available-variables, variables>> in some widgets. +
The following widgets are available:

* <<#intable-widget-two-column-layout, Two-column layout>>
* <<#intable-widget-three-column-layout, Three-column layout>>
* <<#intable-widget-text, Text>>
* <<#intable-widget-code, Code>>
* <<#intable-widget-contact-address, Contact address>>
* <<#intable-widget-order-address, Order address>>
* <<#intable-widget-order-items, Order items>> 
* <<#intable-widget-item-list, Item list>>
* <<#intable-widget-image, Image>>
* <<#intable-widget-if-else, If-else widget>>

For example, you will find in the *Order items* widget a pre-defined list with the most important variables around the ordered item such as item name, the number of ordered items, the prices, the shipping costs and the total invoice amount. However, you can adjust the content at any time according to your needs and add further column names and individual items.

Proceed as described below to insert one or multiple widgets into your template.

[.instruction]
Inserting a widget into a template:

. Go to *CRM » EmailBuilder*.
. Expand the folder (material:chevron_right[]) that contains the template you want to edit.
. Click on the template.
. Click on *Edit* (material:edit[]). +
→ The editor opens and the widgets are loaded.
. Click on the widget on the left side and drag-and-drop it to the shaded area.
. Depending on the widget you are using, click on material:edit[] or material:settings[] and carry out the settings. Note the explanations about the individual widgets and their editing options in <<#table-available-widgets-emailbuilder>>.
. *Save* (material:save[]) the settings.

[[table-available-widgets-emailbuilder]]
.Available widgets in the EmailBuilder
[cols="1,3a"]
|====
|Widget |Explanation

|[#intable-widget-two-column-layout]*Two-column layout*
a|Allows to display text in a two-column layout. Click on material:settings[] to open the settings. You can also determine the relation how the fields are displayed. The following values are available:

* 50% / 50% (standard)
* 30% / 70%
* 70% / 30%

You can insert further widgets in this widget by dragging them to one of the two columns. Insert, for example, an <<#intable-widget-image, image widget>>. +
*_Note:_* In the widget settings, you can use the *Custom CSS* and *Custom element ID* fields to adjust your template’s CSS styling yourself. You can find further information and examples in this <<#examples-custom-styles, chapter>>.

Click on *Close settings* (material:close[]) to close the settings. Click on *Delete widget* (material:delete[]) to remove the widget.

|[#intable-widget-three-column-layout]*Three-column layout*
a|Allows to display text in a three-column layout.

You can insert further widgets in this widget by dragging them to one of the three columns. Insert, for example, an <<#intable-widget-image, image widget>>.

Click on material:settings[] to open the settings. Here, you can remove the widget by clicking on *Delete widget* (material:delete[]). Further settings cannot be carried out in this area. Click on *Close settings* (material:close[]) to close the settings. +
*_Note:_* In the widget settings, you can use the *Custom CSS* and *Custom element ID* fields to adjust your template’s CSS styling yourself. You can find further information and examples in this <<#examples-custom-styles, chapter>>.

|[#intable-widget-text]*Text*
|In this widget, you can enter text and use variables. You can also format the text you entered. To do so, double-click on the word that you want to format.

Click on material:edit[] to open the list with the variables on the left side of the screen. Use the search function to find the variables or find the appropriate variables by expanding the individual areas (material:chevron_right[]). Click on the variable you want to insert. Enter additional text in the widget, if needed.

Click on material:settings[] to open the settings. Use the *Custom CSS* and *Custom element ID* fields to adjust your template’s CSS styling yourself. You can find further information and examples in this <<#examples-custom-styles, chapter>>. +
Here, you can remove the widget by clicking on *Delete widget* (material:delete[]). Click on *Close settings* (material:close[]) to close the settings.

|[#intable-widget-code]*Code*
|In this widget, you can insert text in HTML format and use <<#twig-code-widget, twig expressions>>. To do so, some basic HTML skills are needed.

Click on icon:code[] to open the view. +
On the left side of the code editor, you can see the <<#available-variables, list with the available variables>>. The difference to the variable list that opens in the text widget, for example, is that the twig expression is automatically inserted into the code editor when you click on the variable.

Click on material:settings[] to open the settings. Here, you can remove the widget by clicking on *Delete widget* (material:delete[]). Further settings cannot be carried out in this area. Click on *Close settings* (material:close[]) to close the settings. 

Note also the code examples for the code widget in this <<#code-examples-code-widget, chapter>>.

|[#intable-widget-contact-address]*Contact address*
|This widget contains data of the contact address. The layout of the address depends on the settings that you saved in the *Setup » CRM » Address layout* menu. This means: The layout in the EmailBuilder is displayed in the same way as the address layout that you defined as the xref:crm:preparatory-settings.adoc#[standard address layout] in the *Setup » CRM » Address layout* menu.

Click on material:settings[] to open the settings. Select the address type *Invoice address* or *Delivery address* from the drop-down list.

Click on *Close settings* (material:close[]) to close the settings. Click on *Delete widget* (material:delete[]) to remove the widget. +
*_Note:_* In the widget settings, you can use the *Custom CSS* and *Custom element ID* fields to adjust your template’s CSS styling yourself. You can find further information and examples in this <<#examples-custom-styles, chapter>>.

*_Note:_* You can find all addresses that are saved for the contact in the contact data record in the xref:crm:edit-contact.adoc#addresses[Addresses] area. The contact’s primary delivery and invoice address are saved in the contact data record in the xref:crm:edit-contact.adoc#primary-address[Primary address] area.

|[#intable-widget-order-address]*Order address*
|This widget contains data of the order address. The layout of the address depends on the settings that you saved in the *Setup » CRM » Address layout* menu. This means: The layout in the EmailBuilder is displayed in the same way as the address layout that you defined as the xref:crm:preparatory-settings.adoc#[standard address layout] in the *Setup » CRM » Address layout* menu.

Click on material:settings[] to open the settings. Select the address type *Invoice address* or *Delivery address* from the drop-down list.

Click on *Close settings* (material:close[]) to close the settings. Click on *Delete widget* (material:delete[]) to remove the widget. +
*_Note:_* In the widget settings, you can use the *Custom CSS* and *Custom element ID* fields to adjust your template’s CSS styling yourself. You can find further information and examples in this <<#examples-custom-styles, chapter>>.

*_Note:_* You can find all addresses that are saved for the contact in the contact data record in the xref:crm:edit-contact.adoc#addresses[Addresses] area. The contact’s primary delivery and invoice address are saved in the contact data record in the xref:crm:edit-contact.adoc#primary-address[Primary address] area.

|[#intable-widget-order-items]*Order items*
|This widget contains a pre-defined layout for the order items that you can adjust, of course.

Click on material:settings[] to open the settings. Select from the *Currency settings* list whether you want to show the currency symbol (e.g. *€*) or the ISO symbol (e.g. *EUR*) in the widget.

Use the drop-down list *Column value* to decide which content is to be shown in the columns and as individual positions. +
Enter in the fields *Set column width* below a value in percent to adjust the table’s column widths. +
If you want to change the column name: Enter in the fields *Set column name* each the new name for the column shown. +
Click on material:unfold_more[] to change the order of the columns shown. +
You can immediately see in the preview how the changes affect the table. +
Click on material:add[] (*Add new entry*) in the settings to add further columns. Click on *Remove entry* (material:delete[]) to delete the columns from the overview. +
*_Note:_* In the widget settings, you can use the *Custom CSS* and *Custom element ID* fields to adjust your template’s CSS styling yourself. You can find further information and examples in this <<#examples-custom-styles, chapter>>.

[.collapseBox]
.Available columns and individual positions in the table of the “Order items” widget
--

*Available columns*:

* Quantity
* Item ID
* Item name
* Item image
* Attribute values
* Barcode
* Barcode image
* Unit price (gross)
* Unit price (net)
* External variation ID
* VAT value
* VAT rate
* Price (gross)
* Price (net)
* Discount (%)
* Discount (gross)
* Discount (net)
* Variation ID
* Variation name
* Variation number
* Availability
* Order property value

*_Tip:_* You can enter a number in percent in the *Column width* field to determine the column width yourself.

*Available individual positions*:

* VAT rates and values
* Discount (gross)
* Discount (net)
* Shipping costs (gross)
* Shipping costs (net)
* Value of items (gross)
* Value of items (net)

* Open amount
* Amount paid
* Invoice amount (gross)
* Invoice amount (net)

--

|[#intable-widget-item-list]*Item list*
|In this widget, you can enter text and use variables. Note that you can only use variables from the sub-category <<#variables-order-order-items, Order / Order items (only for item list widget)>> in this widget.

Click on material:edit[] to open the list with the variables on the left side of the screen. Use the search function to find the variables or find the appropriate variables by expanding the individual areas (material:chevron_right[]). Click on the variable that you want to insert. Enter additional text in the widget, if needed.

Click on material:settings[] to open the settings. Use the *Custom CSS* and *Custom element ID* fields to adjust your template’s CSS styling yourself. You can find further information and examples in this <<#examples-custom-styles, chapter>>. +
Here, you can remove the widget by clicking on *Delete widget* (material:delete[]). Click on *Close settings* (material:close[]) to close the settings.

|[#intable-widget-image]*Image*
| Use this widget to upload images such as your company logo to show it in your email templates.

Click on material:settings[] to open the settings. You can upload the image, enter the width and height of the image in px or %, enter an alternative text, adjust the styling in CSS format and save the image link. +
*_Important:_* Always use `https` for the image link. +
*_Tip:_* If you want to place the image to a certain position, you can adjust the CSS styling in the field *Custom styling*, e.g. `margin-left: auto; margin-right: 0; display: block;` or `float:right;display:block;`. Further information can be found link:https://www.w3schools.com/css/css3_images.asp[here^] and link:https://www.caniemail.com/[here^].

Click on *Close settings* (material:close[]) to close the settings. Click on *Delete widget* (material:delete[]) to remove the widget. +
*_Note:_* In the widget settings, you can use the *Custom CSS* and *Custom element ID* fields to adjust your template’s CSS styling yourself. You can find further information and examples in this <<#examples-custom-styles, chapter>>.

|[#intable-widget-if-else]*If-else widget*
|Use this widget to implement if-else conditions. +
Click on material:settings[] to open the settings. You can select the following *variables* here:

* Client ID
* Payment method
* Shipping profile
* Class
* Availability
* Warehouse
* Order referrer
* Language
* Variation ID

After you selected a variable, select one of the following *relational operators* from the list:

* Is equal to
* Is not equal
* Greater than
* Less than
* Greater than or equal to
* Less than or equal to

Once you have selected a relational operator, the values available in your system for the variable selected above are available. Select an option from the list. +
*_Note:_* For the variable *Variation ID*, an input field is available, for all other variables a drop-down list.

Click on *Close settings* (material:close[]) to close the settings. Click on *Delete widget* (material:delete[]) to remove the widget. +
*_Note:_* In the widget settings, you can use the *Custom CSS* and *Custom element ID* fields to adjust your template’s CSS styling yourself. You can find further information and examples in this <<#examples-custom-styles, chapter>>.

|====

[#show-widget-preview]
[discrete]
==== Showing the preview of the widget

Check the widget by opening the preview.

. Go to *CRM » EmailBuilder*.
. Expand the folder (material:chevron_right[]) that contains the template for which you want to show the preview.
. Click on the template.
. Click on *Preview* (material:preview[]).
. Select *Preview HTML* or *Preview plain text*. +
→ The preview opens in a separate window.
. Check the widget.
. *Close* the window.

If you are not satisfied with the result, <<#edit-widget, edit>> the widget.

[#edit-widget]
=== Editing the widget

You can edit the content of the widgets at any time. To do so, proceed as described below.

[TIP]
Note the information about line spacing in our xref:crm:faq.adoc#faq-line-spacing[FAQ area].

[.instruction]
Editing a widget:

. Go to *CRM » EmailBuilder*.
. Expand the folder (material:chevron_right[]) that contains the template you want to edit.
. Click on the template.
. Click on *Edit* (material:edit[]). +
→ The editor opens and the widgets are loaded.
. Click on material:settings[]. +
→ The widget settings open – if they are available.
. Click on material:edit[] - if available. +
→ The variables open on the left side.
. Use the search function to find the variables or find the appropriate variables by expanding the individual areas (material:chevron_right[]).
. Click on the variable that you want to show in the widget. +
→ The variable is taken to the widget.
. *Save* the settings.

[#use-expert-mode]
=== Using the expert mode

Use the expert mode for your EmailBuilder templates to be even more flexible when designing your content. +
For further information about twig, refer to the link:https://twig.symfony.com/doc/3.x/[Twig documentation^].

[#create-template-expert-mode]
==== Creating a template in expert mode

Proceed as described below to create a template in expert mode.

[.instruction]
Creating a template in expert mode:

. Go to *CRM » EmailBuilder*.
. In the line of the folder in which you want to create a template, click on material:more_vert[] and then on material:add[] *Add* material:play_arrow[].
. Click on material:description[] *Template*. +
→ The *Add new template* window opens.
. Enter a name.
. Activate (material:toggle_on[role=skyBlue]) the option *Expert mode*.
. Click on *Save*. +
→ The template opens.
. Carry out the settings in the *General settings* area. Note <<#table-email-builder-create-template>>.
. Click on material:add[] (*Add*) in the top right and select a language from the list. +
→ The *Enter subject* window opens.
. Enter a subject for the template.
. Click on material:save[] (*Save*).
. Now, click on material:edit[] (*Edit*) to open the expert mode.
. Carry out the desired changes in the template. Note the explanations in the chapters <<#dark-mode, Showing the template in “dark mode”>> and <<#variables-in-expert-mode, Inserting variables in expert mode>>.
. Click on material:save[] (*Save*). +
*_Note:_* Templates that were created with the expert mode are shown in the navigation on the left-hand side with the material:integration_instructions[] symbol and the _Name of the template_.

[#dark-mode]
==== Showing the template in “dark mode”

You can also display templates in expert mode in “dark mode”. To do so, click in the expert mode template on material:dark_mode[] (*Dark mode*).

[[image-emailbuilder-expert-mode-dark-mode]]
.Template in expert mode in “dark mode”
image::crm:emailbuilder-expert-mode-dark-mode.png[width=640, height=360]

If you want to switch back to “light mode”, click on the symbol material:light_mode[] (*Light mode*).
 
[#variables-in-expert-mode]
==== Inserting variables in expert mode

If you are in expert mode within the template (see <<#image-emailbuilder-expert-mode-dark-mode>>), you can view the variable list by simply clicking on material:list[] (*Show variables*). 

In the *Search* field, enter the name of the variable or expand the different categories to search for the variables. +
If you have found the desired variable in the list, click on it once to copy the corresponding twig expression to the clipboard.

Now navigate with your mouse to the desired location in your template where you want to insert the content. Insert the content that you have copied to the clipboard by using the key combination Strg+v or cmd+v. +
*_Note:_* Because you are in expert mode, the corresponding twig expression will be inserted and _not_ the variable name.

Also note the <<#code-example-expert-mode, code example for the expert mode>>.

[#preview-expert-mode]
==== Showing the preview in expert mode

You can view a preview of your template in expert mode at any time. This is possible either in HTML format or as plain text. Enter an order ID to fill the preview with real order data. Proceed as follows to open the preview of the template.

[.instruction]
Showing the preview:

. Go to *CRM » EmailBuilder*.
. Expand the folder (material:chevron_right[]) that contains the template for which you want to show the preview.
. Click on the template material:integration_instructions[] _Name of the template_.
. Click on *Preview* (material:preview[]). +
→ The *Preview* window opens.
. Select from the drop-down list *Preview format* the option *HTML* or *Plain text*.
. In the *Order ID* field, enter the ID of the order that you want to see a preview of.
. Click on material:preview[] *PREVIEW*. +
→ The preview opens in a separate window. +
*_Note:_* Your system remembers the value of the order ID you entered until the next login or until the browser cache is cleared.
. Check the template.
. *Close* the window.

[#use-default-templates]
=== Using default templates

Before you <<#create-folder, created a new folder>>, you might have recognised the folders *Standardvorlagen* and *Default templates*? These folders contain pre-defined templates in German and English language. You can either use the default templates as they are available in your system or you can adjust their content according to your needs.

Besides the content of the email template, the subject is already filled in in a default template. This means that you only have to select the owner, the client and header and footer and fill the fields *Reply to* and, if needed, also *CC* and *BCC*. Also it is possible to adjust the pre-filled subject and attach dynamic and static attachments as well as define the number format, date format and date format and the number of decimals.

[TIP]
.Switching between multiple templates
====
If you later edit multiple templates in the editor at the same time, you can use the navigation on the left to switch between the individual templates. The template you have just opened is highlighted in blue at the beginning of the line.
====

[[image-emailbuilder-example-default-template]]
.Example: Default template *Order: Shipping confirmation*
image::crm:emailbuilder-example-default-template.png[width=640, height=360]

[#create-default-template]
==== Creating a default template

12 default templates in total are available in German and English each in your system. When creating a new template, you can select one of these default templates and adjust it, if needed. Refer to the <<#default-templates-name-and-subject, Available default templates>> chapter to see which default templates are available and what their subject is.

[.instruction]
Creating a default template:

. Go to *CRM » EmailBuilder*.
. In the line of the folder in which you want to create a default template, click on material:more_vert[] and then on material:add[] *Add* material:play_arrow[].
. Click on material:description[] *Template*. +
→ The *Add new template* window opens.
. Enter a name for the template.
. Select header and footer for the default template from the drop-down list.
. Select a default template from the drop-down list *Build from default template*.
. *Save* (material:save[]) the settings. +
→ The template is created and opened. 

[TIP]
If you do not want to create the default template within a folder, click on the start page of the *CRM » EmailBuilder* menu in the bottom left on material:add[] *Add* material:play_arrow[] and select material:description[] *Template* afterwards. The template will then be created on the first level and does not belong to a folder.

[#default-template-adjust-subject]
==== Adjusting the default template’s subject

As soon as the default template is created, you can see the prefilled content in the toolbar. Simply click in the line of the subject to adjust it. Click on material:integration_instructions[] (*Show variables*) at the end of the subject line to open the variable list. You can either search for the desired variable using the categories and sub-categories or you enter the variable’s name into the search field. When you click on the desired variable, the corresponding twig expression including the double curly brackets will be inserted in the subject line.

[#default-template-static-attachments-and-styling]
=== Selecting static attachments and adjusting the default template’s styling

In the *Language settings* area, you can select up to 3 static attachments that you can attach to your email template. Also in this area, you can adjust the xref:crm:emailbuilder.adoc#examples-custom-styles[custom styles] of the template such as the template width and font size and define the <<#intable-template-settings-number-format, number format>>, <<#intable-template-settings-date-format, date format>> and <<#intable-template-settings-time-format, time format>> for your templates.

[#edit-default-template]
==== Editing the default template

Besides the language settings where you can select static attachments for your template, for example, you can also adjust the template’s content or the subject by clicking on material:edit[] in the *Content and subject* line.

In the *General settings* area of the template, select an owner, the client and the header and footer, if not done already. In this area, you can also select up to 4 dynamic attachments and fill the fields *Reply to*, *CC* and *BCC*.

[#default-templates-name-and-subject]
==== Available default templates

Would you like to know which default templates are already available in the EmailBuilder and how their subjects are? Simply expand the following area by clicking on material:expand_more[].

[.collapseBox]
.Default templates in the EmailBuilder and their subjects
--

*English default templates in the EmailBuilder and their subjects*

[[table-default-templates-english]]
.English default templates in the EmailBuilder and their subjects
[cols="2,2"]
|====
|English template |Subject

|Order: Changes
|Change to your order with ID &#123;&#8288;&#123;order.id&#125;&#8288;&#125;

|Order: Partial payment received
|Partial payment for order ID &#123;&#8288;&#123;order.id&#125;&#8288;&#125; received

|Order: Shipping confirmation
|Shipping confirmation for your order with ID &#123;&#8288;&#123;order.id&#125;&#8288;&#125;

|Order: Payment complete
|Payment for order ID &#123;&#8288;&#123;order.id&#125;&#8288;&#125; fully received

|Order: Payment reminder
|Payment status for the order placed on &#123;&#8288;&#123;order.formattedDates.createdOn&#125;&#8288;&#125; with order ID &#123;&#8288;&#123;order.id&#125;&#8288;&#125;

|Order: Invoice
|Invoice for order ID: &#123;&#8288;&#123;order.id&#125;&#8288;&#125; from &#123;&#8288;&#123;order.formattedDates.createdOn&#125;&#8288;&#125;

|eBay: dispute / cancellation, no payment
|Your order with the ID &#123;&#8288;&#123;order.id&#125;&#8288;&#125; was cancelled

|eBay: Order confirmation
|eBay auction won: Order ID &#123;&#8288;&#123;order.id&#125;&#8288;&#125;

|eBay: Order confirmation with bank details without checkout
|Order confirmation for your eBay order with the ID &#123;&#8288;&#123;order.id&#125;&#8288;&#125;

|Shop: New password
|Your requested login details for our online shop

|Shop: Newsletter registration
|Confirmation of newsletter registration

|Shop: Order confirmation
|Order confirmation for your order with ID &#123;&#8288;&#123;order.id&#125;&#8288;&#125;

|====

*German default templates in the EmailBuilder and their subjects*

[[table-default-templates-german]]
.German default templates in the EmailBuilder and their subjects
[cols="2,2"]
|====
|German template |Subject

|Auftrag: Änderung
|Auftragsänderung Ihrer Bestellung mit der ID &#123;&#8288;&#123;order.id&#125;&#8288;&#125;

|Auftrag: Teilzahlung erhalten
|Teilzahlung für Auftrags-ID &#123;&#8288;&#123;order.id&#125;&#8288;&#125; erhalten

|Auftrag: Versandbestätigung
|Versandbestätigung für Ihre Bestellung mit der ID &#123;&#8288;&#123;order.id&#125;&#8288;&#125;

|Auftrag: Zahlungseingang vollständig
|Zahlung für Auftrag &#123;&#8288;&#123;order.id&#125;&#8288;&#125; vollständig erhalten

|Auftrag: Zahlungserinnerung
|Zahlungsstatus für den Auftrag mit der ID &#123;&#8288;&#123;order.id&#125;&#8288;&#125; vom &#123;&#8288;&#123;order.formattedDates.createdOn&#125;&#8288;&#125;

|Auftrag: Rechnung PDF-Anhang
|Rechnung zu Order-ID &#123;&#8288;&#123;order.id&#125;&#8288;&#125; vom &#123;&#8288;&#123;order.formattedDates.createdOn&#125;&#8288;&#125;

|eBay: Disput / Storno, keine Zahlung
|Ihre Bestellung mit der ID &#123;&#8288;&#123;order.id&#125;&#8288;&#125; wurde storniert

|eBay: Eingangsbestätigung Bestellung
|eBay-Auktion gewonnen: Auftrags-ID &#123;&#8288;&#123;order.id&#125;&#8288;&#125;

|eBay: Eingangsbestätigung mit Bankdaten ohne Checkout
|Eingangsbestätigung zum eBay-Auftrag mit der ID &#123;&#8288;&#123;order.id&#125;&#8288;&#125;

|Shop: Neues Passwort
|Ihre angeforderten Zugangsdaten zu unserem Webshop

|Shop: Newsletter-Anmeldung
|Bestätigung zur Newsletter-Anmeldung

|Shop: Eingangsbestätigung Bestellung
|Auftragsbestätigung für Auftrags-ID &#123;&#8288;&#123;order.id&#125;&#8288;&#125;

|====

--

[#template-show-preview]
=== Showing the preview of the template

You can view a preview of your template at any time. This is possible either in HTML format or as plain text. Enter an order ID to fill the preview with real order data. Proceed as follows to open the preview of the template.

[TIP]
.Email templates are sent in multipart format
====
The email templates in the EmailBuilder use the multipart format. This means that the emails are sent in an HTML and in a text version at the same time. +
This ensures that your emails can be read by all recipients, even if their email client restricts or completely disables the display of HTML in emails. On the other hand, the HTML versions of your emails that you designed are displayed for the recipients whose email client allows the display of HTML. The advantage for you is that you only have to maintain one email template.
====

[.instruction]
Showing the preview:

. Go to *CRM » EmailBuilder*.
. Expand the folder (material:chevron_right[]) that contains the template for which you want to show the preview.
. Click on the template.
. Click on *Preview* (material:preview[]). +
→ The *Preview* window opens.
. Select from the drop-down list *Preview format* the option *HTML* or *Plain text*.
. In the *Order ID* field, enter the ID of the order that you want to see a preview of.
. Click on material:preview[] *PREVIEW*. +
→ The preview opens in a separate window. +
*_Note:_* Your system remembers the value of the order ID you entered until the next login or until the browser cache is cleared.
. Check the template.
. *Close* the window.

If you are not satisfied with the result, <<#edit-template, edit>> the content of your template.

[#search-template]
=== Searching for a template

In order to search for specific templates, enter a search term in the search fields. You can enter multiple search terms into the search fields at once. This makes your search run quicker and more accurate.

[.instruction]
Searching for a template:

. Go to *CRM » EmailBuilder*.
* *_Alternative 1:_* Enter a value in the search field and select the appropriate filter from the suggestion list. *_Example:_* If you enter a number, the possible filters with this ID will be suggested such as for example the template ID.
* *_Alternative 2:_* Click on material:tune[] to narrow down the search results with filters.
. Note the explanations about the filters in <<#table-search-template>>. +
*_Tip:_* You can enter multiple search terms into the search fields at one time. This makes your search run quicker and be more accurate.
. Click on material:search[] *Search*. +
→ The templates that correspond to the search criteria entered are shown in the overview.

[[table-search-template]]
.Available filters for the template search
[cols="1,3"]
|====
|Filter |Explanation

| *ID*
|Enter an ID to search for the template with this exact ID.

| *Language*
|Select (material:check_box[role=skyBlue]) a language from the drop-down list to only search for templates that were created in this language. You can select one or multiple languages.

| *Name*
|Enter a name to search for templates with this name. +
*_Note:_* If you have already created “old” templates in the past in the *Setup » Client » [Select client] » Email » Templates* menu, you can use this field to search for the ID of the old template. During the migration, the old ID of the template has been written in brackets behind the name.

| *Client*
|Select (material:check_box[role=skyBlue]) a client from the drop-down list to only search for templates that were created for this client.

| *Type*
|Select (material:check_box[role=skyBlue]) a type from the drop-down list to only search for templates with this template type. You can select one or multiple types. +
Available options: *Template*, *Header*, *Footer*.

| *Owner*
|Select (material:check_box[role=skyBlue]) an owner from the drop-down list to only search for templates that were created for this owner.

| material:replay[]
|Resets the selected filter criteria.

| material:search[] *SEARCH*
|Starts the search. → The templates that correspond to the search criteria are displayed. +
*_Tip:_* Don’t choose any filters if you want to see all of the templates in the overview.

|====

[#move-template]
=== Moving a template

You can move your templates to another folder at any time. To do so, proceed as described below.

[.instruction]
Moving a template:

. Go to *CRM » EmailBuilder*.
. Expand the folder (material:chevron_right[]) that contains the template you want to move.
. In the line of the template, click on material:more_vert[] and then on material:open_with[] *Move*. +
→ The *Move* window opens.
. Select the target folder.
. Click on material:open_with[] *Move*. +
→ The template is moved to the selected folder.

[#edit-template]
=== Editing a template

The following instruction describes how to edit templates in general. The procedure is thus identical for editing all templates, i.e. also editing the templates that you created for the header and the footer.

[TIP]
.Switching between multiple templates
====
If you later edit multiple templates in the editor at the same time, you can use the navigation on the left to switch between the individual templates. The template you have just opened is highlighted in blue at the beginning of the line.
====

[.instruction]
Editing a template:

. Go to *CRM » EmailBuilder*.
. Expand the folder (material:chevron_right[]) that contains the template you want to edit.
. Click on the template.
. Carry out the changes. Note <<#table-emailbuilder-create-template>>.
. *Save* (material:save[]) the settings.

Besides the language settings where you can select static attachments for your template, for example, you can also adjust the template’s content or the subject by clicking on material:edit[] in the *Content and subject* line.

In the *General settings* area of the template, select an owner, the client and the header and footer, if not done already. In this area, you can also select up to 4 dynamic attachments and fill the fields *Reply to*, *CC* and *BCC*.

[#adjust-subject]
=== Adjusting the template’s subject

As soon as the template is created, you can see the template’s language in the toolbar. Simply click in the line of the subject to adjust it. Click on material:integration_instructions[] (*Show variables*) at the end of the subject line to open the variable list. You can either search for the desired variable using the categories and sub-categories or you enter the variable’s name into the search field. When you click on the desired variable, the corresponding twig expression including the double curly brackets will be inserted in the subject line.

[#static-attachments-and-styling]
=== Selecting static attachments and adjusting the template’s styling

In the *Language settings* area, you can select up to 3 static attachments that you can attach to your email template. Also in this area, you can adjust the xref:crm:emailbuilder.adoc#examples-custom-styles[custom styles] of the template such as the template width and font size and define the <<#intable-template-settings-number-format, number format>>, <<#intable-template-settings-date-format, date format>> and <<#intable-template-settings-time-format, time format>> for your templates.

[#add-language]
=== Adding a language to the template

[[image-emailbuilder-add-languages]]
.Adding languages to a template
image::crm:emailbuilder-new-language.png[width=640, height=360]

You can add the following languages to your template, your header and your footer:

* All
** Select *All* if you use your company logo in the header only and therefore don’t need to take into account any content-related adjustments or a translation to another language.
* German
* English
* Bulgarian
* French
* Italian
* Spanish
* Turkish
* Dutch
* Polish
* Portuguese
* Norwegian
* Romanian
* Danish
* Swedish
* Czech
* Russian
* Slovakian
* Chinese
* Vietnamese

Let’s assume, you have created a shipping confirmation in English and added widgets and variables. Now, you want to create this shipping confirmation also in French for your French-speaking customers. The quickest way is to copy the template and adjust the translation afterwards. How to proceed in this case is described in the <<#copy-template, Copying a template>> chapter.

[IMPORTANT]
.Important: Add header and footer in the corresponding language
====
If you created a template in <<#add-language, multiple languages>>, remember to create also the header and footer in these languages and to link them with the template. Otherwise, the template cannot be sent.
====

[#copy-template]
=== Copying a template

You want to copy an existing template to save time when creating a new template with similar content? To do so, proceed as follows.

[TIP]
_Before copying the template_, carry out the settings in the <<#intable-general-template-settings, General settings>> area. The advantage of this sequence is that you also copy the settings themselves and not only the template content. Thus, you don’t need to carry out the settings for the other templates again.

[.instruction]
Copying a template:

. Go to *CRM » EmailBuilder*.
. Expand the folder (material:chevron_right[]) that contains the template you want to copy.
. In the line of the template that you want to copy, click on material:more_vert[] and then on material:content_copy[] *Copy*. +
→ A new window opens.
. Enter the subject of the copied template in the selected language.
. Select in the folder structure under *Target* the target folder that you want to use to save the template in.
. Click on material:content_copy[] *Copy*. +
→ The template is copied and opened.
. Adjust the subject.
. Now <<#edit-template, edit>> the copied template according to your needs and adjust the translation.

[#delete-template]
=== Deleting a template

Proceed as described below to delete templates. Only the assembled template will be deleted but _not_ the components contained in it such as the header and footer.

[.instruction]
Deleting a template:

. Go to *CRM » EmailBuilder*.
. Expand the folder (material:chevron_right[]) that contains the template you want to delete.
. In the line of the template that you want to delete, click on material:more_vert[] and then on material:delete[] *Delete*. +
→ A window opens and you need to confirm your decision.
. Click on material:delete[] *Delete*. +
→ The template is deleted.

[#remove-language]
=== Removing a language from the template

Proceed as described below to remove a certain language from the template.

[.instruction]
Removing a language from the template:

. Go to *CRM » EmailBuilder*.
. Expand the folder (material:chevron_right[]) that contains the template from which you want to remove a language.
. Click on the template.
. Click on material:more_vert[] and then on material:delete[] *Delete* at the top of the template’s tab whose language you want to remove. +
→ A window opens and you need to confirm your decision.
. Click on material:delete[] *Delete*. +
→ The language is removed from the template.

[#template-usage]
=== Viewing the template usage

Here, you can see with one click in which areas of your system the EmailBuilder template has been used. To do so, proceed as follows.

[.instruction]
Viewing the template usage:

. Go to *CRM » EmailBuilder*.
. Expand the folder (material:chevron_right[]) that contains the template from which you want to remove a language.
. Click on the template.
. Click at the top on material:assessment[] (*Template usage*). +
→ The *Template usage* window opens. The overview lists the location in the system in which the template has been used as well as the template’s name and whether the template is active or not.
. Use the filters (material:tune[]) *Location/Type* and *Is active* to narrow down the search results.
. Click on *Close* to close the window again.

 

[#automate-email-despatch]
== Automating the email despatch

You have multiple options in plentysystems to automate the email despatch to your customers.

* <<#automatic-email-despatch, Setting up the automatic email despatch>>
* <<#set-up-event-procedures, Setting up event procedures>>
* <<#email-despatch-to-multiple-email-addresses, Email despatch to multiple email addresses>>

[IMPORTANT]
.Viewing the template usage
====
Click on material:assessment[] within the template to open the *Template usage* window where you can see in which areas of your system the EmailBuilder template has been used. For further information, refer to this <<#template-usage, chapter>>.
====

[#automatic-email-despatch]
=== Setting up automatic emails

Set up the automatic despatch in the *Email accounts* assistant. You can find the assistant in the *Setup » Client » Global » Email accounts* menu. +
You can link different events with already <<#create-template, created>> templates in this area.

To see the available events, refer to the <<#email-automatic-despatch, Setting up the automatic despatch>> chapter.

[#set-up-event-procedures]
=== Setting up event procedures

Besides the possibility to <<#automatic-email-despatch, link events and templates>>, you can also set up event procedures in the *Setup » Orders » Events* menu. Define an event, activate one or more filters and decide which procedures your system should carry out automatically when the event occurs.

For example, you can use filters to trigger a procedure once a contact has placed a certain number of orders or has been assigned another class. The procedure could send an email that includes a coupon. For further information, refer to the xref:automation:event-procedures.adoc#[Event procedures] page.

[#email-despatch-to-multiple-email-addresses]
=== Email despatch to multiple email addresses

Go to *Setup » Orders » Events* to set up an xref:automation:event-procedures.adoc#[event procedure] that will send an email to your customers and employees when the event that you determined occurs in your plentyShop.

Add in the event procedure the procedure *Customer > Send email* and select the appropriate template as well as the recipients to send the email to multiple recipients at the same time once the selected event occurs.

The following recipients are available:

* Customer
* Warehouse
* Invoice address from order
* Invoice address from order
* Contact email business
* Contact email private
* Contact email PayPal
* available owners

You can either send the same template to all recipients or select a separate template each.

[#variables-emailbuilder]
== Available variables and twig expressions

In some of the widgets you can insert variables to create the templates you need. In the emails that are sent to your customer, the variables will then be replaced with the correct content.

Besides the variables, the tables in the <<#available-variables, Available variables>> chapter contain also the corresponding twig expressions. You need twig expressions for the subject line of your email and for the <<#intable-widget-code, code widget>> because it is not possible to use variables in there.

[#twig-introduction]
=== Twig expressions for the code widget and the subject line

Besides the variables, you can find also the twig expressions in the <<#available-variables, Available variables>> chapter. Twig expressions can be used in the code widget and in a template’s subject line.

[#twig-subject]
==== Twig expression in the subject line

If you want to use a twig expression in the template’s subject line, this expression has to be surrounded by double curly brackets.

*_Example:_* If you want to display the shipping service provider in your template’s subject, insert the corresponding twig expression in the template’s <<#adjust-subject, subject line>> as follows: `&#123;&#8288;&#123;order.formattedShipping.providerName&#125;&#8288;&#125;`.

You can find code examples for the subject line in the <<#code-examples-subject, Code examples for the subject line>> chapter.

[#twig-code-widget]
==== Twig expression in the code widget

If you use link:https://twig.symfony.com/doc/3.x/tags/if.html[if queries^] or link:https://twig.symfony.com/doc/2.x/tags/for.html[for loops^] in your code widget, for example, there is no need to insert double curly brackets in the if query itself, but in the body text. For further information about twig, refer to the link:https://twig.symfony.com/doc/3.x/[Twig documentation^].

[TIP]
.Insert appropriate twig expression via variable list
====
If you have inserted the code widget into your template and open it by clicking on icon:code[], the twig expression will be directly inserted in the code editor once you click on one of the variables from the list.
====

In the <<#code-examples-code-widget, Code examples for the code widget>> chapter, you can find some if queries and for loops that you can simply copy to your code widget.

[#available-variables]
=== Available variables

The available variables for the EmailBuilder are grouped into the following categories and sub-categories: Click on an entry in the list to be directly forwarded to the area where the variables and the corresponding twig expressions for the respective category or sub-category are listed.

* <<#variables-order, Order>>
** <<#variables-order-subscription, Subscription>>
** <<#variables-order-general, General>>
** <<#variables-order-date, Order date>>
** <<#variables-order-order-items, Order items (only for item list widget)>>
*** <<#variables-order-order-items-general, General>>
*** <<#variables-order-order-items-barcodes, Barcodes>>
*** <<#variables-order-order-items-properties, Properties>>
*** <<#variables-order-order-items-free-text-fields, Free text fields>>
*** <<#variables-order-order-items-availabilities, Availabilities>>
** <<#variables-order-bank-details-of-order, Bank details of the order>>
** <<#variables-order-order-properties, Order properties>>
** <<#variables-order-delivery-address, Delivery address>>
*** <<#variables-order-delivery-address-data, Delivery address data>>
*** <<#variables-order-delivery-address-options, Delivery address options>>
** <<#variables-order-suppliers, Suppliers>>
** <<#variables-order-invoice-address, Invoice address>>
*** <<#variables-order-invoice-address-data, Invoice address data>>
*** <<#variables-order-invoice-address-options, Invoice address options>>
** <<#variables-order-invoice-data, Invoice data>>
** <<#variables-order-shipping, Shipping>>
** <<#variables-order-payment, Payment>>

* <<#variables-contact, Contact>>
** <<#variables-contact-general, General>>
** <<#variables-contact-bank-details-of-contact, Bank details of the contact>>
** <<#variables-contact-properties, Properties>>
** <<#variables-contact-options, Contact options>>
** <<#variables-contact-delivery-address, Delivery address>>
*** <<#variables-contact-delivery-address-data, Delivery address data>>
*** <<#variables-contact-delivery-address-options, Delivery address options>>
** <<#variables-contact-invoice-address, Invoice address>>
*** <<#variables-contact-invoice-address-data, Invoice address data>>
*** <<#variables-contact-invoice-address-options, Invoice address options>>

* <<#variables-global, Global variables>>
** <<#variables-global-general, General>>
** <<#variables-global-bank-details-of-client, Bank details of the client>>
** <<#variables-global-coupons, Coupons>>
** <<#variables-global-links, Links>>
** <<#variables-global-legal-texts, Legal texts>>

* <<#variables-messenger, Messenger>>
* <<#variables-newsletter, Newsletter>>
* <<#variables-text-blocks, Text blocks>>
* <<#variables-ticket, Ticket>>

[#variables-order]
==== Variables: Order

In this category, you can find all order-relevant sub-categories.

Click on one of the following links to be forwarded directly to the corresponding sub-chapter:

* <<#variables-order-subscription, Subscription>>
* <<#variables-order-general, General>>
* <<#variables-order-date, Order date>>
* <<#variables-order-order-items, Order items (only for item list widget)>>
** <<#variables-order-order-items-general, General>>
** <<#variables-order-order-items-barcodes, Barcodes>>
** <<#variables-order-order-items-images, Images>>
** <<#variables-order-order-items-properties, Properties>>
** <<#variables-order-order-items-free-text-fields, Free text fields>>
** <<#variables-order-order-items-availabilities, Availabilities>>
* <<#variables-order-bank-details-of-order, Bank details of the order>>
* <<#variables-order-order-properties, Order properties>>
* <<#variables-order-delivery-address, Delivery address>>
** <<#variables-order-delivery-address-data, Delivery address data>>
** <<#variables-order-delivery-address-options, Delivery address options>>
* <<#variables-order-suppliers, Suppliers>>
* <<#variables-order-invoice-address, Invoice address>>
** <<#variables-order-invoice-address-data, Invoice address data>>
** <<#variables-order-invoice-address-options, Invoice address options>>
* <<#variables-order-invoice-data, Invoice data>>
* <<#variables-order-shipping, Shipping>>
* <<#variables-order-payment, Payment>>

[#variables-order-subscription]
===== Order / Subscription

[[table-variables-order-subscription]]
.Variables in the *Order / Subscription* sub-category
[cols="2,4,3,2"]
|====
|Name of the variable |Explanation |Twig expression |Name of the old variablefootnote:1[The information in this column is only relevant for you if you have already created in the *Setup » Client » Select client » Email » Templates* menu and want to know the name of the old variable. Note: This column has not yet been filled completely.]

| `End date of the subscription`
|Date when the subscription ends.
| `order.formattedSubscription.endDate`
| $SchedulerEndDate

| `Subscription ID`
|ID of the subscription. The ID is automatically assigned by the system and _cannot_ be changed.
| `order.formattedSubscription.id`
| $SchedulerID

| `Subscription interval`
|Interval of the subscription as determined in the *Setup » Orders » Subscription* menu. The interval determines the regularly recurrent times at which the items are sent to the customers. +
Possible values: *1 month*, *3 months*, *6 months*, *12 months*.
| `order.formattedSubscription.interval`
| $SchedulerInterval

| `Subscription: Number of executions`
|Number of orders that were created based on a subscription. +
*_Example:_* If the subscription was started in May 2021 with an interval of 3 months, 4 orders were created until May 2022. In this case, this variable would return the value `4` in the email template.
| `order.formattedSubscription.numberOfExecutions`
| $SchedulerExecutionCount

| `Start date of the subscription`
|Date when the subscription starts.
| `order.formattedSubscription.startDate`
| $SchedulerStartDate

| `Subscription total amount`
|
| `order.formattedSubscription.totalAmount`
| $SchedulerTotalAmount

|====

[#variables-order-general]
===== Order / General

[[table-variables-order-order-general]]
.Variables in the *Order / General* sub-category
[cols="2,4,3,2"]
|====
|Name of the variable |Explanation |Twig expression |Name of the old variablefootnote:1[]

| `Order access key`
|This is the hash to uniquely identify the order.
| `order.access_key`
|$OrderAccessKey

| `Barcode ID`
|
| `order.formattedGeneral.barcodeOrderID`
| $BarcodeOrderID

| `Plenty ID`
|The ID is automatically assigned by the system and cannot be changed. You can find the ID in the *Setup » Client » [Select client] » Settings* menu.
| `order.plentyId`
|

| `Coupon value`
|Value of the xref:orders:coupons.adoc#[coupon].
| `order.formattedGeneral.couponValue`
| $CouponValue

| `Customer wish`
|During the checkout via the online shop, the contact can enter a wish regarding the items they ordered. This wish is saved as order note in the order data.
| `order.formattedComments.customerSpecialWishes`
| $CustomerSpecialWishes


| `External order ID`
|
| `order.formattedProperties.externalOrderId`
| $ExternalOrderID

| `Flag`
|Flag that was selected in the order.
| `order.formattedProperties.flag`
| $OrderFlag

| `Order ID`
|
| `order.id`
| $OrderID

| `Order responsible`
|Returns the owner saved in the order.
| `order.formattedGeneral.ownerName`
| -

| `ID of the order type`
|ID of the order type, e.g. `1` for order, `4` for credit note and `6` for repair order. +
*_Note:_* To see the entire list of the order types and their IDs, refer to this xref:data:internal-IDs.adoc#80[page of the manual].
| `order.typeId`
| -

| `Order type name`
|Name of the order type, e.g. `Order`, `Credit note` and `Repair order`. +
*_Note:_* To see the entire list of the order types and their IDs, refer to this xref:data:internal-IDs.adoc#80[page of the manual].
| `order.formattedGeneral.orderTypeName`
| $OrderType

| `Main order ID`
|ID of the highest preceding order. Usually, this is a normal order. +
*_Example:_* In case of a credit note C1 coming from a return R1 from the order O1, the `Parent Order ID` returns the ID of R1 and `$OriginOrderID` returns the ID of O1.
| `order.formattedOriginOrder.originOrderId`
| $OriginOrderID

| `Parent order ID`
|ID of the direct preceding order +
*_Example:_* In case of a credit note, this could be the ID of the return or of the order from which the credit note was generated.
| `order.formattedOriginOrder.referenceOrderId`
| $ParentOrderID

| `Referrer`
|Name of the xref:orders:order-referrer.adoc#[order referrer] as it is saved in the *Setup » Orders » Referrers* menu.
| `order.formattedReferrer.name`
| $ReferrerName

| `Referrer ID`
|ID of the xref:orders:order-referrer.adoc#[order referrer] as it is saved in the *Setup » Orders » Referrers* menu.
| `order.formattedReferrer.id`
| $ReferrerID

| `Seller account`
|
| `order.formattedProperties.sellerAccount`
|

| `Status ID`
|ID of the xref:orders:order-statuses.adoc#[order status] as it is saved in the *Setup » Orders » Order status* menu.
| `order.statusId`
| $OrderStatusID

| `Order status`
|Name of the order status as it is saved in the *Setup » Orders » Order status* menu.
| `order.statusName`
| $OrderStatusLabel

|====

[#variables-order-order date]
===== Order / Order date

[[table-variables-order-order-date]]
.Variables in the *Order / Order date* sub-category
[cols="2,4,3,2"]
|====
|Name of the variable |Explanation |Twig expression |Name of the old variablefootnote:1[]

| `Date and time of incoming order`
|Date and time of the incoming order as saved in the order.
| `order.formattedDates.createdOnDateAndTime`
|

| `Date of the incoming order`
|Date of the incoming order as saved in the order.
| `order.formattedDates.createdOn`
| $OrderDate

| `Date of incoming payment`
|Date and time of the incoming payment as saved in the order.
| `order.formattedDates.paidOn`
| $PaymentDate

| `Invoice date`
|
| `order.formattedDocuments.invoiceDate`
| -

|====

[#variables-order-order-items]
===== Order / Order items (only for item list widget)

Click on one of the following links to be forwarded directly to the corresponding sub-chapter:

* <<#variables-order-order-items-general, General>>
* <<#variables-order-order-items-barcodes, Barcodes>>
* <<#variables-order-order-items-images, Images>>
* <<#variables-order-order-items-properties, Properties>>
* <<#variables-order-order-items-free-text-fields, Free text fields>>
* <<#variables-order-order-items-availabilities, Availabilities>>

[#variables-order-order-items-general]
====== Order / Order items (only for item list widget) / General

[[table-variables-order-order-items-general]]
.Variables in the *Order / Order items (only for item list widget) / General* sub-category
[cols="2,4,3,2"]
|====
|Name of the variable |Explanation |Twig expression |Name of the old variablefootnote:1[]

| `Attribute values`
| xref:item:attributes.adoc#[Attribute values] as they are saved in the *Setup » Item » Attributes* menu.
| `orderItem.attributeValues`
| $VariantName

| `Codes of a coupon`
|
| `orderItem.formattedVoucherCodes`
| $VoucherCodes

| `Content`
|
| `orderItem.formattedUnit.unitContent`
| $UnitString

| `Discount per order item`
|
| `orderItem.formattedAmounts.discount`
| $RebateAmount

| `External item ID`
|
| `orderItem.variation.item.external_article_id`
| $ExternalItemID

| `External token ID`
|
| `orderItem.formattedExternalTokenId`
| $TransactionID

| `External variation ID`
|
| `orderItem.variation.externalId`
| $ExternalVariationID

| `Item ID`
|ID of the xref:item:item-search.adoc#580[item]. A consecutive ID is automatically assigned by the system and cannot be changed.
| `orderItem.variation.itemId`
| $ItemID

| `URL to the item`
|Returns the URL to the item in the online shop.
| `orderItem.formattedLink`
| 

| `Item name`
|Name of the xref:item:item-search.adoc#580[item].
| `orderItem.orderItemName`
| $ItemName

| `Item number`
|
| `orderItem.variation.item.ArtNo`
| $ItemNumber

| `Order property value`
|
| `orderItem.formattedOrderProperty.value`
| $OrderItemOrderPropertyValue

| `Gross price`
|Gross price of the item.
| `orderItem.formattedAmounts.grossPrice`
| $ItemPrice

| `Item properties`
|
| `orderItem.formattedProperties.all`
| $OrderProperties

| `Item quantity`
|
| `orderItem.quantity`
| $ItemQuantity

| `Item type`
|Returns the item types as saved in the item’s *Global* tab. Possible values: Default, item set, multipack.
| `orderItem.formattedStockType`
|

| `Manufacturer name`
|Name of the xref:item:manufacturers.adoc#[manufacturer].
| `orderItem.variation.item.producer`
| $ItemProducerName

| `Model`
|Model name of the item
| `orderItem.variation.model`
| $ItemModel

| `Net price`
|Net price of the item.
| `orderItem.formattedAmounts.netPrice`
| $ItemPriceNet

| `Order characteristics`
|
| `orderItem.formattedOrderCharacteristics.all \| raw`
| -

| `Referrer`
|
| `orderItem.formattedReferrer.referrerName`
| $ItemReferrer

| `Release date`
|
| `orderItem.variation.releasedAt`
| -

| `Return comment`
|
| `orderItem.formattedReturn.comment`
| $ReturnItemComment

| `Status ID of the returned item`
|
| `orderItem.formattedReturn.statusId`
| $ReturnItemStatusID

| `Status name of the returned item`
|
| `orderItem.formattedReturn.statusLabel`
| $ReturnItemStatusLabel

| `ID of return reason`
|ID of the xref:orders:order-type-return.adoc#edit-return-reason[return reason] as it is saved in the *Setup » Orders » Order types » Returns* menu.
| `orderItem.formattedReturn.reasonId`
| $ReturnReasonID

| `Return reason`
|Name of the xref:orders:order-type-return.adoc#edit-return-reason[return reason] as it is saved in the *Setup » Orders » Order types » Returns* menu.
| `orderItem.formattedReturn.reasonLabel`
| $ReturnReasonLabel

| `Value of the return in percent`
|
| `orderItem.formattedReturn.percentage`
| $ReturnItemValuePercentage

| `Serial numbers`
|Returns all serial numbers separated by comma when these are assigned to the item.
| `orderItem.formattedSerialNumbers`
| -

| `Customs tariff number`
|
| `orderItem.variation.customsTariffNumber`
|

| `Total price (unit price x quantity)`
|
| `orderItem.formattedAmounts.totalPrice`
| -

| `Unit`
|
| `orderItem.formattedUnit.unitName`
| -

| `Unit price`
|
| `orderItem.formattedUnit.unitPrice`
|-

| `VAT rate`
|
| `orderItem.vatRate`
| $ItemVatRate

| `Variation ID`
|
| `orderItem.variation.id`
| $VariationId

| `Variation name`
|
| `orderItem.variation.name`
| $VariationName

| `Variation number`
|
| `orderItem.variation.number`
| $VariationNumber

| `Warehouse ID`
|ID of the xref:stock-management:setting-up-a-warehouse.adoc#[warehouse] as it is saved in the *Setup » Stock » Warehouse* menu.
| `orderItem.warehouseId`
| $ItemWarehouseID

| `Warehouse name`
|Name of the xref:stock-management:setting-up-a-warehouse.adoc#[warehouse] as it is saved in the *Setup » Stock » Warehouse* menu.
| `orderItem.warehouseName`
| -

|====

[#variables-order-order-items-barcodes]
====== Order / Order items (only for item list widget) / Barcodes

[[table-variables-order-order-items-barcodes]]
.Variables in the *Order / Order items (only for item list widget) / Barcodes* sub-category
[cols="2,4,3,2"]
|====
|Name of the variable |Explanation |Twig expression |Name of the old variablefootnote:1[]

| `ASIN`
|Amazon Standard Ident Number (ASIN) of the item
| `orderItem.formattedBarcodes.ASIN`
| $ItemASIN

| `GTIN`
|Global Trade Item Number (GTIN) of the item
| `orderItem.formattedBarcodes.GTIN`
| $ItemEAN

| `GTIN image`
|Returns the barcode based on the GTIN code of the item. The barcode is returned as an image. GTIN = Global Trade Item Number.
| `orderItem.formattedBarcodes.GTINImage`
| - 

| `ISBN`
|ISBN code of the item
| `orderItem.formattedBarcodes.ISBN`
| $ItemISBN

|====

[#variables-order-order-items-images]
====== Order / Order items (only for item list widget) / Images

[[table-variables-order-order-items-images]]
.Variables in the *Order / Order items (only for item list widget) / Images* sub-category
[cols="2,4,3,2"]
|====
|Name of the variable |Explanation |Twig expression |Name of the old variablefootnote:1[]

| `Variation image URL (full size)`
|Returns the URL to the variation image in full size.
| `orderItem.formattedImageUrl`
| $ItemImageURL
 
| `Item image URL (medium size)`
|Returns the URL to the variation image in medium size.
| `orderItem.formattedImageUrlSize.middle`
| -

| `Variation image URL (full size)`
|Returns the URL to the variation image in preview size.
| `orderItem.formattedImageUrlSize.preview`
| -

| `Variation image URL (second preview size)`
|Returns the URL to the variation image in second preview size.
| `orderItem.formattedImageUrlSize.secondPreview`
| -

|====

[#variables-order-order-items-properties]
====== Order / Order items (only for item list widget) / Properties

In this EmailBuilder area, all variables for which you have created properties of the *Item* area in the *Setup » Settings » Properties* menu are displayed in this area. +
For further information, refer to the xref:item:properties.adoc#500[Properties] page.

[#variables-order-order-items-free-text-fields]
====== Order / Order items (only for item list widget) / Free text fields

[[table-variables-order-order-items-free-text-fields]]
.Variables in the *Order / Order items (only for item list widget) / Free text fields* sub-category
[cols="3,4,3,1"]
|====
|Name of the variable |Explanation |Twig expression |Name of the old variablefootnote:1[]

| `Free text field 1`
| xref:item:fields.adoc#[Free text fields] for the items as they are saved in the *Setup » Item » Free text fields* menu. +
*_Example:_* `Free text field 3` displays the text that is saved in *Field 3*.
| `orderItem.variation.item.free1`
| $Free

| `Free text field 2`
|
| `orderItem.variation.item.free2`
| $Free

| `Free text field 3`
|
| `orderItem.variation.item.free3`
| $Free

| `Free text field 4`
|
| `orderItem.variation.item.free4`
| $Free

| `Free text field 5`
|
| `orderItem.variation.item.free5`
| $Free

| `Free text field 6`
|
| `orderItem.variation.item.free6`
| $Free

| `Free text field 7`
|
| `orderItem.variation.item.free7`
| $Free

| `Free text field 8`
|
| `orderItem.variation.item.free8`
| $Free

| `Free text field 9`
|
| `orderItem.variation.item.free9`
| $Free

| `Free text field 10`
|
| `orderItem.variation.item.free10`
| $Free

| `Free text field 11`
|
| `orderItem.variation.item.free11`
| $Free

| `Free text field 12`
|
| `orderItem.variation.item.free12`
| $Free

| `Free text field 13`
|
| `orderItem.variation.item.free13`
| $Free

| `Free text field 14`
|
| `orderItem.variation.item.free14`
| $Free

| `Free text field 15`
|
| `orderItem.variation.item.free15`
| $Free

| `Free text field 16`
|
| `orderItem.variation.item.free16`
| $Free

| `Free text field 17`
|
| `orderItem.variation.item.free17`
| $Free

| `Free text field 18`
|
| `orderItem.variation.item.free18`
| $Free

| `Free text field 19`
|
| `orderItem.variation.item.free19`
| $Free

| `Free text field 20`
|
| `orderItem.variation.item.free20`
| $Free

|====

[#variables-order-order-items-availabilities]
====== Order / Order items (only for item list widget) / Availabilities

[#box-usage-variables-stock]
[IMPORTANT]
.Important: Usage of variables regarding stock availability
====
Note the following explanation about the usage of variables regarding stock availability:

The variable must not be used if the stock falls below a value that leads to a change in the delivery time. The variable takes into account the value after the order was placed and _not_ at the moment the order is triggered in the shopping cart.

This statement applies to the following variables:

* Availability ID
* Availability ID physical stock
* Availability text
* Availability text physical stock
====

[[table-variables-order-order-items-availabilities]]
.Variables in the *Order / Order items (only for item list widget) / Availabilities* sub-category
[cols="2,4,3,2"]
|====
|Name of the variable |Explanation |Twig expression |Name of the old variablefootnote:1[]

| `Availability ID`
|ID of the xref:item:availability.adoc#[item availability] of the net stock as it is saved in the *Setup » Item » Availability* menu. A consecutive ID is automatically assigned by the system and cannot be changed. +
*_Important:_* Note the explanations in the box <<#box-usage-variables-stock, Usage of variables regarding stock availability>> above this table.
| `orderItem.formattedAvailability.availabilityId`
| $ItemAvailabilityID

| `Availability ID physical stock`
|ID of the item availability of the physical stock +
*_Important:_* Note the explanations in the box <<#box-usage-variables-stock, Usage of variables regarding stock availability>> above this table.
| `orderItem.formattedAvailability.availabilityPhysicalStockId`
| $ItemAvailabilityPhysicalStockID

| `Availability text`
|Name of the item availability of the net stock +
*_Important:_* Note the explanations in the box <<#box-usage-variables-stock, Usage of variables regarding stock availability>> above this table.
| `orderItem.formattedAvailability.availabilityName`
| $ItemAvailabilityLabel

| `Availability text physical stock`
|Name of the item availability of the physical stock +
*_Important:_* Note the explanations in the box <<#box-usage-variables-stock, Usage of variables regarding stock availability>> above this table.
| `orderItem.formattedAvailability.availabilityPhysicalStockName`
| $ItemAvailabilityPhysicalStockLabel

|====

[#variables-order-bank-details-of-order]
===== Order / Bank details of the order

[[table-variables-order-bank-details-of-order]]
.Variables in the sub-category *Order / Bank details of the order*
[cols="1,2,3"]
|====
|Name of the variable |Explanation |Twig expression 

| `Account holder`
|Name of the account holder as saved in the *Bank details* area of the order.
| `order.formattedBankData.accountHolder`

| `Account number`
|Account number as saved in the *Bank details* area of the order.
| `order.formattedBankData.accountNumber`

| `BIC`
|BIC as saved in the *Bank details* area of the order.
| `order.formattedBankData.bic`

| `Bank code`
|Bank code as saved in the *Bank details* area of the order.
| `order.formattedBankData.bankCode`

| `Country of the bank`
|Country of the bank as saved in the *Bank details* area of the order.
| `order.formattedBankData.bankCountry`

| `Bank name`
|Name of the bank as saved in the *Bank details* area of the order.
| `order.formattedBankData.bankName`

| `Postcode and town of the bank`
|Postcode and town of the bank as saved in the *Bank details* area of the order.
| `order.formattedBankData.bankPostalCodeTown`

| `Street of the bank`
|Street of the bank as saved in the *Bank details* area of the order.
| `order.formattedBankData.bankStreet`

| `IBAN`
|IBAN of the bank as saved in the *Bank details* area of the order.
| `order.formattedBankData.iban`

| `SEPA direct debit mandate`
|SEPA direct debit mandate as saved in the *Bank details* area of the order.
| `order.formattedBankData.SEPA`

| `SEPA direct debit mandate granted on`
|Date when the SEPA direct debit mandate was granted. Is saved in the *Bank details* area of the order.
| `order.formattedBankData.SEPADate`

| `SEPA type of mandate`
|SEPA type as saved in the *Bank details* area of the order.
| `order.formattedBankData.SEPADirectDebitMethod`

| `SEPA payment frequency`
|SEPA payment frequency as saved in the *Bank details* area of the order.
| `order.formattedBankData.SEPAFrequency`

| `SEPA type`
|SEPA type as saved in the *Bank details* area of the order.
| `order.formattedBankData.SEPADirectDebitType`

|====

[#variables-order-order-properties]
===== Order / Order properties

In this area of the EmailBuilder, all variables of all order-related properties are shown.

 
 

[#variables-order-delivery-address]
===== Order / Delivery address

Click on one of the following links to be forwarded directly to the corresponding sub-chapter:

* <<#variables-order-delivery-address-data, Delivery address data>>
* <<#variables-order-delivery-address-options, Delivery address options>>

[#variables-order-delivery-address-data]
====== Order / Delivery address / Delivery address data

[[table-variables-order-delivery-address-data]]
.Variables in the *Order / Delivery address / Delivery address data* sub-category
[cols="1,3,2"]
|====
|Name of the variable |Twig expression |Name of the old variablefootnote:1[]

| `Delivery address Additional address information`
| `order.formattedAddresses.deliveryAddress.address3`
| $DeliveryAddressAdditionalAddress

| `Delivery address Company name`
| `order.formattedAddresses.deliveryAddress.name1`
| $DeliveryAddressCompany

| `Delivery address Country`
| `order.formattedAddresses.deliveryAddress.country.name`
| $CustomerCountry

| `Delivery address Country ID`
| `order.formattedAddresses.deliveryAddress.country.id`
| $CustomerCountryID

| `Delivery address Country ISO code 2`
| `order.formattedAddresses.deliveryAddress.country.isoCode2`
| $CustomerCountryIsoCode

| `Delivery address Country ISO code 3`
| `order.formattedAddresses.deliveryAddress.country.isoCode3`
| $CustomerCountryIsoCode

| `Delivery address First name`
| `order.formattedAddresses.deliveryAddress.name2`
| $DeliveryAddressFirstName

| `Delivery address First name and last name`
| `order.formattedAddresses.deliveryAddress.name2 ~ ' ' ~ order.formattedAddresses.deliveryAddress.name3`
| $DeliveryAddressFullName

| `Delivery address House number`
| `order.formattedAddresses.deliveryAddress.address2`
|

| `Delivery address Last name`
| `order.formattedAddresses.deliveryAddress.name3`
| $DeliveryAddressLastName

| `Delivery address Post number`
| `order.formattedAddresses.deliveryAddress.formattedOptions.postNumber`
| -

| `Delivery address Postcode`
| `order.formattedAddresses.deliveryAddress.postalCode`
| $DeliveryAddressZip

| `Delivery address Postcode and town`
| `order.formattedAddresses.deliveryAddress.postalCode ~ ' ' ~ order.formattedAddresses.deliveryAddress.town`
|

| `Delivery address State`
| `order.formattedAddresses.deliveryAddress.state.name`
| $DeliveryAddressState

| `Delivery address Street`
| `order.formattedAddresses.deliveryAddress.address1`
| $DeliveryAddressStreet

| `Delivery address Town`
| `order.formattedAddresses.deliveryAddress.town`
| $DeliveryAddressCity

|====

[#variables-order-delivery-address-options]
====== Order / Delivery address / Delivery address options

[[table-variables-order-delivery-address-options]]
.Variables in the *Order / Delivery address / Delivery address options* sub-category
[cols="1,3,2"]
|====
|Name of the variable |Twig expression |Name of the old variablefootnote:1[]

| `Delivery address Contact person`
| `order.formattedAddresses.deliveryAddress.formattedOptions.contactPerson`
| $DeliveryAddressContactPerson

| `Delivery address Email`
| `order.formattedAddresses.deliveryAddress.formattedOptions.email`
| -

| `Delivery address Telephone`
| `order.formattedAddresses.deliveryAddress.formattedOptions.telephone`
| -

| `Delivery address VAT number`
|VAT number from the delivery address as saved in the order.
| `order.formattedAddresses.deliveryAddress.formattedOptions.VATNumber`
| $OrderDeliveryAddressTaxId

|====

[#variables-order-suppliers]
===== Order / Suppliers

[[table-variables-order-suppliers]]
.Variables in the *Order / Suppliers* sub-category
[cols="2,4,3,2"]
|====
|Name of the variable |Explanation |Twig expression |Name of the old variablefootnote:1[]

| `Order warehouse ID`
|
| `order.formattedProperties.warehouse`
| $WarehouseID

| `Order warehouse name`
|
| `order.formattedProperties.warehouseName`
| -

| `Reorder ID`
|ID of the xref:stock-management:working-with-reorders.adoc#[reorder].
| `order.formattedReorder.id`
| $ReorderID

|====

[#variables-order-invoice-address]
===== Order / Invoice address

Click on one of the following links to be forwarded directly to the corresponding sub-chapter:

* <<#variables-order-invoice-address-data, Invoice address data>>
* <<#variables-order-invoice-address-options, Invoice address options>>

[#variables-order-invoice-address-data]
====== Order / Invoice address / Invoice address data

[[table-variables-order-invoice-address-data]]
.Variables in the *Order / Invoice address / Invoice address data* sub-category
[cols="1,3,2"]
|====
|Name of the variable |Twig expression |Name of the old variablefootnote:1[]

| `Invoice address Additional address information`
| `order.formattedAddresses.invoiceAddress.address3`
| $BillingAddressAdditionalAddress

| `Invoice address Company name`
| `order.formattedAddresses.invoiceAddress.name1`
| $BillingAddressCompany

| `Invoice address Country`
| `order.formattedAddresses.invoiceAddress.country.name`
|

| `Invoice address Country ID`
| `order.formattedAddresses.invoiceAddress.country.id`
|

| `Invoice address Country ISO code 2`
| `order.formattedAddresses.invoiceAddress.country.isoCode2`
| $CustomerCountryIsoCode

| `Invoice address Country ISO code 3`
| `order.formattedAddresses.invoiceAddress.country.isoCode3`
| $CustomerCountryIsoCode

| `Invoice address First name`
| `order.formattedAddresses.invoiceAddress.name2`
| $BillingAddressFirstName

| `Invoice address First name and last name`
| `order.formattedAddresses.invoiceAddress.name2 ~ ' ' ~ order.formattedAddresses.invoiceAddress.name3`
| $BillingAddressFullName

| `Invoice address House number`
| `order.formattedAddresses.invoiceAddress.address2`
|

| `Invoice address Last name`
| `order.formattedAddresses.invoiceAddress.name3`
| $BillingAddressLastName

| `Invoice address Postcode`
| `order.formattedAddresses.invoiceAddress.postalCode`
|

| `Invoice address Postcode and town`
| `order.formattedAddresses.invoiceAddress.postalCode ~ ' ' ~ order.formattedAddresses.invoiceAddress.town`
|

| `Invoice address State`
| `order.formattedAddresses.invoiceAddress.state.name`
| $CustomerState

| `Invoice address Street`
| `order.formattedAddresses.invoiceAddress.address1`
|

| `Invoice address Town`
| `order.formattedAddresses.invoiceAddress.town`
|

|====

[#variables-order-invoice-address-options]
====== Order / Invoice address / Invoice address options

[[table-variables-order-invoice-address-options]]
.Variables in the *Order / Invoice address / Invoice address options* sub-category
[cols="2,4,3,2"]
|====
|Name of the variable |Explanation |Twig expression |Name of the old variablefootnote:1[]

| `Invoice address Contact person`
|Contact person from the invoice address as saved in the order.
| `order.formattedAddresses.invoiceAddress.formattedOptions.contactPerson`
| $BillingAddressContactPerson

| `Invoice address Email`
|Email address from the invoice address as saved in the order.
| `order.formattedAddresses.invoiceAddress.formattedOptions.email`
| - 

| `Invoice address Telephone`
|Phone number from the invoice address as saved in the order.
| `order.formattedAddresses.invoiceAddress.formattedOptions.telephone`
| - 

| `Invoice address Post number`
|Post number from the invoice address as saved in the order.
| `order.formattedAddresses.invoiceAddress.formattedOptions.postNumber`
| -

| `Invoice address VAT number`
|VAT number from the invoice address as saved in the order.
| `order.formattedAddresses.invoiceAddress.formattedOptions.VATNumber`
| $OrderBillingAddressTaxId

|====

[#variables-order-invoice-data]
===== Order / Invoice data

[[table-variables-order-invoice-data]]
.Variables in the *Order / Invoice data* sub-category
[cols="2,4,3,2"]
|====
|Name of the variable |Explanation |Twig expression |Name of the old variablefootnote:1[]

| `Currency code`
|Currency code, e.g. *EUR* or *USD*.
| `order.formattedSubtotals.currencyCode`
| $Currency

| `Currency symbol`
|Currency symbol, e.g. *€* or *$*.
| `order.formattedSubtotals.currencySymbol`
| $Currency

| `Invoice number ID`
|
| `order.formattedDocuments.invoice`
| -

| `Total invoice amount, net`
|
| `order.formattedGeneral.invoiceTotalNet`
| $InvoiceTotalNet

| `Net total order`
|
| `order.formattedGeneral.totalNet`
| $OrderTotalNet

| `Open amount`
|
| `order.formattedGeneral.openAmount`
| $OpenAmount

| `Overpaid amount`
|
| `order.formattedGeneral.overpaidAmount`
| $OverpaidAmount

| `Amount paid`
|
| `order.formattedGeneral.paidAmount`
| $PaidAmount

| `Total discount (gross)`
|
| `order.formattedSubtotals.totalDiscountGross`
| -

| `Total discount (net)`
|
| `order.formattedSubtotals.totalDiscountNet`
| -

| `Total invoice amount`
|
| `order.formattedGeneral.invoiceTotal`
| $InvoiceTotal

| `VAT total`
|
| `order.formattedGeneral.totalVat`
| $TotalVAT

| `Value of the item`
|
| `order.formattedGeneral.valueOfItems`
| $ValueOfItems

| `Value of items (gross)`
|
| `order.formattedSubtotals.subtotalPriceGross`
| -

| `Value of items (net)`
|
| `order.formattedSubtotals.subtotalPriceNet`
| -

|====

[#variables-order-shipping]
===== Order / Shipping

[[table-variables-order-shipping]]
.Variables in the *Order / Shipping* sub-category
[cols="2,4,3,2"]
|====
|Name of the variable |Explanation |Twig expression |Name of the old variablefootnote:1[]

| `DHL Retoure Online QR code URL`
|Sends your customers a QR code for xref:fulfilment:plugin-dhl-retoure-online.adoc#[DHL Retoure Online]. The QR code is shown as an URL in the email of your customers. After clicking on the URL, the QR code appears in a separate window. +
If your customers want to send back an item, they have to show the QR code on their smartphone to one of the employees in the post office and they will print the return label and attach it to the parcel.   Thus, your customers do no longer need a printer at home and you do no longer have to send the return label attached as PDF. +
| `order.formattedGeneral.DHLRetoureOnlineQRCodeURLNew \| raw`
| $DHLRetoureOnlineQRCodeURL

| `DHL Retoure Online QR code image`
|Sends your customers a QR code for xref:fulfilment:plugin-dhl-retoure-online.adoc#[DHL Retoure Online]. The QR code is shown as an image in the email of your customers. +
If your customers want to send back an item, they have to show the QR code on their smartphone to one of the employees in the post office and they will print the return label and attach it to the parcel.   Thus, your customers do no longer need a printer at home and you do no longer have to send the return label attached as PDF. +
| `order.formattedGeneral.DHLRetoureOnlineQRCodeImage \| raw`
| -

| `Delivery note ID`
|ID of the xref:orders:generating-delivery-notes.adoc#[delivery note].
| `order.formattedDocuments.deliveryNote`
| -

| `Estimated delivery date`
|
| `order.formattedDates.estimatedDeliveryDate`
| $OrderEstimatedDeliveryDate

| `Estimated shipping date`
|
| `order.formattedDates.estimatedShippingDate`
| $OrderEstimatedShipmentDate

| `Number of packages`
|Shows the number of packages contained in the order.
| `order.package`
| -

| `Package number list`
|Package numbers/tracking numbers are saved at the order after the order was successfully registered with the shipping service provider.
| `order.formattedShipping.packageNumberList`
|$PackageCount

| `Package weight`
|Package weight and unit as saved in the *Orders » Shipping centre* menu in the *Shipping packages* area.
| `order.formattedShipping.packageWeight`
| -

| `Possible delivery date`
|
| `order.formattedDates.earliestDeliveryDate`
| $OrderEarliestDeliveryDate

| `Reorder Delivery date`
|
| `order.formattedReorder.estimatedDeliveryDate`
| $ReorderDeliveryDate

| `Date when the return was received`
|
| `order.formattedDates.returnDate`
| $OrderReturnDate

| `Return package number`
|
| `order.returns_code`
| $ReturnsCode

| `Shipping costs (gross)`
|
| `order.formattedSubtotals.shippingCostsGross`
| $ShippingCosts

| `Shipping costs (net)`
|
| `order.formattedSubtotals.shippingCostsNet`
| -

| `Shipping profile`
| Name of the xref:fulfilment:preparing-the-shipment.adoc#1000[shipping profile] as it is saved in the *Setup » Orders » Shipping » Settings* menu in the *Shipping profiles* tab.
| `order.formattedShipping.profileName`
| $ShippingProfileName

| `Shipping profile ID`
|Is automatically saved by the system. You can find the ID of the xref:fulfilment:preparing-the-shipment.adoc#1000[shipping profile] in the *Setup » Orders » Shipping » Settings* menu in the *Shipping profiles* tab.
| `order.formattedShipping.profileId`
| $ShippingProfileID

| `Shipping service provider`
|Name of the xref:fulfilment:preparing-the-shipment.adoc#800[shipping service provider] as it is saved in the *Setup » Orders » Shipping » Settings* menu in the *Shipping service provider* tab.
| `order.formattedShipping.providerName`
| $ShippingServiceProviderName

| `Shipping service provider ID`
|Is automatically saved by the system. You can find the ID of the xref:fulfilment:preparing-the-shipment.adoc#800[shipping service provider] in the *Setup » Orders » Shipping » Settings* menu in the *Shipping service provider* tab.
| `order.formattedShipping.providerId`
| $ShippingServiceProviderID

| `Tracking URL`
|Returns the link to the website of the shipping service provider that is used to track the shipment. The xref:fulfilment:preparing-the-shipment.adoc#840[tracking URL] of the shipping service provider is saved in the *Setup » Orders » Shipping » Settings* menu in the *Shipping service provider* tab. +
*_Note:_* Have a look at our xref:crm:practical-example-send-tracking-url.adoc#[practical example about this topic.] Learn which settings you need to carry out to the send the tracking URL to your customers.
| `order.formattedShipping.trackingURL \| raw`
| $TrackingURL

|====

[#variables-order-payment]
===== Order / Payment

[[table-variables-order-payment]]
.Variables in the *Order / Shipping* sub-category
[cols="2,4,3,2"]
|====
|Name of the variable |Explanation |Twig expression |Name of the old variablefootnote:1[]

| `PayPal Link`
| Returns the link to the PayPal payment page.
| `order.formattedGeneral.paypalVariables.link \| raw`
| -

| `PayPal Link button`
|Returns the image with an integrated link to the PayPal payment page.
| `order.formattedGeneral.paypalVariables.linkButton \| raw`
| -

| `Payment due date`
|
| `order.formattedDates.paymentDueDate`
| 

| `Payment method (back end)`
|
| `order.formattedGeneral.methodOfPaymentName`
| $MethodOfPaymentName

| `Payment method (front end)`
|
| `order.formattedGeneral.methodOfPaymentNameFrontend`
| -

| `Payment method ID`
|The ID is automatically assigned by the system. The IDs of the xref:payment:managing-payment-methods.adoc#65[payment methods] are listed in the *Setup » Orders » Payment » Payment methods* menu.
| `order.formattedProperties.paymentMethod`
| $MethodOfPaymentID

| `Transaction ID of the payment`
|
| `order.formattedGeneral.paymentTransactionId`
| -

| `eBay payment ID`
|
| `order.formattedProperties.ebayUniquePaymentID`
| $EbayUniquePaymentID

|====

[#variables-contact]
==== Variables: Contact

In this category, you can find all contact-relevant sub-categories.

Click on one of the following links to be forwarded directly to the corresponding sub-chapter:

* <<#variables-contact-general, General>>
* <<#variables-contact-bank-details-of-contact, Bank details of the contact>>
* <<#variables-contact-properties, Properties>>
* <<#variables-contact-options, Contact options>>
* <<#variables-contact-delivery-address, Delivery address>>
<<#variables-contact-delivery-address-data, Delivery address data>>
** <<#variables-contact-delivery-address-options, Delivery address options>>
* <<#variables-contact-invoice-address, Invoice address>>
** <<#variables-contact-invoice-address-data, Invoice address data>>
** <<#variables-contact-invoice-address-options, Invoice address options>>

[#variables-contact-general]
===== Contact / General

[[table-variables-contact]]
.Variables in the *Contact / General* sub-category
[cols="2,4,3,2"]
|====
|Name of the variable |Explanation |Twig expression |Name of the old variablefootnote:1[]

| `Class`
| Class that is assigned to the contact. xref:crm:preparatory-settings.adoc#create-customer-class[Classes] are created in the *Setup » CRM » Classes* menu.
| `contact.formattedClass.name`
| $CustomerClass

| `Company name`
|Name of the xref:crm:edit-contact.adoc#company[company].
| `contact.formattedAccounts.companyName`
| $CustomerCompany

| `External ID`
|Returns the external number saved in the contact details.
| `contact.externalId`
| -

| `Contact ID`
|ID of the xref:crm:edit-contact.adoc#[contact]. A consecutive ID is automatically assigned by the system and cannot be changed.
| `contact.id`
| $CustomerID

| `Customer sign`
|
| `order.formattedProperties.customerSign`
| $CustomerSign

| `First name`
|
| `contact.firstName`
| $CustomerFirstName

| `First and last name of the system user`
|First name and last name of the system user who is saved as xref:crm:edit-contact.adoc#contact-details[owner] in the contact data record.
| `contact.formattedUser.realName`
|

| `Full name`
|
| `contact.fullName`
| $CustomerFullName

| `Gender`
|If gender is male, *male* is shown. +
If gender is female, *female* is shown. +
If gender is diverse, an empty option is shown.
| `contact.gender is same as ('diverse') ? '' : contact.gender`
|

| `Language`
|Language as saved in the contact data record. If you created an email template in the selected language, the email templates are sent to the contact in this language.
| `contact.lang`
| $CustomerLang

| `Last name`
|
| `contact.lastName`
| $CustomerLastName

| `Newsletter: Confirmation by contact`
|Date when the contact has confirmed the newsletter receipt. +
Date format in the email: `mm-dd-yyyy`. +
In the contact data record, the timestamp in the format `00:00:00` is also saved in addition to the date in the format `dd-mm-yyyy`.
| `contact.newsletterAllowanceAt`
| $IsNewsletterActive

| `Number`
|Additional number for the contact.
| `contact.number`
| $CustomerNumber

| `Number of orders`
|
| `contact.formattedOrdersCount`
| $OrderCount

| `Salutation business`
|
| `contact.formattedOptions.salutationWork`
| $CustomerSalutationLabel

| `Form of address`
|
| `contact.formattedSalutation.label`
| $CustomerSalutationKey

| `Salutation private`
|
| `contact.formattedOptions.salutationPrivate`
| $CustomerSalutationLabel

| `Signature of the system user`
|First name and last name of the system user who is saved as xref:crm:edit-contact.adoc#contact-details[owner] in the contact data record.
| `contact.formattedUser.signatureNoHtml`
| $ContactOwnerSignature

| `Signature of the system user in HTML format`
|First name and last name of the system user who is saved as xref:crm:edit-contact.adoc#contact-details[owner] in the contact data record, in HTML format.
| `contact.formattedUser.signatureHtml`
| $ContactOwnerSignatureHtml

| `Title`
|
| `contact.title`
| $CustomerTitle

|====

[#variables-contact-bank-details-of-contact]
===== Contact / Bank details of the contact

[[table-variables-contact-bank-details-of-contact]]
.Variables in the *Order / Bank details of the contact* sub-category
[cols="2,4,3,2"]
|====
|Name of the variable |Explanation |Twig expression |Name of the old variablefootnote:1[]

| `Account holder (contact)`
| xref:crm:edit-contact.adoc#bank-details[Account owner] as saved in the contact data record.
| `contact.formattedBanks.accountOwner`
|

| `BIC of the contact`
| xref:crm:edit-contact.adoc#bank-details[BIC] as saved in the contact data record.
| `contact.formattedBanks.bic`
| $CustomerBIC

| `Bank name of the contact`
| xref:crm:edit-contact.adoc#bank-details[Bank name] as saved in the contact data record.
| `contact.formattedBanks.bankName`
| $CustomerBankName

| `IBAN of the contact`
|IBAN as saved in the contact data record.
| `contact.formattedBanks.iban`
| $CustomerIBAN

|====

[#variables-contact-delivery-address]
===== Contact / Delivery address

Click on one of the following links to be forwarded directly to the corresponding sub-chapter:

* <<#variables-contact-delivery-address-data, Delivery address data>>
* <<#variables-contact-delivery-address-options, Delivery address options>>

[#variables-contact-delivery-address-data]
====== Contact / Delivery address / Delivery address data

[[table-variables-contact-delivery-address-data]]
.Variables in the *Contact / Delivery address / Delivery address data* sub-category
[cols="1,3,2"]
|====
|Name of the variable |Twig expression |Name of the old variablefootnote:1[]

| `Delivery address Additional address information`
| `contact.formattedAddresses.deliveryAddress.address3 ~ ' ' ~ contact.formattedAddresses.deliveryAddress.address4`
| $DeliveryAddressAdditionalAddress

| `Delivery address Company name`
| `contact.formattedAddresses.deliveryAddress.name1`
| $DeliveryAddressCompany

| `Delivery address Country`
| `contact.formattedAddresses.deliveryAddress.country.name`
| $DeliveryAddressCountry

| `Delivery address Country ID`
| `contact.formattedAddresses.deliveryAddress.country.id`
| $DeliveryAddressCountryID

| `Delivery address Country ISO code 2`
| `contact.formattedAddresses.deliveryAddress.country.isoCode2`
| $DeliveryAddressCountryIsoCode

| `Delivery address Country ISO code 3`
| `contact.formattedAddresses.deliveryAddress.country.isoCode3`
| $DeliveryAddressCountryIsoCode

| `Delivery address First name`
| `contact.formattedAddresses.deliveryAddress.name2`
| $DeliveryAddressFirstName

| `Delivery address First name and last name`
| `contact.formattedAddresses.deliveryAddress.name2 ~ ' ' ~ contact.formattedAddresses.deliveryAddress.name3`
| $DeliveryAddressFullName

| `Delivery address House number`
| `contact.formattedAddresses.deliveryAddress.address2`
|

| `Delivery address Last name`
| `contact.formattedAddresses.deliveryAddress.name3`
| $DeliveryAddressLastName

| `Delivery address Telephone`
| `contact.formattedAddresses.deliveryAddress.formattedOptions.telephone`
| $DeliveryAddressPhone

| `Delivery address Postcode`
| `contact.formattedAddresses.deliveryAddress.postalCode`
| $DeliveryAddressZip

| `Delivery address Postcode and town`
| `contact.formattedAddresses.deliveryAddress.postalCode ~ ' ' ~ contact.formattedAddresses.deliveryAddress.town`
| $DeliveryAddressCityWithZip

| `Delivery address State`
| `contact.formattedAddresses.deliveryAddress.state.name`
| $DeliveryAddressState

| `Delivery address Street`
| `contact.formattedAddresses.deliveryAddress.address1 ~ ' ' ~ contact.formattedAddresses.deliveryAddress.address2`
| $DeliveryAddressStreet

| `Delivery address Town`
| `contact.formattedAddresses.deliveryAddress.town`
| $DeliveryAddressCity

|====

[#variables-contact-delivery-address-options]
====== Contact / Delivery address / Delivery address options

[TIP]
*_Note:_* If it’s a reorder, some of the following variables for the address options in the delivery address are not shown in the email to your customers. This is because the addresses that are saved for a supplier are not taken into account because you can save suppliers without an address in your system.

[[table-variables-contact-delivery-adress-options]]
.Variables in the *Contact / Delivery address / Delivery address options* sub-category
[cols="1,2,3"]
|====
|Name of the variable |Explanation |Twig expression

| `Delivery address Age rating`
|Age rating from the delivery address as saved in the *Address > Address options* area of the contact data record.
| `contact.formattedAddresses.deliveryAddress.formattedOptions.BBFC`

| `Delivery address Birthday`
|Birthday from the delivery address as saved in the *Address / Address options* area of the contact data record.
| `contact.formattedAddresses.deliveryAddress.formattedOptions.birthday`

| `Delivery address Contact person`
|Contact person from the delivery address as saved in the *Address / Address options* area of the contact data record.
| `contact.formattedAddresses.deliveryAddress.formattedOptions.contactPerson`

| `Delivery address Email`
|Email address from the delivery address as saved in the *Address / Address options* area of the contact data record.
| `contact.formattedAddresses.deliveryAddress.formattedOptions.email`

| `Delivery address Entry certificate`
|Entry certificate from the delivery address as saved in the *Address / Address options* area of the contact data record.
| `contact.formattedAddresses.deliveryAddress.formattedOptions.entryCertificate`

| `Delivery address External address ID`
|External address ID from the delivery address as saved in the *Address / Address options* area of the contact data record.
| `contact.formattedAddresses.deliveryAddress.formattedOptions.externalAddressID`

| `Delivery address External customer ID`
|External customer ID from the delivery address as saved in the *Address / Address options* area of the contact data record.
| `contact.formattedAddresses.deliveryAddress.formattedOptions.externalCustomerID`

| `Delivery address Personal number`
|Personal number from the delivery address as saved in the *Address / Address options* area of the contact data record.
| `contact.formattedAddresses.deliveryAddress.formattedOptions.personalId`

| `Delivery address Telephone`
|Phone number from the delivery address as saved in the *Address / Address options* area of the contact data record.
| `contact.formattedAddresses.deliveryAddress.formattedOptions.telephone`

| `Delivery address Post number`
|Post number from the delivery address as saved in the *Address / Address options* area of the contact data record.
| `contact.formattedAddresses.deliveryAddress.formattedOptions.postNumber`

| `Delivery address Title`
|Title from the delivery address as saved in the *Address / Address options* area of the contact data record.
| `contact.formattedAddresses.deliveryAddress.formattedOptions.title`

| `Delivery address VAT number`
|VAT number from the delivery address as saved in the *Address / Address options* area of the contact data record.
| `contact.formattedAddresses.deliveryAddress.formattedOptions.VATNumber`

|====

[#variables-contact-invoice-address]
===== Contact / Invoice address

Click on one of the following links to be forwarded directly to the corresponding sub-chapter:

* <<#variables-contact-invoice-address-data, Invoice address data>>
* <<#variables-contact-invoice-address-options, Invoice address options>>

[#variables-contact-invoice-address-data]
====== Contact / Invoice address / Invoice address data

[[table-variables-contact-invoice-address-data]]
.Variables in the *Contact / Invoice address / Invoice address data* sub-category
[cols="1,3,2"]
|====
|Name of the variable |Twig expression |Name of the old variablefootnote:1[]

| `Invoice address Additional address information`
| `contact.formattedAddresses.invoiceAddress.address3 ~ ' ' ~ contact.formattedAddresses.invoiceAddress.address4`
|

| `Invoice address Company name`
| `contact.formattedAddresses.invoiceAddress.name1`
|

| `Invoice address Country`
| `contact.formattedAddresses.invoiceAddress.country.name`
|

| `Invoice address Country ID`
| `contact.formattedAddresses.invoiceAddress.country.id`
|

| `Invoice address Country ISO code 2`
| `contact.formattedAddresses.invoiceAddress.country.isoCode2`
|

| `Invoice address Country ISO code 3`
| `contact.formattedAddresses.invoiceAddress.country.isoCode3`
|

| `Invoice address First name`
| `contact.formattedAddresses.invoiceAddress.name2`
|

| `Invoice address First name and last name`
| `contact.formattedAddresses.invoiceAddress.name2 ~ ' ' ~ contact.formattedAddresses.invoiceAddress.name3`
|

| `Invoice address House number`
| `contact.formattedAddresses.invoiceAddress.address2`
|

| `Invoice address Last name`
| `contact.formattedAddresses.invoiceAddress.name3`
|

| `Invoice address Telephone`
| `contact.formattedAddresses.invoiceAddress.formattedOptions.telephone`
|

| `Invoice address Postcode`
| `contact.formattedAddresses.invoiceAddress.postalCode`
|

| `Invoice address Postcode and town`
| `contact.formattedAddresses.invoiceAddress.postalCode ~ ' ' ~ contact.formattedAddresses.invoiceAddress.town`
|

| `Invoice address State`
| `contact.formattedAddresses.invoiceAddress.state.name`
|

| `Invoice address Street`
| `contact.formattedAddresses.invoiceAddress.address1 ~ ' ' ~ contact.formattedAddresses.invoiceAddress.address2`
|

| `Invoice address Town`
| `contact.formattedAddresses.invoiceAddress.town`
|

|====

[#variables-contact-invoice-address-options]
====== Contact / Invoice address / Invoice address options

[TIP]
*_Note:_* If it’s a reorder, some of the following variables for the address options in the delivery address are not shown in the email to your customers. This is because the addresses that are saved for a supplier are not taken into account because you can save suppliers without an address in your system.

[[table-variables-contact-invoice-address-options]]
.Variables in the *Contact / Invoice address / Invoice address options* sub-category
[cols="1,3,2"]
|====

| `Invoice address Age rating`
|Age rating from the invoice address as saved in the *Address / Address options* area of the contact data record.
| `contact.formattedAddresses.invoiceAddress.formattedOptions.BBFC`

| `Invoice address Birthday`
|Birthday from the invoice address as saved in the *Address / Address options* area of the contact data record.
| `contact.formattedAddresses.invoiceAddress.formattedOptions.birthday`

| `Invoice address Contact person`
|Contact person from the invoice address as saved in the *Address / Address options* area of the contact data record.
| `contact.formattedAddresses.invoiceAddress.formattedOptions.contactPerson`

| `Invoice address Email`
|Email address from the invoice address as saved in the *Address / Address options* area of the contact data record.
| `contact.formattedAddresses.invoiceAddress.formattedOptions.email`

| `Invoice address Entry certificate`
|Entry certificate from the invoice address as saved in the *Address / Address options* area of the contact data record.
| `contact.formattedAddresses.invoiceAddress.formattedOptions.entryCertificate`

| `Invoice address External address ID`
|External address ID from the invoice address as saved in the *Address / Address options* area of the contact data record.
| `contact.formattedAddresses.deliveryAddress.formattedOptions.externalAddressID`

| `Invoice address External customer ID`
|External customer ID from the invoice address as saved in the *Address / Address options* area of the contact data record.
| `contact.formattedAddresses.invoiceAddress.formattedOptions.externalCustomerID`

| `Invoice address Personal number`
|Personal number from the invoice address as saved in the *Address / Address options* area of the contact data record.
| `contact.formattedAddresses.invoiceAddress.formattedOptions.personalId`

| `Invoice address Telephone`
|Phone number from the invoice address as saved in the *Address / Address options* area of the contact data record.
| `contact.formattedAddresses.invoiceAddress.formattedOptions.telephone`

| `Invoice address Post number`
|Post number from the invoice address as saved in the *Address / Address options* area of the contact data record.
| `contact.formattedAddresses.invoiceAddress.formattedOptions.postNumber`

| `Invoice address Title`
|Title from the invoice address as saved in the *Address / Address options* area of the contact data record.
| `contact.formattedAddresses.invoiceAddress.formattedOptions.title`

| `Invoice address VAT number`
|VAT number from the invoice address as saved in the *Address / Address options* area of the contact data record.
| `contact.formattedAddresses.deliveryAddress.formattedOptions.VATNumber`

|====

[#variables-contact-properties]
===== Contact / Properties

In this EmailBuilder area, all variables for which you have created properties of the *Contact* area in the *Setup » Settings » Properties* menu are displayed in this area. +
For further information, refer to the xref:item:properties.adoc#500[Properties] page.

[#variables-contact-options]
===== Contact / Contact options

[[table-variables-contact-options]]
.Variables in the *Contact / Contact options* sub-category
[cols="1,3,2"]
|====
|Name of the variable |Twig expression |Name of the old variablefootnote:1[]

| `Additional contact person`
| `contact.formattedOptions.additionalContactPerson`
| -

| `Email business`
| `contact.formattedOptions.emailWork`
| $CustomerEmail

| `PayPal email address`
| `contact.formattedOptions.emailPayPal`
| $CustomerEmail

| `Email private`
| `contact.formattedOptions.emailPrivate`
| $CustomerEmail

| `Fax business`
| `contact.formattedOptions.telefaxWork`
| $CustomerFax

| `Fax private`
| `contact.formattedOptions.telefaxPrivate`
| $CustomerFax

| `Mobile business`
| `contact.formattedOptions.telephoneMobileWork`
| $CustomerMobilePhone

| `Mobile private`
| `contact.formattedOptions.telephoneMobilePrivate`
| $CustomerMobilePhone

| `Phone business`
| `contact.formattedOptions.telephoneWork`
| $CustomerPhone

| `Phone private`
| `contact.formattedOptions.telephonePrivate`
| $CustomerPhone

| `eBay name`
| `contact.formattedOptions.marketplaceEbay`
| $CustomerEbayName

|====

[#variables-global]
==== Variables: Global

In this category, you can find all global sub-categories.

Click on one of the following links to be forwarded directly to the corresponding sub-chapter:

* <<#variables-global-general, General>>
* <<#variables-global-bank-details-of-client, Bank details of the client>>
* <<#variables-global-coupons, Coupons>>
* <<#variables-global-links, Links>>
* <<#variables-global-legal-texts, Legal texts>>

[#variables-global-general]
===== Global / General

[[table-variables-global-general]]
.Variables in the *Global variables / General* sub-category
[cols="2,4,3,2"]
|====
|Name of the variable |Explanation |Twig expression |Name of the old variablefootnote:1[]

| `Client ID`
|Returns the ID of the client (shop).
| `globals.webshopId`
| -

| `Client name`
|Shows the name of the client (shop).
| `globals.clientName`
| -

| `EORI number`
|Unique identification number that is required for customs-related procedures.
| `globals.account.EORINumber`
| -

| `Email sender`
|Returns the sender of the email.
| `globals.emailSender`
| -

| `Signature in HTML format`
|The signature is saved in the *Email accounts* assistant in the *Signature* step. You can find the assistant in the *Setup » Client » Global » Email accounts* menu.
| `globals.account.signatureHTML \| raw`
| $SignatureHTML

| `Signature in plain text`
|The signature is saved in the *Email accounts* assistant in the *Signature* step. You can find the assistant in the *Setup » Client » Global » Email accounts* menu.
| `globals.account.signatureText \| raw`
| $SignatureText

| `Today’s date`
|Returns today’s date in the format `dd-mm-yyyy`.
| `"now"\|date("d-m-Y")`
| $TodaysDate

|====

[#variables-global-bank-details-of-client]
===== Global / Bank details of the client

[[table-variables-global-bank-details-of-client]]
.Variables in the *Global variables / Bank details of the client* sub-category
[cols="2,4,3,2"]
|====
|Name of the variable |Explanation |Twig expression |Name of the old variablefootnote:1[]

| `Account holder (master data)`
|Account holder from the xref:welcome:quick-start-initial-settings.adoc#100[master data] of your system. Is saved in the *Setup » Settings » Bank* menu.
| `globals.bank.owner`
|

| `BIC (master data)`
|BIC from the xref:welcome:quick-start-initial-settings.adoc#100[master data] of your system. Is saved in the *Setup » Settings » Bank* menu.
| `globals.bank.bic`
|

| `Bank name (master data)`
|Bank name from the xref:welcome:quick-start-initial-settings.adoc#100[master data] of your system. Is saved in the *Setup » Settings » Bank* menu.
| `globals.bank.name`
| $BankName

| `IBAN (master data)`
|IBAN from the xref:welcome:quick-start-initial-settings.adoc#100[master data] of your system. Is saved in the *Setup » Settings » Bank* menu.
| `globals.bank.iban`
| $BankIBAN

|====

[#variables-global-coupons]
===== Global / Coupons

[[table-variables-global-coupons]]
.Variables in the *Global variables / Coupons* sub-category
[cols="2,4,3,2"]
|====
|Name of the variable |Explanation |Twig expression |Name of the old variablefootnote:1[]

| `Coupon code (1)`
| xref:orders:coupons.adoc#[Coupon codes] are generated in the campaign in the *Orders » Coupons* menu. A coupon code can always be assigned to only one campaign to send this coupon code from the campaign in an email template.
| `globals.coupons.couponCode1`
| $CouponCode1

| `Coupon code (2)`
|
| `globals.coupons.couponCode2`
| $CouponCode2

| `Coupon code (3)`
|
| `globals.coupons.couponCode3`
| $CouponCode3

| `Coupon code (4)`
|
| `globals.coupons.couponCode4`
| $CouponCode4

| `Coupon code (5)`
|
| `globals.coupons.couponCode5`
| $CouponCode5

| `Coupon code (6)`
|
| `globals.coupons.couponCode6`
| $CouponCode6

| `Coupon code (7)`
|
| `globals.coupons.couponCode7`
| $CouponCode7

| `Coupon code (8)`
|
| `globals.coupons.couponCode8`
| $CouponCode8

| `Coupon code (9)`
|
| `globals.coupons.couponCode9`
| $CouponCode9

| `Coupon code (10)`
|
| `globals.coupons.couponCode10`
| $CouponCode10

|====

[#variables-global-links]
===== Global / Links

[[table-variables-global-links]]
.Variables in the *Global variables / Links* sub-category
[cols="2,4,3,2"]
|====
|Name of the variable |Explanation |Twig expression |Name of the old variablefootnote:1[]

| `URL to basket`
|Returns the URL to the basket in the online shop.
| `globals.links.linkBasket`
|

| `URL to change password`
|Returns the URL for the *Change password* area in the online shop. The contact can enter a new password.
| `globals.links.linkChangePassword`
| $CustomerPassword

| `URL to order confirmation`
|Returns the URL of the order confirmation in the online shop.
| `globals.links.linkCheckout`
|

| `URL to confirm email address`
|Returns the URL to confirm the email address change of the contact.
| `globals.account.newCustomerEmail`
|$NewCustomerEmail

| `URL to new password`
|Returns the URL to a form that allows to create a new password. The contact enters their email address in this form.
| `globals.links.linkNewPassword`
|

| `URL to online shop`
|Returns the URL of the online shop.
| `globals.links.linkWebstore`
|

| `URL to Terms and Conditions`
|Returns the URL for the terms and conditions.
| `globals.links.linkTermsConditions`
|

|====

[#variables-global-legal-texts]
===== Global / Legal texts

[TIP]
.Your legal texts are not displayed correctly in sent emails?
====
If your legal texts that you inserted in the code widget as twig expressions are not displayed correctly in sent emails, add  `| raw` at the end of the twig expression to solve this problem.
====

[[table-variables-global-legal-texts]]
.Variables in the *Global variables / Legal texts* sub-category
[cols="2,4,3,2"]
|====
|Name of the variable |Explanation |Twig expression |Name of the old variablefootnote:1[]

| `Cancellation rights in HTML format`
|Go to *Setup » Client » [Select client] » Online store » Legal » [Expand language]*. Click on the *Cancellation rights* tab and save the text in the *HTML* tab.
| `globals.legalInformation.cancellationRights.html \| raw`
| $CancellationRightsHTML

| `Cancellation rights in plain text`
|Go to *Setup » Client » [Select client] » Online store » Legal » [Expand language]*. Click on the *Cancellation rights* tab and save the text in the *Text* tab.
| `globals.legalInformation.cancellationRights.plain`
| $CancellationRightsText

| `General terms and conditions in HTML format`
|Go to *Setup » Client » [Select client] » Online store » Legal » [Expand language]*. Click on the *Terms and conditions* tab and save the text in the *HTML* tab.
| `globals.legalInformation.termsConditions.html \| raw`
| - 

| `General terms and conditions in plain text`
|Go to *Setup » Client » [Select client] » Online store » Legal » [Expand language]*. Click on the *Terms and conditions* tab and save the text in the *Text* tab.
| `globals.legalInformation.termsConditions.plain`
| - 

| `Legal disclosure in HTML format`
|Go to *Setup » Client » [Select client] » Online store » Legal » [Expand language]*. Click on the *Legal disclosure* tab and save the text in the *HTML* tab.
| `globals.legalInformation.legalDisclosure.html \| raw`
| $LegalDisclosureHTML

| `Legal disclosure in plain text`
|Go to *Setup » Client » [Select client] » Online store » Legal » [Expand language]*. Click on the *Legal disclosure* tab and save the text in the *Text* tab.
| `globals.legalInformation.legalDisclosure.plain`
| $LegalDisclosureText

| `Privacy policy in HTML format`
|Go to *Setup » Client » [Select client] » Online store » Legal » [Expand language]*. Click on the *Privacy policy* tab and save the text in the *HTML* tab.
| `globals.legalInformation.privacyPolicy.html \| raw`
| $PrivacyPolicyHTML

| `Privacy policy in plain text`
|Go to *Setup » Client » [Select client] » Online store » Legal » [Expand language]*. Click on the *Privacy policy* tab and save the text in the *Text* tab.
| `globals.legalInformation.privacyPolicy.plain`
| $PrivacyPolicyText

| `Cancellation form in HTML format`
|Go to *Setup » Client » [Select client] » Online store » Legal » [Expand language]*. Click on the *Cancellation form* tab and save the text in the *HTML* tab.
| `globals.legalInformation.withdrawalForm.html \| raw`
| $WithdrawalFormHTML

| `Cancellation form in plain text`
|Go to *Setup » Client » [Select client] » Online store » Legal » [Expand language]*. Click on the *Cancellation form* and save the text in the *Text* tab.
| `globals.legalInformation.withdrawalForm.plain`
| $WithdrawalFormText

|====

[#variables-messenger]
==== Variables: Messenger

[IMPORTANT]
.Automatic mapping
====
The emails that come into your system via the Messenger are assigned according to keywords or textual parameters that are automatically recognised by your system. +
For further information about the assignment, refer to the xref:crm:messenger.adoc#assign-messages[Assigning messages in the Messenger] chapter on the xref:crm:messenger.adoc#[Messenger] user manual page.
====

[[table-variables-messenger]]
.Variables in the *Messenger* category
[cols="2,5,2"]
|====
|Name of the variable |Explanation |Twig expression

| `First message of conversation`
|Returns the text of the first message within the conversation.
| `messenger.formattedMessage.conversationFirstMessage \| raw`

| `First whispered message of conversation`
|Returns the text of the first whispered message within the conversation.
| `messenger.formattedMessage.conversationFirstWhisperedMessage \| raw`

| `Conversation history`
|
| `messenger.formattedMessage.conversationHistory \| raw`

| `Conversation ID`
|Returns the ID of the conversation.
| `messenger.uuid`

| `Last message of conversation`
|Returns the text of the last message within the conversation.
| `messenger.formattedMessage.conversationLastMessage \| raw`

| `Last whispered message of conversation`
|Returns the text of the last whispered message within the conversation.
| `messenger.formattedMessage.conversationLastWhisperedMessage \| raw`

| `Conversation short ID`
| Returns the short ID of the conversation.
| `messenger.shortId`

| `Title of conversation`
|Returns the subject of the conversation.
| `messenger.title`

|====

[#variables-newsletter]
==== Variables: Newsletter

[[table-variables-newsletter]]
.Variables in the *Newsletter* category
[cols="2,5,2,2"]
|====
|Name of the variable |Explanation |Twig expression |Name of the old variablefootnote:1[]

| `Newsletter first name`
|First name of the person who wants to subscribe for the xref:crm:sending-newsletters.adoc#[newsletter].
| `newsletter.firstName`
| -

| `Newsletter last name`
|Last name of the person who wants to subscribe for the xref:crm:sending-newsletters.adoc#[newsletter].
| `newsletter.lastName`
| -

| `URL for confirming the newsletter receipt`
|Returns the URL to confirm the xref:crm:sending-newsletters.adoc#[newsletter subscription].
| `newsletter.formattedConfirmUrl`
| $NewsletterConfirmURL

|====

[#variables-text-blocks]
==== Variables: Text blocks

In the *Text blocks* area, you can find all text blocks as variables that you have <<#create-text-block, created>> in the *CRM » EmailBuilder* menu. You can later insert the text blocks in your Messenger messages.

[#variables-ticket]
==== Variables: Ticket

[[table-variables-ticket]]
.Variables in the *Ticket* category
[cols="2,5,2,2"]
|====
|Name of the variable |Explanation |Twig expression |Name of the old variablefootnote:1[]

| `Ticket backend URL`
|Links to the ticket in the xref:crm:using-the-ticket-system.adoc#[CRM » Ticket system] menu.
| `ticket.formattedUrl.backendUrl`
| $TicketBackendURL

| `Ticket messages history`
|Returns the text that was last saved in the ticket. This is either the text of a comment or a message.
| `ticket.formattedMessage.history`
| $TicketHistory

| `Ticket ID`
|Displays the ticket ID that the email was sent from.
| `ticket.id`
| $TicketID

| `Ticket last comment`
|Returns the text of the last xref:crm:using-the-ticket-system.adoc#2500[comment]. +
*_Note:_* Comments serve for internal communication and are _not_ visible to your customers.
| `ticket.formattedMessage.lastComment`
| $TicketLastComment

| `Ticket last message`
|Returns the text of the last xref:crm:using-the-ticket-system.adoc#2400[message].
| `ticket.formattedMessage.lastMessage`
| $TicketLastMessage

| `Ticket priority`
|Returns the priority of the ticket as and ID. The values of the stars are shown in ascending order with numbers from `0` (grey star, lowest priority) to `5` (2 yellow stars, highest priority).
| `ticket.priorityId`
| $TicketPriority

| `Ticket status`
|Returns the status of the ticket.
| `ticket.formattedStatus`
| $TicketStatus

| `Ticket tags`
|Returns the tags of the ticket.
| `ticket.formattedTags`
| $TicketTags

| `Ticket title`
|Returns the title of the ticket.
| `ticket.title`
| $TicketTitle

| `Ticket URL`
|Links to the ticket in the *My account* area. The customer can read the message in the My account area, write an answer and send it. +
Note also the xref:crm:using-the-ticket-system.adoc#5500[Creating tickets in the My account area] chapter on the xref:crm:using-the-ticket-system.adoc#[Ticket system] page.
| `ticket.formattedUrl.url`
| $TicketURL

|====

[#code-examples-code-widget]
== Code examples for the code widget

Use if queries or for loops in your email templates to display specific information on a case-by-case basis. In the following sub-chapters, you find some if queries and for loops that you can simply copy to your <<#intable-widget-code, code widget>>.

Click on one of the following links to be forwarded directly to the corresponding sub-chapter with the code example:

* <<#code-example-shipping-profile, Shipping profile>>
* <<#code-example-bank-details, Bank details>>
* <<#code-example-order-items, Order items>>
* <<#code-example-item-list, Items of the order shown as list>>
* <<#code-example-item-list-comma-separated, Items of the order shown in one line and separated by comma>>
* <<#code-example-header-client-dependent, Show header depending on the client>>
* <<#code-example-date-format, Date format>>
* <<#code-example-number-format, Number format>>

[#code-example-shipping-profile]
=== Code example: Shipping profile

In the <<#intable-widget-code, code widget>>, insert a code that causes a note regarding the freight-forwarding company and contacting to only be displayed in the email to your customers if the shipping service provider in the shipping profile is a freight-forwarding company. In our example the shipping profile with the freight-forwarding company has the ID `6`.

[source,twig]
----
include::example$emailbuilder-code-example-shipping-profile.html[]

----

[#code-example-bank-details]
=== Code example: Bank details

In the <<#intable-widget-code, code widget>>, insert a code that causes bank details to only be displayed in the email to your customers if *Cash in advance* (ID `0`) was selected as payment method in your plentyShop.

[source,twig]
----
include::example$emailbuilder-code-example-bank-details.html[]

----

[#code-example-order-items]
=== Code example: Order items

In the <<#intable-widget-code, code widget>>, insert a code that causes the order items with the variation IDs, the item names, the item quantity and the price to be shown in a table.

[source,twig]
----
include::example$emailbuilder-code-example-order-items.html[]

----

[#code-example-item-list]
=== Code example: Items of the order shown as list

In the <<#intable-widget-code, code widget>>, insert a code that causes the item IDs and quantities of all items that are contained in the order to be shown in a list.

[source,twig]
----
include::example$emailbuilder-code-example-item-list.html[]

----

[#code-example-item-list-comma-separated]
=== Code example: Items of the order shown in one line and separated by comma

In the <<#intable-widget-code, code widget>>, insert a code that causes the item IDs and quantities of all items that are contained in the order to be shown in one line and separated by comma.

[source,twig]
----
include::example$emailbuilder-code-example-item-list-comma-separated.html[]

----

[#code-example-header-client-dependent]
=== Code example: Show header depending on the client

In the <<#intable-widget-code, code widget>> in the header, insert a code that causes the header to be shown depending on the plenty ID for the client you have selected. +
*_Note:_* Do not forget to replace the plenty IDs in the code example with the correct IDs and to insert the correct logos.

[source,twig]
----
include::example$emailbuilder-code-example-header-client-dependent.html[]

----

[IMPORTANT]
.Same approach in case of footers
====
Proceed in the same way using the code example and insert the code into the code widget in the footer if you also want to display different footers depending on the plenty ID.
====

[#code-example-date-format]
=== Code example: Date format

The setting for the date format that you have carried out in the *Language settings* area does _not_ apply for date-related twig expressions that you use in the code widget. Here, you have to carry out the formatting yourself.

*_Example:_* If you have selected a hyphen for the English date notation in the language settings, but insert one of the following twig expressions for the order date in the code widget, the notation used for the date in the code widget will be returned in the email template. The setting from the *Language settings* area will be overwritten here.

[#date-format-example-one]
==== dd.mm.yyyy without time

[source,twig]
----
include::example$emailbuilder-code-example-date-format-one.html[]

----

* Displayed result: 24.04.2023

[#date-format-example-two]
==== dd.mm.yyyy with time (without seconds)

[source,twig]
----
include::example$emailbuilder-code-example-date-format-two.html[]

----

* Displayed result: 24.04.2023 07:28

[#date-format-example-three]
==== yyyy-mm-dd with time (with seconds)

[source,twig]
----
include::example$emailbuilder-code-example-date-format-three.html[]

----

* Displayed result: 2023-04-24 07:28:54

[#code-example-number-format]
=== Code example: Number format

The setting for the number format that you have carried out in the *Language settings* area does _not_ apply for number values in twig expressions that you use in the code widget. Here, you have to carry out the formatting yourself.

*_Example:_* If you have selected a dot for the English number notation in the language settings, but insert one of the following twig expressions for the total invoice amount in the code widget, the notation used for the amount in the code widget will be returned in the email template. The setting from the *Language settings* area will be overwritten here.

[#number-format-example-one]
==== Comma as thousands separator and dot as decimal separator

[source,twig]
----
include::example$emailbuilder-code-example-number-format-one.html[]

----

* Displayed result: 3,141.59

[#number-format-example-two]
==== Dot as thousands separator and comma as decimal separator

----
include::example$emailbuilder-code-example-number-format-two.html[]

----

* Displayed result: 3.141,59

[#number-format-example-three]
==== No thousands separator and comma as decimal separator

----
include::example$emailbuilder-code-example-number-format-three.html[]

----

* Displayed result: 3141,59

[#code-examples-subject]
== Code examples for the subject line

In the subject line of your template, insert a code that displays a certain word at the beginning of the subject line in case of certain order referrers. In our example, the word `[IMPORTANT]` is always displayed at the beginning of the subject line if the referrers are between `9` and `11`.

[source,twig]
----
include::example$emailbuilder-code-example-subject.html[]

----

[#code-example-expert-mode]
== Code example for the expert mode

By means of an example, we will show in this chapter how you can use complex templates in expert mode. 

We will create an order confirmation in expert mode as an example. The following steps are required:

1. Create a folder in which you save the basic template
2. Create a regular template that contains the *Order items* widget
3. Extend the basic template with the text for the order confirmation

It is best to create a folder with the name `Auxiliary templates`. Create a template in expert mode in it and name it `Basic template`, for example. The basic template forms the framework for your template, so to speak.

[source,twig]
----
include::example$emailbuilder-code-example-expert-mode-basic-template.html[]

----

We also want to show the order items in the order confirmation. To do so, we create another “regular” template in which the *Order items* widget is the only content. In our example, this template has the ID 51 and the language ID for DE is 105.

[[image-emailbuilder-expert-mode-order-items]]
.*Order items* widget
image::crm:emailbuilder-expert-mode-example-order-items-widget.png[width=640, height=360]

In the next step, we extend the basic template with the text for the order confirmation. In our example, the basic template in DE has the ID 103.

[source,twig]
----
include::example$emailbuilder-code-example-expert-mode-order-confirmation.html[]

----
